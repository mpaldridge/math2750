[["index.html", "MATH2750 Introduction to Markov Processes Schedule", " MATH2750 Introduction to Markov Processes Matthew Aldridge University of Leeds, 2020–2021 Schedule Week 9 (22–26 March): Section 17: Continuous time Markov jump processes Section 18: Forward and backward equations Problem Sheet 9 Assessment 3: due Thursday 25 March (this week) Lecture: Tuesday at 1400 (Zoom) Workshops on Problem Sheet 7: Monday or Tuesday (Zoom) Drop-in sessions: Tuesday or Wednesday (Teams) Week 8 (15–19 March): Section 15: Poisson process in infinitesimal time periods Section 16: Counting processes Problem Sheet 8 Computational Worksheet 2 / Assessment 2: due Thursday 18 March at 1400 (this week) Assessment 3: due Thursday 25 March (next week) Week 7 (8–12 March): Section 13: Poisson process with Poisson increments Section 14: Poisson process with exponential holding times Problem Sheet 7 Computational Worksheet 2 / Assessment 2: computational drop-in sessions this week, due Thursday 18 March (next week) Assessment 3: due Thursday 25 March (week after next) Week 6 (1–5 March): Section 11: Long-term behaviour of Markov chians Section 12: End of of Part I: Discrete time Markov chains Problem Sheet 6 Computational Worksheet 2 / Assessment 2: computational drop-in sessions next week, due Thursday 18 March (week after next) Assessment 3: due Thursday 25 March (three weeks’ time) Week 5 (22–26 February): Section 9: Recurrence and transience Section 10: Stationary distributions Problem Sheet 5 Week 4 (15–19 February): Section 7: Class Structure Section 8: Hitting times Problem Sheet 4 Computational Worksheet 1, with computational drop-in sessions Week 3 (8–12 February): Section 5: Discrete time Markov chains Section 6: Examples from actuarial science Problem Sheet 3 Assessment 1 due Thursday 11 February (this week) Computational Worksheet 1: computational drop-in sessions next week Week 2 (1–5 February): Section 3: Gambler’s ruin Section 4: Linear difference equations Problem Sheet 2 Assessment 1 due Thursday 11 February (next week) Week 1 (25–29 January): About the module Section 1: Stochastic processes and the Markov property Section 2: Random walks Problem Sheet 1 "],["S00-about.html", "About MATH2750 Organisation of MATH2750 Content of MATH2750", " About MATH2750 This module is MATH2750 Introduction to Markov Processes. The module manager and lecturer is Dr Matthew Aldridge, and my email address is m.aldridge@leeds.ac.uk. Organisation of MATH2750 This module lasts for 11 weeks. The first nine weeks run from 25 January to 26 March, then we break for Easter, and then the final two weeks run from 26 April to 7 May. Notes and videos The main way I expect you to learn the material for this course is by reading these notes and by watching the accompanying videos. I will set two sections of notes each week, for a total of 22 sections. Reading mathematics is a slow process. Each section roughly corresponds to one lecture last year, which would have been 50 minutes. If you find yourself regularly getting through sections in much less than an hour, you’re probably not reading carefully enough through each sentence of explanation and each line of mathematics, including understanding the motivation as well as checking the accuracy. It is possible (but not recommended) to learn the material by only reading the notes and not watching the videos. It is not possible to learn the material by only watching the videos and not reading the notes. You are probably reading the web version of the notes. If you want a PDF copy (to read offline or to print out), then click the PDF button in the top ribbon of the page. (Warning: I have not made as much effort to make the PDF neat and tidy as I have the web version.) Since we will all be relying heavily on these notes, I’m even more keen than usual to hear about errors mathematical, typographical or otherwise. Please, please email me if think you may have found any. Problem sheets There will be 10 problem sheets; Problem Sheet \\(n\\) covers the material from the two sections from week \\(n\\) (Sections \\(2n -1\\) and \\(2n\\)), and will be discussed in your workshop in week \\(n+1\\). Lectures There will be one online synchronous “lecture” session each week, on Tuesdays at 1400, with me, run through Zoom. This will not be a “lecture” in the traditional sense of the term, but will be an opportunity to re-emphasise material you have already learned from notes and videos, to give extra examples, and to answer common student questions, with some degree of interactivity. I will assume you have completed all the work for the previous week by the time of the lecture, but I will not assume you’ve started the work for that week itself. I am very keen to hear about things you’d like to go through in the lectures; please email me with your suggestions. Workshops There will be 10 workshops, starting in the second week. The main goal of the workshops will be to go over your answers to the problems sheets in smaller classes. You will have been assigned to one of three workshop groups, meeting on Mondays or Tuesdays, led by Jason Klebes, Dr Jochen Voss, or me. Your workshop will be run through Zoom or Microsoft Teams; your workshop leader will contact you before the end of this week with arrangements. My recommended approach to problem sheets and workshops is the following: Work through the problem sheet before the workshop, spending plenty of time on it, and making multiple efforts at questions you get stuck on. I recommend spending at least three hours on each problem sheet, in more than one block. Collaboration is encouraged when working through the problems, but I recommend writing up your work on your own. Take advantage of the smaller group setting of the workshop to ask for help or clarification on questions you weren’t able to complete. After the workshop, attempt again the questions you were previously stuck on. If you’re still unable to complete a question after this second round of attempts, then consult the solutions. Assessments There will be four pieces of assessed coursework, making up a total of 15% of your mark for the module. Assessments 1, 3 and 4 will involve writing up answers to a few problems, in a similar style to the problem sheets, and are worth 4% each. (In response to previous student feedback, there are fewer questions per assessment.) Assessment 2 will be a report on some computational work (see below) and is worth 3%. Copying, plagiarism and other types of cheating are not allowed and will be dealt with in accordance with University procedures. The assessments deadlines are: Assessment 1: Thursday 11 February 1400 (week 3) Assessment 2 (Computational Worksheet 2): Thursday 18 March 1400 (week 8) Assessment 3: Thursday 25 March 1400 (week 9) Assessment 4: Thursday 6 May 1400 (week 11) Work will be submitted via Gradescope. Your markers are Jason Klebes, Macauley Locke, and Muyang Zhang – but you should contact the module leader if you have marking queries, not the markers directly. Computing worksheets There will be two computing worksheets, which will look at the material in the course through simulations in R. This material is examinable. You should be able to work through the worksheets in your own time, but if you need help, there will be optional online drop-in sessions in the weeks 4 and 7 with Muyang Zhang through Microsoft Teams. (Your computing drop-in session may be listed as “Practical” on your timetable.) The first computing worksheet will be a practice run, while a report on the second computing worksheet will be the second assessed piece of work. Drop-in sessions If you there is something in the course you wish to discuss in detail, the place for the is the optional weekly drop-in session. The drop-in sessions are an optional opportunity for you to ask questions you have to a member of staff – nothing will happen unless you being your questions. You will have been assigned to one of three groups on Tuesdays or Wednesdays with Nikita Merkulov or me. The drop-in sessions will be run the Microsoft Teams. Your drop-in session would be an excellent place to go if you are having trouble understanding something in the written notes, or if you’re still struggling on a problem sheet question after your workshop. Microsoft Team I have set up a Microsoft Team for the course. I propose to use the “Q and A” channel there as a discussion board. This is a good place to post questions about material from the course, and – even better! – to help answer you colleagues’ questions. The idea is that you all as a group should help each other out. I will visit a couple of times a week to clarify if everybody is stumped by a question, or if there is disagreement. Time management It is, of course, up to you how you choose to spend your time on this module. But, if you’re interested, my recommendations would be something like this: Every week: 7.5 hours per week Notes and videos: 2 sections, 1 hour each Problem sheet: 3.5 hours per week Lecture: 1 hour per week Workshop: 1 hour per week When required: Assessments 1, 2 and 4: 2 hours each Computer worksheets: 2 hours each Revision: 12 hours Total: 100 hours Exam There will be an exam – or, rather, a final “online time-limited assessment” – after the end of the module, making up the remaining 85% of your mark. The exam will consist of four questions, and you are expected to answer all of them. You will have 48 hours to complete the exam, although the exam itself should represent half a day to a day’s work. Further details to follow nearer the time. Who should I ask about…? I don’t understand something in the notes or on a problem sheet: Go to your weekly drop-in session, or post a question on the Teams Q and A board. (If you email me, I am likely to respond, “That would be an excellent question for your drop-in session or the Q and A board.”) I don’t understand something in on a computational worksheet: Go to your computing drop-in session in weeks 4 or 7. I have an admin question about general arrangements for the module: Email me. I have an admin question about arrangements for my workshop: Email your workshop leader. I have suggestion for something to cover in the lectures: Email me. I need an extension on or exemption from an assessment: Email the Maths Taught Students Office. Content of MATH2750 Prerequisites Some students have asked what background you’ll be expected to know for this course. It’s essential that you’re very comfortable with the basics of probability theory: events, probability, discrete and continuous random variables, expectation, variance, approximations with the normal distribution, etc. Conditional probability and independence are particularly important concepts in this course. This course will use the binomial, geometric, Poisson, normal and exponential distributions, although the notes will usually remind you about them first, in case you’ve forgotten. Many students on the module will have studied these topics in MATH1710 Probability and Statistics 1; others will have covered these in different modules. Syllabus The course has two major parts: the first part will cover processes in discrete time and the second part processes in continuous time. An outline plan of the topics covered is the following. (Remember that one week’s work is two sections of notes.) Discrete time Markov chains [12 sections] Introduction to stochastic processes [1 section] Important examples: Random walk, gambler’s ruin, linear difference equations, examples from actuarial science [4 sections] General theory: transition probabilities, \\(n\\)-step transition probabilities, class structure, periodicity, hitting times, recurrence and transience, stationary distributions, long-term behaviour [6 sections] Revision [1 section] Continuous time Markov jump processes [10 sections] Important examples: Poisson process, counting processes, queues [5 sections] General theory: holding times and jump chains, forward and backward equations, class structure, hitting times, stationary distributions, long-term behaviour [4 sections] Revision [1 section] Books You can do well on this module by reading the notes and watching the videos, attending the lectures and workshops, and working on the problem sheets, assignments and practicals, without any further reading. However, students can benefit from optional extra background reading or an alternative view on the material. My favourite book on Markov chains, which I used a lot while planning this course and writing these notes, is: J.R. Norris, Markov Chains, Cambridge Series in Statistical and Probabilistic Mathematics, Cambridge University Press, 1997. Chapters 1-3. This a whole book just on Markov processes, including some more detailed material that goes beyond this module. Its coverage of of both discrete and continuous time Markov processes is very thorough. Chapter 1 on discrete time Markov chains is available online. Other good books with sections on Markov processes that I have used include: G.R. Grimmett and D.R. Stirzaker, Probability and Random Processes, 4th edition, Oxford University Press, 2020. Chapter 6. G. Grimmet and D. Walsh, Probability: an introduction, 2nd edition, Oxford University Press, 2014. Chapter 12. D.R. Stirzaker, Elementary Probability, 2nd edition, Cambridge University Press, 2003. Chapter 9. Grimmett and Stirzaker is an excellent handbook that covers most of undergraduate probability – I bought a copy when I was a second-year undergraduate and still keep it next to my desk. The whole of Stirzaker is available online. A gentler introduction with plenty of examples is provided by: P.W. Jones and P. Smith, Stochastic Processes: an introduction, 3nd edition, Texts in Statistical Science, CRC Press, 2018. Chapters 2-7. although it doesn’t cover everything in this module. The whole book is available online. (I’ve listed the newest editions of these books, but older editions will usually be fine too.) And finally… These notes were mostly written by Matthew Aldridge in 2018–19, and have received updates (mostly in Sections 9–11) and reformatting this year. Some of the material (especially Section 1, Section 6, and numerous diagrams) follows closely previous notes by Dr Graham Murphy, and I also benefited from reading earlier notes by Dr Robert Aykroyd and Prof Alexander Veretennikov. Dr Murphy’s general help and advice was also very valuable. Many thanks to students in previous runnings of the module for spotting errors and suggesting improvements. "],["S01-stochastic-processes.html", "Section 1 Stochastic processes and the Markov property 1.1 Deterministic and random models 1.2 Stochastic processes 1.3 Markov property", " Section 1 Stochastic processes and the Markov property Stochastic processes with discrete or continuous state space and discrete or continuous time The Markov “memoryless” property 1.1 Deterministic and random models A model is an imitation of a real-world system. For example, you might want to have a model to imitate the world’s population, the level of water in a reservoir, cashflows of a pension scheme, or the price of a stock. Models allow us to try to understand and predict what might happen in the real world in a low risk, cost effective and fast way. To design a model requires a set of assumptions about how it will work and suitable parameters need to be determined, perhaps based on past collected data. An important distinction is between deterministic models and random models. Another word for a random model is a stochastic (“sto-kass-tik”) model. Deterministic models do not contain any random components, so the output is completely determined by the inputs and any parameters. Random models have variable outcomes to account for uncertainty and unpredictability, so they can be run many times to give a sense of the range of possible outcomes. Consider models for: the future position of the Moon as it orbits the Earth, the future price of shares in Apple. For the moon, the random components – for example, the effect of small meteorites striking the Moon’s surface – are not very significant and a deterministic model based on physical laws is good enough for most purposes. For Apple shares, the price changes from day to day are highly uncertain, so a random model can account for the variability and unpredictability in a useful way. In this module we will see many examples of stochastic models. Lots of the applications we will consider come from financial mathematics and actuarial science where the use of models that take into account uncertainty is very important, but the principles apply in many areas. 1.2 Stochastic processes If we want to model, for example, the total number of claims to an insurance company in the whole of 2020, we can use a random variable \\(X\\) to model this – perhaps a Poisson distribution with an appropriate mean. However, if we want to track how the number of claims changes over the course of the year 2021, we will need to use a stochastic process (or “random process”). A stochastic process, which we will usually write as \\((X_n)\\), is an indexed sequence of random variables that are (usually) dependent on each other. Each random variable \\(X_n\\) takes a value in a state space \\(\\mathcal S\\) which is the set of possible values for the process. As with usual random variables, the state space \\(\\mathcal S\\) can be discrete or continuous. A discrete state space denotes a set of distinct possible outcomes, which can be finite or countably infinite. For example, \\(\\mathcal S = \\{\\text{Heads},\\text{Tails}\\}\\) is the state space for a single coin flip, while in the case of counting insurance claims, the state space would be the nonnegative integers \\(\\mathcal S = \\mathbb Z_+ = \\{0,1,2,\\dots\\}\\). A continuous state space denotes an uncountably infinite continuum of gradually varying outcomes. For example, the nonnegative real line \\(\\mathcal S = \\mathbb R_+ = \\{x \\in \\mathbb R : x \\geq 0\\}\\) is the state space for the amount of rainfall on a given day, while some bounded subset of \\(\\mathbb R^3\\) would be the state space for the position of a gas particle in a box. Further, the process has an index set that puts the random variables that make up the process in order. The index set is usually interpreted as a time variable, telling us when the process will be measured. The index set for time can also be discrete or continuous. Discrete time denotes a process sampled at distinct points, often denoted by \\(n = 0,1,2,\\dots\\), while continuous time denotes a process monitored constantly over time, often denoted by \\(t \\in \\mathbb R_+ = \\{x \\in \\mathbb R : x \\geq 0\\}\\). In the insurance example, we might count up the number of claims each day – then the discrete index set will be the days of the year, which we could denote \\(\\{1,2,\\dots,365\\}\\). Alternatively, we might want to keep a constant tally that we update after every claim, requiring a continuous time index \\(t\\) representing time across the whole year. In discrete time, we can write down the first few steps of the process as \\((X_0, X_1, X_2, \\dots)\\). This gives us four possibilities in total: Discrete time, discrete space Example: Number of students attending each lecture of maths module. Markov chains – discrete time, discrete space stochastic processes with a certain “Markov property” – are the main topic of the first half of this module. Discrete time, continuous space Example: Daily maximum temperature in Leeds. We will briefly mention continuous space Markov chains in the first half of the course, but these are not as important. Continuous time, discrete space Example: Number of visitors to a webpage over time. Markov jump processes – continuous time, discrete space stochastic processes with the “Markov property” – are the main topic of the second half of this module. Continuous time, continuous space Example: Level of the FTSE 100 share index over time. Such processes, especially the famous Brownian motion – another process with the Markov property – are very important, but outside the scope of this course. See MATH3734 Stochastic Calculus for Finance next year, for example. 1.3 Markov property Because stochastic processes consist of a large number – even infinitely many; even uncountably infinitely many – random variables that could all be dependent on each other, they can get extremely complicated. The Markov property is a crucial property that restricts the type of dependencies in a process, to make the process easier to study, yet still leaves most of the useful and interesting examples intact. (Although particular examples of Markov processes go back further, the first general study was by the Russian mathematician Andrey Andreyevich Markov, published in 1906.) Think of a simple board game where we roll a dice and move that many squares forward on the board. Suppose we are currently on the square \\(X_n\\). Then what can we say about which square \\(X_{n+1}\\) we move to on our next turn? \\(X_{n+1}\\) is random, since it depends on the roll of the dice. \\(X_{n+1}\\) depends on where we are now \\(X_n\\), since the score of dice will be added onto the number our current square, Given the square \\(X_n\\) we are now, \\(X_{n+1}\\) doesn’t depend any further on which sequence of squares \\(X_0, X_1, \\dots, X_{n-1}\\) we used to get here. It is this third point that is the crucial property of the stochastic processes we will study in this course, and it is called the Markov property or memoryless property. We say “memoryless”, because it’s as if the process forgot how it got here – we only need to remember what square we’ve reached, not which squares we used to get here. The stochastic process before this moment has no bearing on the future, given where we are now. A mathematical way to say this is that “the past and the future are conditionally independent given the present.” To write this down formally, we need to recall conditional probability: the conditional probability of an event \\(A\\) given another event \\(B\\) is written \\(\\mathbb P(A \\mid B)\\), and is the probability that \\(A\\) occurs given that \\(B\\) definitely occurs. You may remember the definition \\[ \\mathbb P(A \\mid B) = \\frac{\\mathbb P(A \\cap B)}{\\mathbb P(B)} , \\] although is often more useful to reason directly about conditional probabilities than use this formula. (You may also remember that the definition of conditional probability requires that \\(\\mathbb P(B) &gt; 0\\). Whenever we write down a conditional probability, we implicitly assume the conditioning event has strictly positive probability without explicitly saying so.) Definition 1.1 Let \\((X_n) = (X_0, X_1, X_2, \\dots)\\) be a stochastic process in discrete time \\(n = 0,1,2,\\dots\\) and discrete space \\(\\mathcal S\\). Then we say that \\((X_n)\\) has the Markov property if, for all times \\(n\\) and all states \\(x_0, x_1, \\dots,x_n, x_{n+1} \\in \\mathcal S\\) we have \\[ \\mathbb P(X_{n+1}=x_{n+1} \\mid X_{n}=x_{n}, X_{n-1} = x_{n-1}, \\dots,X_0=x_0) = \\mathbb P(X_{n+1}=x_{n+1} \\mid X_{n}=x_{n}) . \\] Here, the left hand side is the probability we go to state \\(x_{n+1}\\) next conditioned on the entire history of the process, while the right hand side is the probability we go to state \\(x_{n+1}\\) next conditioned only on where we are now \\(x_n\\). So the Markov property tells us that it only matters where we are now and not how we got here. (There’s also a similar definition for continuous time processes, which we’ll come to later in the course.) Stochastic processes that have the Markov property are much easier to study than general processes, as we only have to keep track of where we are now and we can forget about the entire history that came before. In the next section, we’ll see the first, and most important, example of a discrete time discrete space Markov chain: the “random walk”. "],["S02-random-walk.html", "Section 2 Random walk 2.1 Simple random walk 2.2 General random walks 2.3 Exact distribution of the simple random walk", " Section 2 Random walk Definition of the simple random walk and the exact binomial distribution Expectation and variance of general random walks 2.1 Simple random walk Consider the following simple random walk on the integers \\(\\mathbb Z\\): We start at \\(0\\), then at each time step, we go up by one with probability \\(p\\) and down by one with probability \\(q = 1-p\\). When \\(p = q = \\frac12\\), we’re equally as likely to go up as down, and we call this the simple symmetric random walk. The simple random walk is a simple but very useful model for lots of processes, like stock prices, sizes of populations, or positions of gas particles. (In many modern models, however, these have been replaced by more complicated continuous time and space models.) The simple random walk is sometimes called the “drunkard’s walk”, suggesting it could model a drunk person trying to stagger home. Figure 2.1: Two simulations of random walks. We can write this as a stochastic process \\((X_n)\\) with discrete time \\(n = \\{0,1,2,\\dots\\} = \\mathbb Z_+\\) and discrete state space \\(\\mathcal S = \\mathbb Z\\), where \\(X_0 = 0\\) and, for \\(n \\geq 0\\), we have \\[ X_{n+1} = \\begin{cases} X_n + 1 &amp; \\text{with probability $p$,} \\\\ X_n - 1 &amp; \\text{with probability $q$.} \\end{cases} \\] It’s clear from this definition that \\(X_{n+1}\\) (the future) depends on \\(X_n\\) (the present), but, given \\(X_n\\), does not depend on \\(X_{n-1}, \\dots, X_1, X_0\\) (the past). Thus the Markov property holds, and the simple random walk is a discrete time Markov process or Markov chain. Example 2.1 What is the probability that after two steps a simple random walk has reached \\(X_2 = 2\\)? To achieve this, the walk must go upwards in both time steps, so \\(\\mathbb P(X_2 = 2) = pp = p^2\\). Example 2.2 What is the probability that after three steps a simple random walk has reached \\(X_3 = -1\\)? There are three ways to reach \\(-1\\) after three steps: up–down–down, down–up–down, or down–down–up. So \\[ \\mathbb P(X_3 = -1) = pqq+qpq+qqp = 3pq^2 . \\] 2.2 General random walks An alternative way to write the simple random walk is to put \\[\\begin{equation} X_n = X_0 + \\sum_{i=1}^n Z_i , \\tag{2.1} \\end{equation}\\] where the starting point is \\(X_0 = 0\\) and the increments \\(Z_1, Z_2, \\dots\\) are independent and identically distributed (IID) random variables with distribution given by \\(\\mathbb P(Z_i = 1) = p\\) and \\(\\mathbb P(Z_i = -1) = q\\). You can check that (2.1) means that \\(X_{n+1} = X_n + Z_{n+1}\\), and that this property defines the simple random walk. Any stochastic process with the form (2.1) for some \\(X_0\\) and some distribution for the IID \\(Z_i\\)s is called a random walk (without the word “simple”). Random walks often have state space \\(\\mathcal S = \\mathbb Z\\), like the simple random walk, but they could be defined on other state spaces. We could look at higher dimensional simple random walks: in \\(\\mathbb Z^2\\), for example, we could step up, down, left or right each with probability \\(\\frac14\\). We could even have a continuous state space like \\(\\mathbb R\\), if, for example, the \\(Z_i\\)s had a normal distribution. We can use this structure to calculate the expectation or variance of any random walk (including the simple random walk). Let’s start with the expectation. For a random walk \\((X_n)\\) we have \\[ \\mathbb E X_n = \\mathbb E \\left(X_0 + \\sum_{i=1}^n Z_i\\right) = \\mathbb E X_0 + \\sum_{i=1}^n \\mathbb E Z_i = \\mathbb EX_0 + n \\mathbb E Z_1 , \\] where we’ve used the linearity of expectation, and that the \\(Z_i\\)s are identically distributed. In the case of the simple random walk, we have \\(\\mathbb E X_0 = 0\\), since we start from \\(0\\) with certainty, and \\[ \\mathbb E Z_1 = \\sum_{z \\in \\mathbb Z} z \\mathbb P(Z_1 = z) = 1\\times p + (-1)\\times q = p-q .\\] Hence, for the simple random walk, \\(\\mathbb EX_n = n(p-q)\\). If \\(p &gt; \\frac12\\), then \\(p &gt; q\\), so \\(\\mathbb E X_n\\) grows ever bigger over time, while if \\(p &lt; \\frac12\\), then \\(\\mathbb E X_n\\) grows ever smaller (that is, negative with larger absolute value) over time. If \\(p = \\frac12 = q\\), which is the case of the simple symmetric random walk, then then the expectation \\(\\mathbb E X_n = 0\\) is zero for all time. Now the variance of a random walk. We have \\[ \\operatorname{Var}(X_n) = \\operatorname{Var}\\left(X_0 + \\sum_{i=1}^n Z_i\\right) = \\operatorname{Var}X_0 + \\sum_{i=1}^n \\operatorname{Var}Z_i = \\operatorname{Var}X_0 + n \\operatorname{Var}Z_1 , \\] where it was crucial that \\(X_0\\) and all the \\(Z_i\\)s were independent (so we had no covariance terms). For the simple random walk we have \\(\\operatorname{Var}X_0 = 0\\), since we always start from \\(0\\) with certainty. To calculate the variance of the increments, we write \\[\\begin{align*} \\operatorname{Var}(Z_1) &amp;= \\mathbb E (Z_1 - \\mathbb EZ_1)^2 \\\\ &amp;= p\\big(1 - (p-q)\\big)^2 + q \\big( {-1} - (p-q)\\big)^2\\\\ &amp;= p(2q)^2 + q(-2p)^2\\\\ &amp;= 4pq^2 + 4p^2q \\\\ &amp;= 4pq(p+q) \\\\ &amp;= 4pq . \\end{align*}\\] Here we’ve used that \\(1-p = q\\), \\(1-q=p\\), and \\(p+q = 1\\); you should take a few moments to check you’ve followed the algebra here. Hence the variance of the simple random walk is \\(4pqn\\). We see that (unless \\(p\\) is \\(0\\) or \\(1\\)) the variance grows over time, so it becomes harder and harder to predict where the random walk will be. The variance of the simple symmetric random walk is \\(4 \\frac12 \\frac12 n = n\\). For large \\(n\\), we can use a normal approximation for a random walk. Suppose the increments process \\((Z_n)\\) has mean \\(\\mu\\) and variance \\(\\sigma^2\\), and that the walk starts from \\(X_0 = 0\\). Then we have \\(\\mathbb E X_n = \\mu n\\) and \\(\\operatorname{Var}(X_n) = \\sigma^2 n\\), so for large \\(n\\) we can use the normal approximation \\(X_n \\approx \\mathrm{N}(\\mu n, \\sigma^2 n)\\). (Remember, of course, that the \\(X_n\\) are not independent.) To be more formal, the central limit theorem tells us that, as \\(n \\to \\infty\\), we have \\[ \\frac{X_n - n\\mu}{\\sigma \\sqrt{n}} \\to \\mathrm{N}(0,1) . \\] 2.3 Exact distribution of the simple random walk We have calculated the expectation and variance of any random walk. But for the simple random walk, we can in fact give the exact distribution, by writing down an exact formula for \\(\\mathbb P(X_n = i)\\) for any time \\(n\\) and any state \\(i\\). Recall that, at each of the first \\(n\\) times, we independently take an upward step with probability \\(p\\), and otherwise take a downward step. So if we let \\(Y_n\\) be the number of upward steps over the first \\(n\\) time periods, we see that \\(Y_n\\) has a binomial distribution \\(Y_n \\sim \\text{Bin}(n,p)\\). Recall that the binomial distribution has probability \\[ \\mathbb P(Y_n = k) = \\binom nk p^k (1-p)^{n-k} = \\binom nk p^k q^{n-k} , \\] for \\(k = 0,1,\\dots, n\\), where \\(\\binom{n}{k}\\) is the binomial coefficient “\\(n\\) choose \\(k\\)”. If \\(Y_n = k\\), that means we’ve taken \\(k\\) upward steps and \\(n-k\\) downward steps, leaving us at position \\(k - (n-k) = 2k - n\\). Thus we have that \\[\\begin{equation} \\mathbb P(X_n = 2k - n) = \\mathbb P(Y_n = k) = \\binom nk p^k q^{n-k} . \\tag{2.2} \\end{equation}\\] Note that after an odd number of time steps \\(n\\) we’re always at an odd-numbered state, since \\(2k - \\text{odd} = \\text{odd}\\), while after an even number of time steps \\(n\\) we’re always at an even-numbered state, since \\(2k - \\text{even} = \\text{even}\\). Writing \\(i = 2k - n\\) gives \\(k = (n+i)/2\\) and \\(n-k = (n-i)/2\\). So we can rearrange (2.2) to see that the distribution for the simple random walk is \\[ \\mathbb P(X_n = i) = \\binom{n}{(n+i)/2} p^{(n+i)/2} q^{(n-i)/2} , \\] when \\(n\\) and \\(i\\) have the same parity with \\(-n \\leq i \\leq n\\), and is \\(0\\) otherwise. In the special case of the simple symmetric random walk, we have \\[ \\mathbb P(X_n = i) = \\binom{n}{(n+i)/2} \\left(\\frac12\\right)^{(n+i)/2} \\left(\\frac12\\right)^{(n-i)/2} = \\binom{n}{(n+i)/2} 2^{-n} . \\] In the next section, we look at a gambling problem based on the simple random walk. "],["P01.html", "Problem Sheet 1", " Problem Sheet 1 .fold-btn { float: right; margin: -12px 0 0 0; } You should attempt all these questions and write up your solutions in advance of your workshop in week 2 (Monday 1 or Tuesday 2 February) where the answers will be discussed. 1. When designing a model for a quantity that changes over time, one has many decisions to make: Discrete or continuous state space? Discrete or continuous index set for time? Deterministic or stochastic model? If a stochastic model is chosen, is it reasonable to assume that the Markov property holds? What would you decide for the following scenarios: (a) The percentage of UK voters with a positive opinion of Boris Johnson in a weekly tracking poll. (b) The number of points won by a football league club throughout the season. (c) The temperature of a bowl of water placed in an oven. (d) The number of people inside the University of Leeds library. Suggestions. This question is meant to inspire discussion, so there are not necessarily right and wrong answers. If I were designing the models, however, my choices might be these: (a) Discrete space if percentages are given to nearest 1%, otherwise continuous; discrete time (weekly); stochastic; the Markov property might be appropriate, perhaps using some sort of random walk. (b) Discrete space (number of points); discrete time (update after each game); stochastic; the Markov property might be appropriate, depending on if you think teams can have non-Markovian “winning streaks” (or losing streaks) that don’t reflect underlying performance. (c) Continuous space (temperature); continuous time; if the oven is reliable and the experiment carried out carefully, a deterministic model might be sufficient. (d) Discrete space (number of people); continuous time; stochastic; Markov property might not be appropriate due to `bursts’ of people leaving during fire drills or entering when it starts raining. 2. A fair six-sided dice is rolled twice, resulting in the values \\(X_1, X_2 \\in \\{1, 2, \\ldots, 6\\}\\). Let \\(Y = X_1 + X_2\\) be the total score. Calculate: (a) the probability \\(\\mathbb P(Y = 10)\\); Solution. The following table illustrates the possible outcomes \\(Y\\) of the experiment. Each cell of the table is an equally probable outcome. There are 3 possible ways to get \\(Y=10\\) (the grey cells in the table) out of the \\(36\\) possible outcomes, so we have \\(\\mathbb P(Y = 10) = 3/36 = 1/12\\). (b) the conditional probability \\(\\mathbb P(Y=10 \\mid X_1=x)\\) for \\(x=1, 2, \\ldots, 6\\); Solution. Conditioning on \\(X_1 = x\\) means restricting our attention only to column \\(x\\) of the table. Each column has \\(6\\) equally probably cells. For \\(x=1,2,3\\), none of the entries equal \\(10\\), so \\(\\mathbb P(Y=10 \\mid X_1=x) = 0/6 = 0\\). For each of \\(x=4,5,6\\), one of the entries equals \\(10\\), so \\(\\mathbb P(Y=10 \\mid X_1=x) = 1/6\\). (c) the conditional probability \\(\\mathbb P(X_1=x \\mid Y=10)\\) for \\(x=1, 2, \\ldots, 6\\). Solution. Conditioning on \\(Y =10\\) means restricting our attention only to the \\(3\\) shaded cells, which are each equally likely. For \\(x=1,2,3\\), none of the shaded cells are in column \\(x\\), so \\(\\mathbb P(X_1=x \\mid Y=10) = 0/3 = 0\\). For each of \\(x=4,5,6\\), one of the shaded cells is in column \\(x\\), so \\(\\mathbb P(X_1=x \\mid Y=10) = 1/3\\). 3. Let \\((X_n)\\) be a simple random walk starting from \\(X_0 = 0\\) and that at each step goes up one with probability \\(p\\) or down one with probability \\(q = 1-p\\). What are: (a) \\(\\mathbb P(X_5 = 3)\\), Solution. To get \\(X_5 = 3\\), we must take \\(4\\) steps up and \\(1\\) step down. The down step can be at any of the \\(5\\) time steps. Therefore we have \\(\\mathbb P(X_5 = 3) = 5p^4q\\). (b) \\(\\mathbb P(X_5 = 3 \\mid X_2 = 2)\\), Solution. Once we’re at \\(X_2 = 2\\), we must take \\(2\\) steps up and \\(1\\) step down over the next \\(3\\) time steps. So \\(\\mathbb P(X_5 = 3 \\mid X_2 = 2) = 3p^2q\\). (c) \\(\\mathbb P(X_n = n-2)\\), Solution. This requires \\(n-1\\) steps up and \\(1\\) step down, and the down step can be at any of the \\(n\\) time steps. So \\(\\mathbb P(X_n = n-2) = np^{n-1}q\\). (d) \\(\\mathbb E X_4\\), Solution. The increments \\(Z_n = X_n - X_{n-1}\\) have expectation \\(1p + (-1)q = p - q\\), so \\(\\mathbb E X_4 = 4(p-q)\\). (e) \\(\\mathbb E(X_6 \\mid X_4 = 2)\\), Solution. We are already at 2, then another two increments will take us up \\(2(p-q)\\) on average. Therefore \\(\\mathbb E(X_6 \\mid X_4 = 2) = 2 + 2(p-q)\\). 4. The price \\(X_n\\) of a stock at the close of day \\(n\\) is modelled as a Gaussian random walk, where the increments \\((Z_n)\\) have a normal distribution \\(Z_n \\sim \\text{N}(\\mu, \\sigma^2)\\). The model assumes a drift of \\(\\mu = 0.7\\) and a volatility of \\(\\sigma = 2.2\\). The initial price is \\(X_0 = 42.3\\). (a) Calculate the mean and variance of the price of the stock at the close of day \\(5\\). Solution. The mean and variance are \\[\\begin{gather*} \\mathbb EX_5 = \\mathbb E X_0 + n \\mathbb E Z_1 = 42.3 + 5 \\cdot 0.7 = 45.8 , \\\\ \\operatorname{Var}X_5 = \\operatorname{Var}X_0 + n \\operatorname{Var}Z_1 = 0 + 5 (2.2)^2 = 24.2 . \\end{gather*}\\] (b) Give a 95% prediction interval for the price at the close of day 5. (You might find it useful to recall that, if \\(W \\sim \\text{N}(0,1)\\) is a standard normal random variable, then \\(\\mathbb P(W \\leq 1.96) = 0.975\\).) Solution. Note that \\(X_5\\) itself is normally distributed, so \\(X_5 \\sim \\text{N}(45.8,24.2)\\). The 95% prediction interval for a normal distribution \\(\\text{N}(\\mu, \\sigma^2)\\) is \\((\\mu - 1.96\\sigma, \\mu + 1.96\\sigma)\\), so the prediction interval for \\(X_5\\) is \\[ \\big(45.8 - 1.96\\sqrt{24.2}, 45.8 + 1.96\\sqrt{24.2}\\big) = (36.16, 55.44) . \\] (c) After day 4, the prices at the end of each of the first four days have been recorded as \\(X_1 = 44.4, X_2 = 44.0, X_3 = 47.1, X_4 = 47.8\\). Update your prediction interval for the price at the close of day 5, and comment on how it differs from the earlier prediction interval. Solution. By the Markov property, \\(X_5\\) depends on \\(X_4\\), but given \\(X_4\\) does not depend on the other values, which we can therefore ignore. Since \\(X_5 = X_4 + Z_5\\), we have \\[\\begin{gather*} \\mathbb E(X_5 \\mid X_4) = X_4 + \\mathbb E Z_5 = 47.8 + 0.7 = 48.5 \\\\ \\operatorname{Var}(X_5 \\mid X_4) = 0 + \\operatorname{Var}Z_5 = 0 + (2.2)^2 = 4.84. \\end{gather*}\\] The desired prediction interval is \\[ \\big(48.5 - 1.96\\sqrt{4.84}, 48.5+ 1.96\\sqrt{4.84}\\big) = (44.19, 52.81) . \\] Compared to before, the centre of the prediction interval is slightly higher, because the stock has outperformed expectations so far, and the interval is much narrower, because as we get closer to day 5 we become less uncertain. 5. A gambler decides to model her total winnings as a simple random walk starting from \\(X_0 = 0\\) that at each time goes up one with probability \\(p\\) and down one with probability \\(1-p\\), but where \\(p\\) is unknown. The first \\(10\\) recordings, \\(X_1\\) to \\(X_{10}\\), are \\[ (1, 2, 1, 2, 3, 4, 5, 6, 5, 6) . \\] (a) What would you guess for the value of \\(p\\), given this data? Solution. In \\(10\\) time steps, the process went up \\(k = 8\\) times and down \\(n - k = 2\\) times. So it seems reasonable to guess that \\(p\\) has the value \\(\\hat p = \\frac{8}{10} = 0.8\\). (b) More generally, how would you estimate \\(p\\) from the data \\(X_0 = 0, X_1 = x_1, X_2 = x_2, \\dots, X_n = x_n\\)? Solution. We will estimate \\(\\hat p = k/n\\), where \\(k\\) is the number of upward steps. We saw in lectures that \\(k = (n + x_n)/2\\), so our estimate is \\[ \\hat p = \\frac{n + x_n}{2n} = \\frac12\\ + \\frac{x_n}{2n} . \\] (c) Show that your estimate is in fact the maximum likelihood estimate of \\(p\\). Solution. The concept of “maximum likelihood estimation” will be known to those who have done MATH2715; this might be new for those who didn’t take that course. Let \\(k = (n + x_n)/2\\) be the number of upward steps. Then the “likelihood” is the probability mass function \\[ f(\\mathbf x; p) = p^{k}(1-p)^{n-k} , \\] since we take \\(k\\) steps up and \\(n-k\\) steps down. Given \\(\\mathbf x\\) (or equivalently \\(k\\)) the “maximum likelihood estimate” is the value of \\(p\\) that maximises this likelihood. As is often the case, it’s equivalent but actually more convenient to maximise the log-likelihood \\[ \\ell(\\mathbf x; p) = \\ln f(\\mathbf x; p) = k \\ln p + (n-k)\\ln(1-p) .\\] We can perform the maximisation by differentiating and setting equal to \\(0\\). The derivative is \\[ \\frac{\\text{d}}{\\text{d}p} \\ell(\\mathbf x; p) = \\frac kp - \\frac{n-k}{1-p} ,\\] so the maximum likelihood estimate \\(\\hat p\\) satisfies \\[ 0 = \\frac k{\\hat p} - \\frac{n-k}{1-\\hat p} . \\] Solving this by clearing denominators we get \\[ 0 = (k - k\\hat p) - (n\\hat p - k\\hat p) = k - n \\hat p , \\] and rearranging gives \\(\\hat p = k/n\\) as desired. "],["S03-gamblers-ruin.html", "Section 3 Gambler’s ruin 3.1 Gambler’s ruin Markov chain 3.2 Probability of ruin 3.3 Expected duration of the game", " Section 3 Gambler’s ruin The gambler’s ruin Markov chain Equations for probability of ruin and expected duration of the game by conditioning on the first step 3.1 Gambler’s ruin Markov chain Consider the following gambling problem. Alice is gambling against Bob. Alice starts with £\\(a\\) and Bob starts with £\\(b\\). It will be convenient to write \\(m = a + b\\) for the total amount of money, so Bob starts with £\\((m-a)\\). At each step of the game, both players bet £1; Alice wins £1 off Bob with probability \\(p\\), or Bob wins £1 off Alice with probability \\(q\\). The game continues until one player is out of money (or is “ruined”). Let \\(X_n\\) denote how much money Alice has after \\(n\\) steps of the game. We can write this as a stochastic process with discrete time \\(n \\in \\{0,1,2,\\dots\\} = \\mathbb Z_+\\) and discrete state space \\(\\mathcal S = \\{0,1,\\dots,m\\}\\). Then \\(X_0 = a\\), and, for \\(n \\geq 0\\), we have \\[ X_{n+1} = \\begin{cases} X_n + 1 &amp; \\text{with probability $p$ if $1\\leq X_n \\leq m-1$,} \\\\ X_n - 1 &amp; \\text{with probability $q$ if $1\\leq X_n \\leq m-1$,} \\\\ 0 &amp; \\text{if $X_n = 0$,} \\\\ m &amp; \\text{if $X_n = m$.} \\end{cases} \\] So Alice’s money goes up one with probability \\(p\\) or down one with probability \\(q\\), unless the game is already over with \\(X_n = 0\\) (Alice is ruined) or \\(X_n = m\\) (Alice has won all Bob’s money, so Bob in ruined). We see that the gambler’s ruin process \\((X_n)\\) clearly satisfies the Markov property: the next step \\(X_{n+1}\\) depends on where we are now \\(X_n\\), but, given that, does not depend on how we got here. The gambler’s ruin process is exactly like a simple random walk started from \\(X_0 = a\\) except that we have absorbing barriers and \\(0\\) and \\(m\\), where the random walk stops because one of the players has ruined. (One could also consider random walks with reflecting barriers, that bounce the random walk back into the state space, or mixed barriers that are absorbing or reflecting at random.) There are two questions about the gambler’s ruin that we’ll try to answer in this section: What is the probability that the game ends by Alice ruining? How long does the game last on average? 3.2 Probability of ruin The gambling game continues until either Alice is ruined (\\(X_n = 0\\)) or Bob is ruined (\\(X_n = m\\)). A natural question to ask is: What is the probability that the game ends in Alice’s ruin? Let us write \\(r_i\\) for the probability Alice ends up ruined if she currently has £\\(i\\). Then the probability of ruin for the whole game is \\(r_a\\), since Alice initially starts with £\\(a\\). The probability Bob will end up ruined is \\(1 - r_a\\), since one of the players must lose. What can we say about \\(r_i\\)? Clearly we have \\(r_0 = 1\\), since \\(X_n = 0\\) means that Alice has run out of money and is ruined, and \\(r_m = 0\\), since \\(X_n = m\\) means that Alice has won all the money and Bob is ruined. What about when \\(1 \\leq i \\leq m-1\\)? The key is to condition on the first step. That is, we can write \\[\\begin{align*} \\mathbb P(\\text{ruin}) &amp;= \\mathbb P(\\text{win first round}) \\, \\mathbb P(\\text{ruin} \\mid \\text{win first round}) \\\\ &amp;\\qquad{}\\quad {}+ \\mathbb P(\\text{lose first round}) \\, \\mathbb P(\\text{ruin} \\mid \\text{lose first round}) \\\\ &amp;= p\\,\\mathbb P(\\text{ruin} \\mid \\text{win first round}) + q \\,\\mathbb P(\\text{ruin} \\mid \\text{lose first round}) . \\end{align*}\\] Here we have conditioned on whether Alice wins or loses the first round. More formally, we have used the law of total probability, which says that if the events \\(B_1, \\dots, B_k\\) are disjoint and cover the whole sample space, then \\[ \\mathbb P(A) = \\sum_{i=1}^k \\mathbb P(B_i) \\, \\mathbb P(A \\mid B_i) . \\] Here, \\(\\{\\text{Alice wins the first round}\\}\\) and \\(\\{\\text{Alice loses the first round}\\}\\) are indeed disjoint events that cover the whole sample space. This idea of “conditioning on the first step” will be the most crucial tool throughout this whole module. If Alice wins the first round from having £\\(i\\), she now has £\\((i+1)\\). Her probability of ruin is now \\(r_{i+1}\\), because, by the Markov property, it’s as if the game were starting again with Alice having £\\((i+1)\\) to start with. The Markov property tells us that it doesn’t matter how Alice got to having £\\((i+1)\\), it only matters how much she has now. Similarly, if Alice loses the first round, she now has £\\((i-1)\\), and the ruin probability is \\(r_{i-1}\\). Hence we have \\[ r_i = pr_{i+1} + qr_{i-1}. \\] Rearranging, and including the “boundary conditions”, we see that the equation we want to solve is \\[ pr_{i+1} - r_i + qr_{i-1} = 0 \\qquad \\text{subject to} \\qquad r_0 = 1,\\ r_m = 0. \\] This is a linear difference equation – and, because the left-hand side is \\(0\\), we call it a homogeneous linear difference equation. We will see how to solve this equation in the next lecture. We will see that, if we set \\(\\rho = q/p\\), then the ruin probability is given by \\[ r_a = \\begin{cases} \\displaystyle\\frac{\\rho^a - \\rho^m}{1 - \\rho^m} &amp; \\text{if $\\rho \\neq 1$,} \\\\[0.35cm] 1 - \\displaystyle\\frac{a}{m} &amp; \\text{if $\\rho = 1$.} \\end{cases} \\] Note that \\(\\rho = 1\\) is the same as the symmetric condition \\(p = q = \\frac12\\). Imagine Alice is not playing against a similar opponent Bob, but rather is up against a large casino. In this case, the casino’s capital £\\((m-a)\\) is typically much bigger than Alice’s £\\(a\\). We can model this by keeping \\(a\\) fixed taking a limit \\(m \\to \\infty\\). Typically, the casino has an “edge”, meaning they have a better than \\(50:50\\) chance of winning; this means that \\(q &gt; p\\), so \\(\\rho &gt; 1\\). In this case, we see that the ruin probability is \\[ \\lim_{m \\to \\infty} r_a = \\lim_{m \\to \\infty} \\frac{\\rho^a - \\rho^m}{1 - \\rho^m} = \\lim_{m \\to \\infty} \\frac{\\rho^a/\\rho^m - 1}{1/\\rho^m - 1} = \\frac{0-1}{0-1} = 1, \\] so Alice will be ruined with certainty. Even with a generous casino that offered an exactly fair game with \\(p = q = \\frac12\\), so \\(\\rho = 1\\), we would have \\[ \\lim_{m \\to \\infty} r_a = \\lim_{m \\to \\infty}\\left( 1 - \\frac{a}{m} \\right) = 1-0 = 1 , \\] so, even with this fair game, Alice would still be ruined with certainty. (The official advice of the University of Leeds module MATH2750 is that you shouldn’t gamble against a casino if you can’t afford to lose.) 3.3 Expected duration of the game We could also ask for how long we expect the game to last. We approach this like before. Let \\(d_i\\) be the expected duration of the game from a point when Alice has £\\(i\\). Our boundary conditions are \\(d_0 = d_m = 0\\), because \\(X_n = 0\\) or \\(X_n = m\\) means that the game is over with Alice or Bob ruined. Again, we proceed by conditioning on the first step, so \\[\\begin{align*} \\mathbb E(\\text{duration}) &amp;= \\mathbb P(\\text{win first round}) \\, \\mathbb E(\\text{duration} \\mid \\text{win first round}) \\\\ &amp;\\qquad{}+ \\mathbb P(\\text{lose first round}) \\, \\mathbb E(\\text{duration} \\mid \\text{lose first round}) \\\\ &amp;= p\\,\\mathbb E(\\text{duration} \\mid \\text{win first round}) + q \\,\\mathbb E(\\text{duration} \\mid \\text{lose first round}) . \\end{align*}\\] More formally, we’ve used another version of the law of total probability, \\[ \\mathbb E(X) = \\sum_{i=1}^k \\mathbb P(B_i) \\, \\mathbb E(X \\mid B_i) , \\] or, alternatively, the tower law for expectations \\[ \\mathbb E(X) = \\mathbb E_Y \\mathbb E (X \\mid Y) = \\sum_{y} \\mathbb P(Y= y)\\, E(X \\mid Y = y), \\] where, in our case, \\(Y\\) was the outcome of the first round. Now, the expected duration given we win the first round is \\(1 + d_{i+1}\\). This is because the round itself takes \\(1\\) time step, and then, by the Markov property, it’s as if we are starting again from \\(i+1\\). Similarly, the expected duration given we lose the first round is \\(1 + d_{i-1}\\). Thus we have \\[ d_i = p(1 + d_{i+1}) + q (1 + d_{i-1}) = 1 + pd_{i+1} + qd_{i-1} . \\] Don’t forget the 1 that counts the current round! Rearranging, and including the boundary conditions, we have another linear difference equation: \\[ pd_{i+1} - d_i + qd_{i-1} = -1 \\qquad \\text{subject to} \\qquad d_0 = 0,\\ d_m = 0. \\] Because the right-hand side, \\(-1\\), is nonzero, we call this an inhomogeneous linear difference equation. Again, we’ll see how to solve this in the next lecture, and will find that the solution is given by \\[ d_a = \\begin{cases} {\\displaystyle \\frac{1}{q-p} \\left(a - m\\frac{1-\\rho^a}{1- \\rho^m} \\right)} &amp; \\text{if $\\rho \\neq 1$,} \\\\ \\displaystyle a(m-a) &amp; \\text{if $\\rho = 1$.} \\end{cases} \\] Thinking again of playing against the casino, with \\(q &gt; p\\), \\(\\rho &gt; 1\\), and \\(m \\to \\infty\\), we see that the expected duration is \\[ \\lim_{m\\to\\infty} d_a = \\lim_{m\\to\\infty} \\frac{1}{q-p} \\left(a - m\\frac{1-\\rho^a}{1 - \\rho^m} \\right) = \\frac{1}{q-p} \\left(a - 0 \\right) = \\frac{a}{q-p} , \\] since \\(\\rho^m\\) grows much quicker than \\(m\\). So Alice ruins with certainty, and it will take time \\(a/(q-p)\\), on average. In the case of the generous casino, though, with \\(q = p\\), so \\(\\rho = 1\\), we have \\[ \\lim_{m\\to\\infty} d_a = \\lim_{m\\to\\infty} a(m-a) = \\infty . \\] So here, Alice will ruin with certainty, but it may take a very long time until the ruin occurs, since the expected duration is infinite. In the next section, we see how to solve linear difference equations, in order to find the ruin probability and expected duration of the gambler’s ruin. "],["S04-ldes.html", "Section 4 Linear difference equations 4.1 Homogeneous linear difference equations 4.2 Probability of ruin for the gambler’s ruin 4.3 Inhomogeneous linear difference equations 4.4 Expected duration for the gambler’s ruin", " Section 4 Linear difference equations How to solve homogeneous and inhomogeneous linear difference equations Solving for probability of ruin and expected duration of the gambler’s ruin In the previous section, we looked at the probability of ruin and expected duration of the gambler’s ruin process. We set up linear difference equations to find these. In this section, we’ll learn how to solve these equations. A linear difference equation is an equation that looks like \\[\\begin{equation} a_k x_{n+k} + a_{k-1} x_{n+k-1} + \\cdots + a_1 x_{n+1} + a_0 x_n = f(n) \\tag{4.1} \\end{equation}\\] for \\(n = 0,1,\\dots\\), where the \\(a_i\\) are given constants, \\(f(n)\\) is a given function, and we want to solve for the sequence \\((x_n)\\). The equation normally comes with some extra conditions, such as the value of the first few \\(x_n\\)s. When the right-hand side of (4.1) is zero, so \\(f(n) = 0\\), we say the equation is homogeneous; when the right-hand side is nonzero, it is inhomogeneous. The number \\(k\\), where there are \\(k+1\\) terms on the left-hand side, is called the degree of the equation; we are mostly interested in second-degree linear difference equations, which have three terms on the left-hand side. 4.1 Homogeneous linear difference equations We start with the homogeneous case, which is simpler. Consider a homogeneous linear difference equation. We shall use the second-degree example \\[ x_{n+2} - 5x_{n+1} + 6x_{n} = 0 \\qquad \\text{subject to } x_0 = 4, x_1 = 9 . \\] Here, the conditions on \\(x_0\\) and \\(x_1\\) are initial conditions, because they tell us how the sequence \\((x_n)\\) starts. For the moment, we shall put the initial conditions to the side and just worry about the equation \\[ x_{n+2} - 5x_{n+1} + 6x_{n} = 0 . \\] We start by guessing there might be a solution of the form \\(x_n = \\lambda^n\\) for some constant \\(\\lambda\\). We can find out if there is such a solution by substituting in \\(x_n = \\lambda^n\\), and seeing if there’s a \\(\\lambda\\) that solves the equation. For our example, we get \\[ \\lambda^{n+2} - 5 \\lambda^{n+1} + 6\\lambda^n = 0 . \\] After cancelling off a common factor of \\(\\lambda^n\\), we get \\[ \\lambda^2 - 5 \\lambda + 6 = 0 . \\] This is called the characteristic equation. For a general homogeneous linear difference equation (4.1), the characteristic equation is \\[\\begin{equation} a_k \\lambda^{k} + a_{k-1} \\lambda^{k-1} + \\cdots + a_1 \\lambda + a_0 = 0 . \\tag{4.2} \\end{equation}\\] When writing out answers to questions, you can jump straight to the characteristic equation. We can now solve the characteristic equation for \\(\\lambda\\). In our example, we can factor the left-hand side to get \\((\\lambda - 3)(\\lambda - 2) = 0\\), which has solutions \\(\\lambda = 2\\) and \\(\\lambda = 3\\). Thus \\(x_n = 2^n\\) and \\(x_n = 3^n\\) both solve our equation. In fact, since the right-hand side of the equation is \\(0\\), any linear combination of these two solutions is a solution also, thus we get the general solution \\[ x_n = A 2^n + B 3^n , \\] which is a solution for any values of the constants \\(A\\) and \\(B\\). For a general characteristic equation with distinct roots \\(\\lambda_1, \\lambda_2, \\dots, \\lambda_k\\), the general solution is \\[ x_n = C_1 \\lambda_1^n + C_2 \\lambda_2^n + \\cdots + C_k \\lambda_k^n . \\] If we have a repeated root – say, \\(\\lambda_1 = \\lambda_2 = \\cdots = \\lambda_r\\) is repeated \\(r\\) times – than you can check that a solution is given by \\[ x_n = (D_0 + D_1 n + \\cdots + D_{r-1} n^{r-1}) \\lambda_1^n , \\] which should take its place in the general solution. Once we have the general solution, we can use the extra conditions to find the values of the constants. In our example, we can use the initial conditions to find out the values of \\(A\\) and \\(B\\). We see that \\[\\begin{gather*} x_0 = A2^0 + B3^0 = A + B = 4 , \\\\ x_1 = A2^1 + B3^1 = 2A + 3B = 9 . \\end{gather*}\\] We can now solve this pair of simultaneous equations to solve for \\(A\\) and \\(B\\). By subtracting twice the first equation from the second we get \\(B = 1\\), and substituting this into the first equation we get \\(A = 3\\). Thus the solution is \\[ x_n = 3\\cdot 2^n + 3^n . \\] In conclusion, the process here was: Find the general solution by writing down and solving the characteristic equation. Use the extra conditions to find the values of the constants in the general solution. Here are two more examples. These also give an idea of how I would expect you to set out your own answers to similar problems. Example 4.1 Solve the homogeneous linear difference equation \\[ x_{n+2} - x_{n+1} - 6x_n = 0 \\qquad \\text{subject to} \\quad x_0 = 3,\\quad x_1 = 4 . \\] Step 1. The characteristic equation is \\[ \\lambda^2 - \\lambda - 6 = 0 . \\] We can solve this by factorising it as \\((\\lambda - 3) (\\lambda + 2) = 0\\), to find the solutions \\(\\lambda_1 = -2\\) and \\(\\lambda_2 = 3\\). Thus the general solution is \\[ x_n = A(-2)^n + B3^n . \\] Step 2. Substituting the initial conditions into the general solution, we have \\[\\begin{align*} x_0 &amp;= A(-2)^0 + B3^0 = A + B = 3 \\\\ x_1 &amp;= A(-2)^1 + B3^1 = -2A + 3B = 4 . \\end{align*}\\] We can add twice the first equation to the second to get \\(5B = 10\\), so \\(B=2\\). We can substitute this into the first equation to get \\(A = 1\\). The solution is therefore \\[ x_n = 1\\cdot(-2)^n + 2 \\cdot 3^n = (-2)^n + 2 \\cdot 3^n . \\] Example 4.2 Solve the homogeneous linear difference equation \\[ x_{n+2} + 4x_{n+1} +4x_n = 0 \\qquad \\text{subject to} \\quad x_0 = 2,\\quad x_1 = -6 . \\] Step 1. The characteristic equation is \\[ \\lambda^2 + 4\\lambda + 4 = 0 . \\] We can solve this by factorising it as \\((\\lambda + 2)^2 = 0\\), to find a repeated root \\(\\lambda_1 = \\lambda_2 = -2\\). Thus the general solution is \\[ x_n = (A + Bn) (-2)^n . \\] Step 2. Substituting the initial conditions into the general solution, we have \\[\\begin{align*} x_0 &amp;= (A + B0)(-2)^0 = A = 2 \\\\ x_1 &amp;= (A + B1)(-2)^1 = -2A - 2B = -6 . \\end{align*}\\] The first immediately gives \\(A = 2\\), and substituting this into the second equation gives \\(B = 1\\). The solution is therefore \\[ x_n = (2 + n)(-2)^n . \\] 4.2 Probability of ruin for the gambler’s ruin In the last lecture we saw that probability of ruin for the gambler’s ruin process is the solution to \\[ pr_{i+1} - r_i + qr_{i-1} = 0 \\qquad \\text{subject to} \\qquad r_0 = 1,\\ r_m = 0 , \\] where the extra conditions here are boundary conditions, because they tell us what happens at the boundaries of the state space. The characteristic equation is \\[ p\\lambda^2 - \\lambda + q = 0 .\\] We can solve the characteristic equation by factorising it as \\((p \\lambda - q)(\\lambda - 1) = 0\\). (It might take a moment to check this really is a factorisation of the characteristic equation. Hint: we’ve used that \\(p+q=1\\).) So the characteristic equation has roots \\(\\lambda = q/p\\), which we called \\(\\rho\\) last time, and \\(\\lambda = 1\\). Now, if \\(\\rho = 1\\) (so \\(p = q = \\frac12\\)) we have a repeated root, while if \\(\\rho \\neq 1\\) we have distinct roots, so we’ll need to deal with the two cases separately. First, the case \\(\\rho \\neq 1\\). Since the two roots are distinct, we have the general solution \\[ r_i = A\\rho^i + B1^i = A\\rho^i + B . \\] We can now use the boundary conditions to find \\(A\\) and \\(B\\). We have \\[\\begin{gather*} r_0 = A \\rho^0 + B = A+B = 1, \\\\ r_m = A \\rho^m + B = 0 . \\end{gather*}\\] From the first we get \\(B = 1-A\\), which we substitute into the second to get \\[ A\\rho^m + 1 - A = 0 \\quad \\Rightarrow \\quad A = \\frac{1}{1-\\rho^m} , \\] and hence \\[ B = 1 - A = 1 - \\frac{1}{1-\\rho^m} = - \\frac{\\rho^m}{1 - \\rho^m} . \\] Thus the solution is \\[ r_i = \\frac{1}{1-\\rho^m} \\rho^i - \\frac{\\rho^m}{1 - \\rho^m} = \\frac{\\rho^i - \\rho^m}{1 - \\rho^m} , \\] as we claimed last time. Second, the case \\(\\rho = 1\\). Now we have a repeated root \\(\\lambda = 1\\), so the general solution is \\[ r_i = (A + Bi) 1^i = A+Bi . \\] Again, we use the boundary conditions, to get \\[\\begin{gather*} r_0 = A + B\\cdot 0 = A = 1, \\\\ r_m = A + Bm = 0 , \\end{gather*}\\] and we immediately see that \\(A = 1\\) and \\(B = -1/m\\). Thus the solution is \\[ r_i = 1 - \\frac{1}{m}i = 1 - \\frac{i}{m} , \\] as claimed last time. 4.3 Inhomogeneous linear difference equations Solving inhomogeneous linear difference equations requires three steps: Find the general solution to the homogeneous equation by writing down and solving the characteristic equation. By making an “educated guess”, find a solution (a “particular solution”) to the inhomogeneous equation. The general solution to the inhomogeneous equation is a particular solution plus the general solution to the homogeneous equation. Use the extra conditions to find the values of the constants in the general solution. This idea works because, once you have a particular solution, adding a solution to the homogeneous equation to the left-hand side adds zero to the right-hand side, so maintains a solution to the inhomogeneous equation. Let’s work through the example \\[ x_{n+2} - 5x_{n+1} + 6x_{n} = 2 \\qquad \\text{subject to } x_0 = 4, x_1 = 9 . \\] We already know from earlier that the general solution to the homogeneous equation \\(x_{n+2} - 5x_{n+1} + 6x_{n} = 0\\) (with a zero on the right-hand side) is \\[ x_n = A2^n + B3^n . \\] We now need to find a particular solution – that is, any solution – to our new inhomogeneous equation. The usual process here is to guess a solution with the same “shape” as the right-hand side. For example, if the right-hand side is a constant, try a constant for the particular solution. Here our right-hand side is the constant \\(2\\), so we should try a constant \\(x_n = C\\). Substituting this into the inhomogeneous equation gives us \\(C - 5C + 6C = 2\\), thus \\(2C = 2\\) and \\(C = 1\\), giving a particular solution \\(x_n = 1\\). The general solution to the inhomogeneous equation is therefore \\[ x_n = 1 + A2^n + B3^n , \\] the sum of the particular solution \\(x_n = 1\\) and the general solution to the homogeneous equation. Because the right-hand side was a constant, we guessed a constant – this is the main case we will deal with. Other cases you could come across include: If the right-hand side is a polynomial of degree \\(d\\), try a polynomial of degree \\(d\\). If the right-hand side is \\(\\alpha^n\\) for some \\(\\alpha\\), try \\(C\\alpha^n\\). If the right-hand side is a constant, but a constant \\(C\\) doesn’t work, try \\(Cn\\). If that still doesn’t work, try \\(Cn^2\\), and so on. A general rule is that is 1 is a root of the characteristic equation with multiplicity \\(m\\), you need to try \\(Cn^m\\). We discuss this case further in the next subsection. Continuing with the example, we use the initial conditions to get the constants \\(A\\) and \\(B\\). We have \\[\\begin{gather*} x_0 = 1 + A2^0 + B3^0 = 1+ A + B = 4 , \\\\ x_1 = 1 + A2^1 + B3^1 = 1+ 2A + 3B = 9 . \\end{gather*}\\] The second equation minus twice the first gives \\(-1 + B = 1\\), so \\(B=2\\), and substituting that back into the first gives \\(A = 1\\). Thus the solution is \\[ x_n = 1 + 1\\cdot 2^n + 2 \\cdot 3^n = 1 + 2^n + 2 \\cdot 3^n . \\] Here’s another example. Example 4.3 Solve the inhomogeneous linear difference equation \\[ 10 x_{n+2} - 7x_{n+1} + x_n = 8 \\qquad \\text{subject to} \\quad x_0 = 0,\\quad x_1 = \\tfrac{13}{10} . \\] Step 1. The characteristic equation is \\[ 10\\lambda^2 - 7\\lambda + 1 = 0 . \\] We can solve this by factorising it as \\[ (2\\lambda - 1) (5\\lambda - 1) = 0 , \\] to find the solutions \\(\\lambda_1 = \\frac12\\) and \\(\\lambda_2 = \\frac15\\). Thus the general solution of the homogeneous equation is \\[ x_n = A\\left(\\frac12\\right)^n + B\\left(\\frac15\\right)^n . \\] Step 2. Since the right hand side of the inhomogeneous equation is a constant, we guess a constant particular solution with shape \\(x_n = C\\). Substituting in this guess, we get \\[ 10C - 7C + C = 4C = 8 \\] with solution \\(C=2\\). Thus a particular solution is \\(x_n = 2\\), and the general solution to the inhomogeneous equation is \\[ x_n = 2 + A\\left(\\frac12\\right)^n + B\\left(\\frac15\\right)^n . \\] Step 3. Substituting the initial conditions into the general solution, we have \\[\\begin{align*} x_0 = 2 + A\\left(\\frac12\\right)^0 + B\\left(\\frac15\\right)^0 = 2 + A + B = 0 \\quad &amp;\\Rightarrow \\quad A + B = -2 \\\\ x_1 = 2 + A\\left(\\frac12\\right)^1 + B\\left(\\frac15\\right)^1 = 2 + A\\frac12 + B\\frac15 = \\frac{13}{10} \\quad &amp;\\Rightarrow \\quad 5A + 2B = -7. \\end{align*}\\] We can take twice the first equation abd subtract the second to get \\(-3A = 3\\), so \\(A = -1\\). We can substitute this into the second equation to get \\(B = -1\\). The solution is therefore \\[ x_n = 2 - \\left(\\frac12\\right)^n - \\left(\\frac15\\right)^n . \\] 4.4 Expected duration for the gambler’s ruin From last time, the expected duration of the gambler’s ruin game solves \\[ pd_{i+1} - d_i + qd_{i-1} = -1 \\qquad \\text{subject to} \\qquad d_0 = 0,\\ d_m = 0. \\] As before, we divide cases based on whether or not \\(\\rho = 1\\). First, the case \\(\\rho \\neq 1\\). We already know that the general solution to the homogeneous equation is \\[ d_i = A \\rho^i + B . \\] Now we need a particular solution. It’s tempting to guess a constant \\(C\\) for a particular solution, but we know that constants solve the homogeneous equation, since \\(d_i = B\\) is a solution, so a constant will give right-hand side \\(0\\), not \\(-1\\). (We could try out \\(x_i = C\\) if we wanted; we would get \\((p - 1 + q)C = -1\\), but \\(p-1+q=0\\), and \\(0 \\times C = -1\\) has no solution.) The next best try is to go one degree up: let’s guess \\(x_i = Ci\\) instead. This gives \\[\\begin{align*} -1 &amp;= pC(i+1) - Ci + qC(i-1)\\\\ &amp;= C(pi + p - i + qi - q) \\\\ &amp;= C\\big((p+q-1)i + (p-q)\\big) \\\\ &amp;= C(p-q) , \\end{align*}\\] since \\(p + q - 1 = 1 - 1 = 0\\). This \\(C = -1/(p-q) = 1/(q-p)\\). Finding a solution for \\(C\\) shows that our guess worked. The general solution to the inhomogeneous equation is \\[ d_i = \\frac{i}{q-p} + A \\rho^i + B . \\] Then to find the constants, we have \\[\\begin{gather*} d_0 = \\frac{0}{q-p} + A \\rho^0 + B = A+B = 0, \\\\ d_m = \\frac{m}{q-p} + A \\rho^m + B = 0 , \\end{gather*}\\] which you can check gives \\[ A = -B = \\frac{m}{q-p} \\cdot \\frac{1}{1 - \\rho^m} . \\] Hence, the solution is \\[ d_i = \\frac{i}{q-p} + \\frac{m}{q-p} \\frac{1}{1 - \\rho^m} \\rho^i - \\frac{m}{q-p} \\frac{1}{1 - \\rho^m} = \\frac{1}{q-p} \\left(i - m\\frac{1-\\rho^i}{1- \\rho^m} \\right) . \\] Second, the case \\(\\rho = 1\\), so \\(p = q = \\frac12\\). We already know that the general solution to the homogeneous equation is \\[ d_i = A + Bi . \\] We need a particular solution. Since 1 is a double root of the characteristic equation, both constants \\(x_i = A\\) and linear \\(x_i = Bi\\) terms solve the homogeneous equation. (You can check that guessing \\(x_i = C\\) or \\(x_i = Ci\\) doesn’t work, if you like.) So we’ll have to go up another degree and try \\(x_i = Ci^2\\). This gives \\[\\begin{align*} -1 &amp;= \\tfrac12 C(i+1)^2 - Ci^2 + \\tfrac 12 C(i-1)^2 \\\\ &amp;= \\tfrac12 C(i^2 + 2i + 1 - 2i^2 + i^2 - 2i + 1) \\\\ &amp;= \\tfrac12 C\\big((1-2+1)i^2 + (2-2)i + (1+1)\\big) \\\\ &amp;=C , \\end{align*}\\] so the general solution to the inhomogeneous equation is \\[ d_i = -i^2 + A + Bi . \\] Then to find the constants, we have \\[\\begin{gather*} d_0 = -0^2 + A + B\\cdot0 = A = 0, \\\\ d_m = -m^2 + A + Bm = 0 , \\end{gather*}\\] giving \\(A = 0, B = m\\). The solution is \\[ d_i = -i^2 + 0 + mi = i(m-i) .\\] In the next section, we move on from the specific cases we’ve looked at so far to the general theory of discrete time Markov chains. "],["P02.html", "Problem sheet 2", " Problem sheet 2 .fold-btn { float: right; margin: -12px 0 0 0; } You should attempt all these questions and write up your solutions in advance of your workshop in week 3 (Monday 8 or Tuesday 9 February) where the answers will be discussed. 1. Solve the following linear difference equations: (a) \\(x_{n+2} - 4x_{n+1} + 3x_{n} = 0\\), subject to \\(x_0 = 0\\), \\(x_1 = 2\\). Solution. The characteristic equation is \\(\\lambda^2 - 4\\lambda + 3 = 0\\), which factorises as \\((\\lambda - 3)(\\lambda - 1) = 0\\), with solutions \\(\\lambda = 1,3\\), so the general solution is \\(x_n = A1^n + B3^n = A + B3^n\\). The initial conditions give \\(A+B = 0\\) and \\(A + 3B = 2\\), meaning \\(B = 1\\) and \\(A = -1\\). Hence the solution is \\(x_n = 3^n - 1\\). (b) \\(4x_{n+1} = 4x_n - x_{n-1}\\), subject to \\(x_0 = 1\\), \\(x_1 = 0\\). Solution. First, we rearrange to \\(4x_{n+1} - 4x_n + x_{n-1} = 0\\). The characteristic equation is \\(4\\lambda^2 - 4\\lambda + 1 = 0\\), which factorises as \\((2\\lambda - 1)^2 = 0\\), which has a repeated root \\(\\lambda = \\frac12\\), so the general solution is \\(x_n = (A + Bn)(\\frac12)^n\\). The initial conditions give \\(A=1\\) and \\((A + B)/2 = 0\\), meaning \\(B = -1\\). Hence the solution is \\(x_n = (1 - n)(\\frac12)^n\\). (c) \\(x_n-5x_{n-1} + 6x_{n-2} = 1\\), subject to \\(x_0 = 1\\), \\(x_1 = 2\\). Solution. The characteristic equation is \\(\\lambda^2 - 5\\lambda + 6 = 0\\), which factorises as \\((\\lambda - 2)(\\lambda - 3) = 0\\), with solutions \\(\\lambda = 2,3\\), so the general solution to the homogeneous equation is \\(A2^n + B3^n\\). For a particular solution, we guess a solution of the form \\(x_n = C\\); substituting this into the inhomogeneous equation gives \\(C - 5C + 6C = 1\\), so \\(C = \\frac12\\). So the general solution to the inhomogeneous equation is \\(x_n = A2^n + B3^n + \\frac12\\). The initial conditions give \\(A+B \\frac12= 1\\) and \\(2A + 3B + \\frac12= 2\\), which is solved by \\(B = \\frac12\\) and \\(A = 0\\). Hence the solution is \\(x_n = \\frac12 3^n + \\frac12 = (3^n + 1)/2\\). (d) \\(x_{n+2} - 2x_{n+1} + x_n = -1\\), subject to \\(x_0 = 0\\), \\(x_1 = 2\\). Solution. The characteristic equation is \\(\\lambda^2 - 2\\lambda + 1 = 0\\), which factorises as \\((\\lambda - 1)^2 = 0\\), with a repeated root \\(\\lambda = 1\\), so the general solution to the homogeneous equation is \\((A + Bn)1^n = A + Bn\\). For a particular solution, since constant and linear terms will equal \\(0\\), not \\(-1\\), we guess a solution of the form \\(x_n = Cn^2\\); substituting this into the inhomogeneous equation gives \\[ C(n+2)^2 - 2C(n+1)^2 + Cn^2 = 2C = -1 \\] so \\(C = -\\frac12\\). So the general solution to the inhomogeneous equation is \\(x_n = A + Bn - \\frac12 n^2\\). The initial conditions give \\(A = 0\\) and \\(A + B - \\frac12= 2\\), so \\(B = \\frac52\\). Hence the solution is \\(x_n = \\frac52n - \\frac12n^2 = \\frac n2(5-n)\\). 2. Consider a simple symmetric random walk on the state space \\(\\mathcal{S} = \\{0,1,\\ldots ,m\\}\\) with an absorbing barrier at \\(0\\) and a reflecting barrier at \\(m\\). In other words, \\[ \\mathbb P(X_{n+1} = 0 \\mid X_n = 0) = 1 \\quad \\text{and} \\quad \\mathbb P(X_{n+1} = m-1 \\mid X_n = m) = 1 . \\] Let \\(\\eta_i\\) be the expected time until the the walk hits \\(0\\) when starting from \\(i \\in \\mathcal S\\). (a) Explain why \\((\\eta_i)\\) satisfies \\[ \\eta_i = 1 + \\tfrac12 \\eta_{i+1} +\\tfrac12 \\eta_{i-1} \\] for \\(i \\in \\{1,2,\\dots,m-1\\}\\). Solution. We condition on the first step. The first step itself takes time 1. After that, with probability \\(\\frac12\\) we are at state \\(i+1\\), with expected time remaining \\(\\eta_{i+1}\\), while with probability \\(\\frac12\\) we are at state \\(i-1\\), with expected time remaining \\(\\eta_{i-1}\\). (b) Give a similar equation for \\(\\eta_m\\), and state the value of \\(\\eta_0\\). Solution. From \\(m\\), we move to \\(m-1\\) with certainty, so conditioning on the first step gives \\(\\eta_m = 1 + \\eta_{m-1}\\). Clearly \\(\\eta_0 = 0\\), as we stop immediately. (c) Hence, find the value of \\(\\eta_i\\) for all \\(i \\in \\mathcal S\\). Solution. We rewrite the equation as \\(\\eta_{i+1} - 2 \\eta_i + \\eta_{i-1} = -2\\). This has characteristic equation \\(\\lambda^2 - 2\\lambda + 1 = 0\\), which factorises as \\((\\lambda-1)^2\\), with a repeated root of \\(1\\), so the general solution to the homogeneous equation is \\(A + Bi\\). By the same logic as before, we attempt a particular solution of the form \\(\\eta_i = Ci^2\\), which gives \\[ C(i+1)^2 - 2Ci^2 + C(i-1)^2 = 2C = -2 , \\] so \\(C = -1\\). The general solution to the inhomogeneous equation is therefore \\(\\eta_i = A + Bi - i^2\\). From the boundary condition \\(k_0 = 0\\) we have \\(A = 0\\). From the boundary condition \\(k_m = 1 + k_{m-1}\\) we have \\[ Bm - m^2 = 1 + B(m-1) - (m-1)^2 = Bm - B - m^2 +2m , \\] giving \\(B = 2m\\). Therefore the solution is \\(\\eta_i = 2mi - i^2 = i(2m - i)\\). (d) You should notice that your answer is the same as the expected duration of the gambler’s ruin for \\(p = \\frac12\\), except with \\(m\\) replaced by \\(2m\\). Can you explain why this might be? Solution. This is an example of the reflection principle. Let \\((Y_n)\\) be a gambler’s ruin (simple random walk with two absorbing barriers) on \\(\\{0,1,\\dots, 2m\\}\\). Then consider placing a mirror at \\(m\\), and viewing the Markov chain so that it remains in the first half \\(\\{0,1,\\dots,m\\}\\); more formally, we consider \\((X_n)\\) where \\[ X_n = \\begin{cases} Y_n &amp; \\text{if $Y_n \\leq m$} \\\\ 2m - Y_n &amp; \\text{if $Y_n &gt; m$.} \\end{cases} \\] Then \\((X_n)\\) is the half-reflecting random walk we consider in this question. Further, \\((X_n)\\) is absorbed at \\(0\\) when \\((Y_n)\\) is absorbed at either \\(0\\) or \\(2m\\), which has the given expected time \\(i(2m-i)\\). 3. Consider the gambler’s ruin problem with draws: at each step, Alice wins £1 with probability \\(p\\), loses £1 with probability \\(q\\), and neither wins nor loses any money with probability \\(s\\), where \\(p + q +s = 1\\), and \\(0 &lt; p,q,s&lt;1\\). Alice starts with £\\(a\\) and Bob with £\\((m-a)\\). (a) Let \\(r_i\\) be Alice’s probability of ruin given that she has £\\(i\\). (i) Write down a linear difference equation for \\((r_i)\\), remembering to include appropriate boundary conditions. Solution. By conditioning on the first step, we have \\[ r_i = pr_{i+1} + sr_i + qr_{i-1} , \\] which can be rearranged to \\[ pr_{i+1} - (1-s)r_i + qr_{i-1} = 0 . \\] The boundary conditions are \\(r_0 = 1\\) and \\(r_m = 0\\). (ii) Solve the linear difference equation, to find \\(r_a\\), Alice’s probability of ruin. You may assume that \\(p \\neq q\\). Solution. The characteristic equation is \\(p\\lambda^2 - (1-s)\\lambda + q = 0\\), which factorises as \\((p\\lambda - q)(\\lambda - 1) = 0\\), since \\(p + q = 1-s\\). The solutions are \\(\\lambda = q/p = \\rho\\) and \\(\\lambda = 1\\). Since we assume \\(p \\neq q\\), we have that \\(\\rho \\neq 1\\), so we have unique roots, and general solution \\(r_i = A + B \\rho^i\\). The boundary conditions give \\(A + B = 1\\) and \\(A + B\\rho^m = 0\\), meaning that \\(B = 1/(1-\\rho^m)\\) and \\(A = -\\rho^m/(1-\\rho^m)\\), so the solution is \\[ r_i = -\\frac{\\rho^m}{1-\\rho^m} + \\frac{1}{1-\\rho^m}\\rho^i = \\frac{\\rho^i - \\rho^m}{1-\\rho^m}. \\] (b) Let \\(d_i\\) be be the expected duration of the game from the point that Alice has £\\(i\\). (i) Write down a linear difference equation for \\((d_i)\\), remembering to include appropriate boundary conditions. Solution. By conditioning on the first step, we have \\[ d_i = p(1 + d_{i+1}) + s(1 + d_i) + q(1 + d_{i-1}) , \\] which after rearranging gives \\[ pd_{i+1} - (1-s)d_i + qd_{i-1} = -1. \\] The boundary conditions are \\(d_0 = 0\\) and \\(d_m = 0\\). (ii) Solve the linear difference equation, to find \\(d_a\\), the expected duration of the game. You may assume that \\(p \\neq q\\). Solution. As before, the solution to the homogeneous equation is \\(A + B\\rho^i\\). We try a particular solution of the for \\(d_i = Ci\\), and find that \\[ pC(i+1) -(1-s)Ci + qC(i-1) = C(p-q) = -1 ,\\] so \\(C= 1/(q-p)\\), and the general solution to the inhomogeneous equation is \\[ d_i = A + B\\rho^i + \\frac{i}{q-p} . \\] The boundary conditions give \\(A + B = 0\\) and \\(A + B \\rho^m + m/(q-p) = 0\\), meaning that \\[ B = -A = \\frac{m}{q-p} \\frac{1}{1-\\rho^m} . \\] Hence the solution is \\[ d_i = \\frac{1}{q-p} \\left(i - m\\frac{1-\\rho^i}{1-\\rho^m} \\right) . \\] (c) Alice starts playing against Bob in a standard gambler’s ruin game with probabilities \\(p \\neq q\\) and \\(s = 0\\). A draw probability \\(s &gt; 0\\) is then introduced in such a way that the ratio \\(\\rho = q/p\\) remains constant. Comment on how this changes Alice’s ruin probability and the expected duration of the game. Solution. The ruin probability does not change, as we see immediately. This is not surprising, as the win and lose probabilities for a round conditional on the round not being a draw have stayed the same. The expected duration of the game increases. If \\(\\rho = q/p\\) stays the same while introducing a draw probability \\(s\\), then the “new” \\(q\\) and \\(p\\) are \\((1-s)q\\) and \\((1-s)p\\), so \\(q-p\\) becomes\\((1-s)q - (1-s)p = (1-s)(q-p)\\). Hence expected duration goes up by a factor of \\(1/(1-s)\\). This makes sense, since number of rounds until a non-draw result is a geometric distribution with expectation \\(1/(1-s)\\), so each step takes \\(1/(1-s)\\) times as long on average. 4. The Fibonacci numbers are 1, 1, 2, 3, 5, 8, 13, 21, 34, …, where each number in the sequence is the sum of the two previous numbers. Show that the ratio of consecutive Fibonacci numbers tends to the “golden ratio” \\(\\phi = (1 + \\sqrt{5})/2\\). Solution. The Fibonacci numbers \\((F_n)\\) satisfy \\(F_{n+1} = F_n + F_{n-1}\\), which rearranges to \\(F_{n+1} -F_n - F_{n-1} = 0\\). The is a linear difference equation with characteristic equation \\(\\lambda^2 - \\lambda - 1 = 0\\). This has two solutions, which can be found using the quadratic formula. The solution with larger absolute value is \\(\\lambda_1 = (1+\\sqrt{5})/2 = \\phi\\), the golden ratio, and the solution with smaller absolute value is \\(\\lambda_2 = (1-\\sqrt{5})/2\\). Hence, the general solution to the equation is \\(F_n = A\\phi^n + B\\lambda_2^n\\). We could use the initial conditions \\(F_1 = 1\\) and \\(F_2 = 1\\) to find \\(A\\) and \\(B\\), but there’s no need to here. The ratio of consecutive Fibonacci numbers is \\[ \\frac{F_{n+1}}{F_n} = \\frac{A\\phi^{n+1} + B\\lambda_2^{n+1}}{A\\phi^n + B\\lambda_2^n} = \\frac{\\phi + B\\lambda_2^{n+1}/A\\phi^n}{1 + B\\lambda_2^n/A\\phi^n} \\to \\frac{\\phi + 0}{1 + 0} = \\phi \\] as \\(n \\to \\infty\\), since \\(|\\lambda_2/\\phi| &lt; 1\\) means that \\(\\lambda_2^n / \\phi^n \\to 0\\). "],["A1.html", "Assessment 1", " Assessment 1 A solutions sheet for this assessment is available on Minerva. Marks and feedback are available on Minerva and Gradescope respectively. 1. Let \\((X_n)\\) be a simple random walk that starts from \\(X_0 = 0\\) and on each step goes up one with probability \\(p\\) and down one with probability \\(q = 1-p\\). Calculate: (a) \\(\\mathbb P(X_6 = 0)\\), [1 mark] (b) \\(\\mathbb EX_6\\), [1] (c) \\(\\text{Var}(X_6)\\), [1] (d) \\(\\mathbb E(X_{10} \\mid X_4 = 4)\\), [1] (e) \\(\\mathbb P(X_{10} = 0 \\mid X_6 = 2)\\), [1] (f) \\(\\mathbb P(X_4 = 2 \\mid X_{10} = 6)\\). [1] Consider the case \\(p = 0.6\\), so \\(q = 0.4\\). (g) What are \\(\\mathbb E X_{100}\\) and \\(\\text{Var}(X_{100})\\)? [1] (h) Using a normal approximation, estimate \\(\\mathbb P(16 \\leq X_{100} \\leq 26)\\). You should use an appropriate “continuity correction”, and explain why you chose it. (Bear in mind the possible values \\(X_{100}\\) can take.) [3] 2. Consider the gambler’s ruin with draws: Alice starts with £\\(a\\) and Bob with £\\((m-a)\\), and at each time step Alice wins £1 off Bob with probability \\(p\\), loses £1 to Bob with probability \\(q\\), and no money is exchanged with probability \\(s\\), where \\(p+q+s =1\\). We consider the case where Bob and Alice are equally matched, so \\(p = q\\) and \\(s = 1-2p\\). (We assume \\(0 &lt; p &lt; 1/2\\).) Let \\(r_i\\) be Alice’s ruin probability from the point she has £\\(i\\). (a) By conditioning on the first step, explain why \\(pr_{i+1} - (1-s)r_i + pr_{i-1} = 0\\), and give appropriate boundary conditions. [2] (b) Solve this linear difference equation to find an expression for \\(r_i\\). [2] Let \\(d_i\\) be the expected duration of the game from the point Alice has £\\(i\\). (c) Explain why \\(pd_{i+1} - (1-s)d_i + pd_{i-1} = -1\\), and give appropriate boundary conditions. [2] (d) Solve this linear difference equation to find an expression for \\(d_i\\). [2] (e) Compare your answer to parts (b) and (d) with those for the standard gambler’s ruin problem with \\(p = 1/2\\), and give reasons for the similarities or differences. [2] "],["S05-markov-chains.html", "Section 5 Discrete time Markov chains 5.1 Time homogeneous discrete time Markov chains 5.2 A two-state example 5.3 n-step transition probabilities", " Section 5 Discrete time Markov chains Definition of time homogeneous discrete time Markov chains Calculating \\(n\\)-step transition properties The Chapman–Kolomogorov equations 5.1 Time homogeneous discrete time Markov chains So far we’ve seen a a few examples of stochastic processes in discrete time and discrete space with the Markov memoryless property. Now we will develop the theory more generally. To define a so-called “Markov chain”, we first need to say where we start from, and second what the probabilities of transitions from one state to another are. In our examples of the simple random walk and gambler’s ruin, we specified the start point \\(X_0 = i\\) exactly, but we could pick the start point at random according to some distribution \\(\\lambda_i = \\mathbb P(X_0 = i)\\). After that, we want to know the transition probabilities \\(\\mathbb P(X_{n+1} = j \\mid X_n = i)\\) for \\(i,j \\in \\mathcal S\\). Here, because of the Markov property, the transition probability only needs to condition on the state we’re in now \\(X_n = i\\), and not on the whole history of the process. In the case of the simple random walk, for example, we had initial distribution \\[ \\lambda_i = \\mathbb P(X_0 = i) = \\begin{cases} 1 &amp; \\text{if $i = 0$} \\\\ 0 &amp; \\text{otherwise} \\end{cases} \\] and transition probabilities \\[ \\mathbb P(X_{n+1} = j \\mid X_n = i) = \\begin{cases} p &amp; \\text{if $j = i+1$} \\\\ q &amp; \\text{if $j = i-1$} \\\\ 0 &amp; \\text{otherwise.} \\end{cases} \\] For the random walk (and also the gambler’s ruin), the transition probabilities \\(\\mathbb P(X_{n+1} = j \\mid X_n = i)\\) don’t depend on \\(n\\); in other words, the transition probabilities stay the same over time. A Markov process with this property is called time homogeneous. We will always consider time homogeneous processes from now on (unless we say otherwise). Let’s write \\(p_{ij} = \\mathbb P(X_{n+1} = j \\mid X_n = i)\\) for the transition probabilities, which are independent of \\(n\\). We must have \\(p_{ij} \\geq 0\\), since it is a probability, and we must also have \\(\\sum_j p_{ij} = 1\\) for all states \\(i\\), as this is the sum of the probabilities of all the places you can move to from state i. Definition 5.1 Let \\((\\lambda_i)\\) be a probability distribution on a sample space \\(\\mathcal S\\). Let \\(p_{ij}\\), where \\(i,j \\in \\mathcal S\\), be such that \\(p_{ij} \\geq 0\\) for all \\(i,j\\), and \\(\\sum_j p_{ij} = 1\\) for all \\(i\\). Let the time index be \\(n = 0,1,2,\\dots\\). Then the time homogeneous discrete time Markov process or Markov chain \\((X_n)\\) with initial distribution \\((\\lambda_i)\\) and transition probabilities \\((p_{ij})\\) is defined by \\[\\begin{gather*} \\mathbb P(X_0 = i) = \\lambda_i ,\\\\ \\mathbb P(X_{n+1} = j \\mid X_n = i, X_{n-1} = x_{n-1}, \\dots, X_0 = x_0) = \\mathbb P(X_{n+1} = j \\mid X_n = i) = p_{ij} . \\end{gather*}\\] When the state space is finite (and even sometimes when it’s not), it’s convenient to write the transition probabilities \\((p_{ij})\\) as a matrix \\(\\mathsf P\\), called the transition matrix, whose \\((i,j)\\)th entry is \\(p_{ij}\\). Then the condition that \\(\\sum_j p_{ij} = 1\\) is the condition that each of the rows of \\(\\mathsf P\\) add up to \\(1\\). Example 5.1 In this notation, what is \\(\\mathbb P(X_0 = i \\text{ and } X_1 = j)\\)? First we must start from \\(i\\), and then we must move from \\(i\\) to \\(j\\), so \\[ \\mathbb P(X_0 = i \\text{ and } X_1 = j) = \\mathbb P(X_0 = i)\\mathbb P(X_1 = j \\mid X_0 = i) = \\lambda_i p_{ij} . \\] In this notation, what is \\(\\mathbb P(X_{n+2} = j \\text{ and } X_{n+1} = k \\mid X_n = i)\\)? First we must move from \\(i\\) to \\(k\\), then we must move from \\(k\\) to \\(j\\), so \\[\\begin{align*} \\mathbb P(X_{n+2} = j \\text{ and } X_{n+1} = k \\mid X_n = i) &amp;= \\mathbb P(X_{n+1} = k \\mid X_n = i)\\mathbb P(X_{n+2} = j \\mid X_{n+1} = k) \\\\ &amp;= p_{ik}p_{kj} . \\end{align*}\\] Note that the term \\(\\mathbb P(X_{n+2} = j \\mid X_{n+1} = k)\\) did not have to depend on \\(X_n\\), thanks to the Markov property. 5.2 A two-state example Consider a simple two-state Markov chain with state space \\(\\mathcal S = \\{0,1\\}\\) and transition matrix \\[ \\mathsf P = \\begin{pmatrix} p_{00} &amp; p_{01} \\\\ p_{10} &amp; p_{11} \\end{pmatrix} = \\begin{pmatrix} 1-\\alpha &amp; \\alpha \\\\ \\beta &amp; 1-\\beta \\end{pmatrix} \\] for some \\(0 &lt; \\alpha, \\beta &lt; 1\\). Note that the rows of \\(\\mathsf P\\) add up to \\(1\\), as they must. We can illustrate \\(\\mathsf P\\) by a transition diagram, where the blobs are the states and the arrows give the transition probabilities. (We don’t draw the arrow if \\(p_{ij} = 0\\).) In this case, our transition diagram looks like this: Figure 5.1: Transition diagram for the two-state Markov chain We can use this as a simple model of a broken printer, for example. If the printer is broken (state 0) on one day, then with probability \\(\\alpha\\) it will be fixed (state 1) by the next day; while if it is working (state 1), then with probability \\(\\beta\\) it will have broken down (state 0) by the next day. Example 5.2 If the printer is working on Monday, what’s the probability that it also is working on Wednesday? If we call Monday day \\(n\\), then Wednesday is day \\(n+2\\), and we want to find the two-step transition probability. \\[ p_{11}(2) = \\mathbb P (X_{n+2} = 1 \\mid X_n = 1) . \\] The key to calculating this is to condition on the first step again – that is, on whether the printer is working on Tuesday. We have \\[\\begin{align*} p_{11}(2) &amp;= \\mathbb P (X_{n+1} = 0 \\mid X_n = 1)\\,\\mathbb P (X_{n+2} = 1 \\mid X_{n+1} = 0, X_n = 1) \\\\ &amp;\\qquad{} + \\mathbb P (X_{n+1} = 1 \\mid X_n = 1)\\,\\mathbb P (X_{n+2} = 1 \\mid X_{n+1} = 1, X_n = 1) \\\\ &amp;= \\mathbb P (X_{n+1} = 0 \\mid X_n = 1)\\,\\mathbb P (X_{n+2} = 1 \\mid X_{n+1} = 0) \\\\ &amp;\\qquad{} + \\mathbb P (X_{n+1} = 1 \\mid X_n = 1)\\,\\mathbb P (X_{n+2} = 1 \\mid X_{n+1} = 1) \\\\ &amp;= p_{10}p_{01} + p_{11}p_{11} \\\\ &amp;= \\beta\\alpha + (1-\\beta)^2 . \\end{align*}\\] In the second equality, we used the Markov property to mean conditional probabilities like \\(\\mathbb P(X_{n+2} = 1 \\mid X_{n+1} = k)\\) did not have to depend on \\(X_n\\). Another way to think of this as we summing the probabilities of all length-2 paths from 1 to 1, which are \\(1\\to 0\\to 1\\) with probability \\(\\beta\\alpha\\) and \\(1 \\to 1 \\to 1\\) with probability \\((1-\\beta)^2\\) 5.3 n-step transition probabilities In the above example, we calculated a two-step transition probability \\(p_{ij}(2) = \\mathbb P (X_{n+2} = j \\mid X_n = i)\\) by conditioning on the first step. That is, by considering all the possible intermediate steps \\(k\\), we have \\[ p_{ij}(2) = \\sum_{k\\in\\mathcal S} \\mathbb P (X_{n+1} = k \\mid X_n = i)\\mathbb P (X_{n+2} = j \\mid X_{n+1} = k) = \\sum_{k\\in\\mathcal S} p_{ik}p_{kj} . \\] But this is exactly the formula for multiplying the matrix \\(\\mathsf P\\) with itself! In other words, \\(p_{ij}(2) = \\sum_{k} p_{ik}p_{kj}\\) is the \\((i,j)\\)th entry of the matrix square \\(\\mathsf P^2 = \\mathsf{PP}\\). If we write \\(\\mathsf P(2) = (p_{ij}(2))\\) for the matrix of two-step transition probabilities, we have \\(\\mathsf P(2) = \\mathsf P^2\\). More generally, we see that this rule holds over multiple steps, provided we sum over all the possible paths \\(i\\to k_1 \\to k_2 \\to \\cdots \\to k_{n-1} \\to j\\) of length \\(n\\) from \\(i\\) to \\(j\\). Theorem 5.1 Let \\((X_n)\\) be a Markov chain with state space \\(\\mathcal S\\) and transition matrix \\(\\mathsf P = (p_{ij})\\). For \\(i,j \\in \\mathcal S\\), write \\[ p_{ij}(n) = \\mathbb P(X_n = j \\mid X_0 = i) \\] for the \\(n\\)-step transition probability. Then \\[ p_{ij}(n) = \\sum_{k_1, k_2, \\dots, k_{n-1} \\in \\mathcal S} p_{ik_1} p_{k_1k_2} \\cdots p_{k_{n-2}k_{n-1}} p_{k_{n-1}j} . \\] In particular, \\(p_{ij}(n)\\) is the \\((i,j)\\)th element of the matrix power \\(\\mathsf P^n\\), and the matrix of \\(n\\)-step transition probabilities is given by \\(\\mathsf P(n) = \\mathsf P^n\\). The so-called Chapman–Kolmogorov equations follow immediately from this. Theorem 5.2 (Chapman–Kolmogorov equations) Let \\((X_n)\\) be a Markov chain with state space \\(\\mathcal S\\) and transition matrix \\(\\mathsf P = (p_{ij})\\). Then, for non-negative integers \\(n,m\\), we have \\[ p_{ij}(n+m) = \\sum_{k \\in \\mathcal S} p_{ik}(n)p_{kj}(m) , \\] or, in matrix notation, \\(\\mathsf P(n+m) = \\mathsf P(n)\\mathsf P(m)\\). In other words, a trip of length \\(n + m\\) from \\(i\\) to \\(j\\) is a trip of length \\(n\\) from \\(i\\) to some other state \\(k\\), then a trip of length \\(m\\) from \\(k\\) back to \\(j\\), and this intermediate stop \\(k\\) can be any state, so we have to sum the probabilities. Of course, once we know that \\(\\mathsf P(n) = \\mathsf P^n\\) is given by the matrix power, it’s clear to see that \\(\\mathsf P(n+m) = \\mathsf P^{n+m} = \\mathsf P^n \\mathsf P^m = \\mathsf P(n)\\mathsf P(m)\\). Sidney Chapman (1888–1970) was a British applied mathematician and physicist, who studied applications of Markov processes. Andrey Nikolaevich Kolmogorov (1903–1987) was a Russian mathematician who did very important work in many different areas of mathematics, is considered the “father of modern probability theory”, and studied the theory of Markov processes. (Kolmogorov is also my academic great-great-grandfather.) Example 5.3 In our two-state broken printer example above, the matrix of two-state transition probabilities is given by \\[\\begin{align*} \\mathsf P(2) = \\mathsf P^2 &amp;= \\begin{pmatrix} 1-\\alpha &amp; \\alpha \\\\ \\beta &amp; 1-\\beta \\end{pmatrix} \\begin{pmatrix} 1-\\alpha &amp; \\alpha \\\\ \\beta &amp; 1-\\beta \\end{pmatrix} \\\\ &amp;= \\begin{pmatrix} (1-\\alpha)^2 + \\alpha\\beta &amp; (1-\\alpha)\\alpha + \\alpha(1-\\beta) \\\\ \\beta(1-\\alpha) + (1-\\beta)\\beta &amp; \\beta\\alpha + (1-\\beta)^2 \\end{pmatrix} , \\end{align*}\\] where the bottom right entry \\(p_{11}(2)\\) is what we calculated earlier. One final comment. It’s also convenient to consider the initial distribution \\(\\boldsymbol\\lambda = (\\lambda_i)\\) as a row vector. The first-step distribution is given by \\[ \\mathbb P(X_1 = j) = \\sum_{i \\in \\mathcal S} \\lambda_i p_{ij} , \\] by conditioning on the start point. This is exactly the \\(j\\)th element of the vector–matrix multiplication \\(\\boldsymbol\\lambda \\mathsf P\\). More generally, the row vector of of probabilities after \\(n\\) steps is given by \\(\\boldsymbol\\lambda \\mathsf P^n\\). In the next section, we look at how to model some actuarial problems using Markov chains. "],["S06-examples.html", "Section 6 Examples from actuarial science 6.1 A simple no-claims discount model 6.2 An accident model with memory 6.3 A no-claims discount model with memory", " Section 6 Examples from actuarial science Three Markov chain models for insurance problems In this lecture we’ll set up three simple models for an insurance company that can be analysed using ideas about Markov chains. The first example has a direct Markov chain model. For the second and third examples, we will have to be clever to find a Markov chain associated to the situation. 6.1 A simple no-claims discount model A motor insurance company puts policy holders into three categories: no discount on premiums (state 1) 25% discount on premiums (state 2) 50% discount on premiums (state 3) New policy holders start with no discount (state 1). Following a year with no insurance claims, policy holders move up one level of discount. If they start the year in state 3 and make no claim, they remain in state 3. Following a year with at least one claim, they move down one level of discount. If they start the year in state 1 and make at least one claim, they remain in state 1. The insurance company believes that probability that a motorist has a claim free year is \\(\\frac34\\). We can model this directly as a Markov chain: the state space \\(\\mathcal S = \\{1,2,3\\}\\) is discrete; the time index is discrete, as we have one discount level each year; the probability of being in a certain state at a future time is completely determined by the present state (the Markov property); the one-step transition probabilities are not time dependent (time homogeneous). The transition probability and transition diagram of the Markov chain are: \\[ \\mathsf P = \\begin{pmatrix} \\frac14 &amp; \\frac34 &amp; 0 \\\\ \\frac14 &amp; 0 &amp; \\frac34 \\\\ 0 &amp; \\frac14 &amp; \\frac34 \\end{pmatrix} . \\] Figure 6.1: Transition diagram for the simple no-claims discount model Example 6.1 What is the probability of having a 50% reduction to your premium three years from now, given that you currently have no reduction on the premium? We want to find the three-step transition probability \\[ p_{13}(3) = \\mathbb P(X_{3} = 3 \\mid X_0=1) . \\] We can find this by summing over all paths \\(1 \\to k_1 \\to k_2 \\to 3\\). There are two such paths, \\(1 \\to 1 \\to 2 \\to 3\\) and \\(1 \\to 2 \\to 3 \\to 3\\). Thus \\[ p_{13}(3) = p_{11}p_{12}p_{23} + p_{12}p_{23}p_{33} = \\frac14 \\cdot\\frac34 \\cdot\\frac34 + \\frac34 \\cdot\\frac34 \\cdot\\frac34 = \\frac{36}{64} = \\frac{9}{16} . \\] Alternatively, we could directly calculate all the three-step transition probabilities by the matrix method, to get \\[ \\mathsf P(3) = \\mathsf P^3 = \\mathsf{PPP} = \\frac{1}{64} \\begin{pmatrix} 7 &amp; 21 &amp; 36 \\\\ 7 &amp; 12 &amp; 45 \\\\ 4 &amp; 15 &amp; 45 \\end{pmatrix} .\\] (You can check this yourself, if you want.) The desired \\(p_{13}(3)\\) is the top right entry \\(36/64 = 9/16\\). 6.2 An accident model with memory Sometimes, we are presented with a situation where the “obvious” stochastic process is not a Markov chain. But sometimes we can find a related process that is a Markov chain, and study that instead. As an example of this, we consider at a different accident model. According to a different model, a motorist’s \\(n\\)th year of driving is either accident free, or has exactly one accident. (The model does not allow for more than one accident in a year.) Let \\(Y_n\\) be a random variable so that, \\[ Y_n=\\begin{cases} 0&amp;\\text{ if the motorist has no accident in year $n$,}\\\\ 1&amp;\\text{ if the motorist has one accident in year $n$.} \\end{cases} \\] This defines a stochastic process \\((Y_n)\\) with finite state space \\(\\mathcal{S}=\\{0,1\\}\\) and discrete time \\(n = 1,2,3,\\dots\\). The probability of an accident in year \\(n+1\\) is modelled as a function of the total number of previous accidents over a function of the number of years in the policy; that is, \\[ \\mathbb P(Y_{n+1}= 1 \\mid Y_n=y_{n},\\dots ,Y_2=y_{2},Y_1=y_{1} )=\\frac{f(y_1+y_2+\\cdots +y_n)}{g(n)}, \\] and \\(Y_{n+1} = 0\\) otherwise, where \\(f\\) and \\(g\\) are non-negative increasing functions with \\(0\\leq f(m)\\leq g(m)\\) for all \\(m\\). (We’ll come back to these conditions in a moment.) Unfortunately \\((Y_n)\\) is not a Markov chain – it’s clear that \\(Y_{n+1}\\) depends not only on \\(Y_n\\), the number accidents this year, but the entire history \\(Y_1, Y_2, \\dots, Y_n\\). However, we have a cunning work-around. Define \\(X_n=\\sum_{i=1}^n Y_i\\) to be the total number of accidents up to year \\(n\\). Then \\((X_n)\\) is a Markov chain. In fact, we have \\[\\begin{align*} \\mathbb P(X_{n+1}={}&amp;{}x_{n}+1\\mid X_n=x_n, \\dots, X_2=x_2, X_1=x_1)\\\\ &amp;=\\mathbb P(Y_{n+1}=1\\mid Y_n=x_n - x_{n-1}, \\dots Y_2=x_2-x_1, Y_1=x_1)\\\\ &amp;=\\frac{f\\big((x_n-x_{n-1}) +\\cdots +(x_2-x_1) + x_1\\big)}{g(n)}\\\\ &amp;=\\frac{f(x_n)}{g(n)}, \\end{align*}\\] and \\(X_{n+1} = x_n\\) otherwise. This clearly depends only on \\(x_n\\). Thus we can use Markov chain techniques on \\((X_n)\\) to lean about the non-Markov process \\((Y_n)\\). Note that the probability that \\(X_{n+1} = x_n\\) or \\(x_n+ 1\\) depends not only on \\(x_n\\) but also on the time \\(n\\). So this is a rare example of a time inhomogeneous Markov process, where the transition probabilities do depend on the time \\(n\\). Before we move on, let’s think about the conditions we placed on this model. First, the condition that \\(f\\) is increasing means that between drivers who have been driving the same number of years, we think the more accident-prone in the past is more likely to have an accident in the future. Second, the condition that \\(g\\) is increasing means that between drivers who have had the same number of accidents, we think the one who has spread those accidents over a longer period of time is less likely to have accidents in the future. Third, the transition probabilities should lie in the range \\([0,1]\\); but since \\(\\sum_{i=1}^m y_i\\leq m\\), our condition \\(0\\leq f(m)\\leq g(m)\\) guaranteed that this is the case. 6.3 A no-claims discount model with memory Sometimes, we are presented with a stochastic process which is not a Markov chain, but where by altering the state space \\(\\mathcal{S}\\) we can end up with a process which is a Markov chain. As such, when making a model, it is important to think carefully about choice of state space. To see this we will return to the no-claims discount example. Suppose now we have an model with four levels of discount: no discount (state 1) 20% discount (state 2) 40% discount (state 3) 60% discount (state 4) If a year is accident free, then the discount increases one level, to a maximum of 60%. This time, if the year has an accident, then the discount decreases by one level if the year previous to that was accident free, but decreases by two levels if the previous year had an accident as well, both to a minimum of no discount. As before, the insurance company believes that probability that a motorist has a claim-free year is \\(\\frac34 = 0.75\\). We might consider the most natural choice of a state space, where the states are discount levels; say, \\(\\mathcal{S}=\\{1,2,3,4\\}\\). But this is not a Markov chain, since if a policy holder has an accident, we may need to know about the past in order to determine probabilities for future states, which violates the Markov property. In particular, if a motorist is in state 3 (40% discount) and has an accident, they will either move down to level 2 (if they had not crashed the previous year, so had previously been in state 2) or to level 1 (if they had crashed the previous year, so had previously been in state 4) – but that depends on their previous level too, which the Markov property doesn’t allow. (You can check this is the only violation of the Markov property.) However, we can be clever again, this time in the choice of our state space. Instead, we can split the 40% level into two different states: state “3a” if there was no accident the previous year, and state “3b” if there was an accident the previous year. Our states are now: no discount (state 1) 20% discount (state 2) 40% discount, no claim in previous year (state 3a) 40% discount, claim in previous year (state 3b) 60% discount (state 4) Now this is a Markov chain, because the new states 3s carry with them the memory of the previous year, to ensure the Markov property is preserved. Under the assumption of 25% of drivers having an accident each year, the transition matrix is \\[ \\mathsf P=\\begin{pmatrix} 0.25 &amp; 0.75 &amp; 0 &amp; 0 &amp; 0\\\\ 0.25 &amp; 0 &amp; 0.75 &amp; 0 &amp; 0\\\\ 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0.75\\\\ 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.75\\\\ 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0.75\\end{pmatrix}. \\] The transition diagram is shown below. (Recall that we don’t draw arrows with probability 0.) Figure 6.2: Transition diagram for the no-claims discount model with memory Note that when we move up from state 2, we go to 3a (no accident in the previous year); but when we move down from state 4, we go to 3b (accident in the previous year). In the next section, we look at how to study big Markov chains by splitting them into smaller pieces called “classes”. "],["P03.html", "Problem sheet 3", " Problem sheet 3 .fold-btn { float: right; margin: -12px 0 0 0; } You should attempt all these questions and write up your solutions in advance of your workshop in week 4 (Monday 15 or Tuesday 16 February) where the answers will be discussed. 1. Consider a Markov chain with state space \\(\\mathcal S = \\{1,2,3\\}\\), and transition matrix partially given by \\[ \\mathsf P = \\begin{pmatrix} ? &amp; 0.3 &amp; 0.3 \\\\ 0.2 &amp; 0.4 &amp; ? \\\\ ? &amp; ? &amp; 1 \\end{pmatrix} . \\] (a) Replace the four question marks by the appropriate transition probabilities. Solution. Rows must add up to 1 and every entry must be non-negative, so the transition matrix is \\[ \\mathsf P = \\begin{pmatrix} 0.4 &amp; 0.3 &amp; 0.3 \\\\ 0.2 &amp; 0.4 &amp; 0.4 \\\\ 0 &amp; 0 &amp; 1 \\end{pmatrix} . \\] (b) Draw a transition diagram for this Markov chain. Solution. Figure 6.3: Transition diagram for Question 1. (c) Find the matrix \\(\\mathsf P(2)\\) of two-step transition probabilities. Solution. \\({\\displaystyle \\mathsf P(2) = \\mathsf P^2 = \\begin{pmatrix} 0.22 &amp; 0.24 &amp; 0.54 \\\\ 0.16 &amp; 0.22 &amp; 0.62 \\\\ 0 &amp; 0 &amp; 1 \\end{pmatrix}}\\) (d) By summing the probabilities of all relevant paths, find the three-step transition probability \\(p_{13}(3)\\). Solution. There are seven relevant paths: \\(1 \\to 1 \\to 1 \\to 3\\), \\(1 \\to 1 \\to 2 \\to 3\\), \\(1 \\to 1 \\to 3 \\to 3\\), \\(1 \\to 2 \\to 1 \\to 3\\), \\(1 \\to 2 \\to 2 \\to 3\\), \\(1 \\to 2 \\to 3 \\to 3\\), and \\(1 \\to 3 \\to 3 \\to 3\\). So \\[\\begin{align*} p_{13}(3) &amp;= p_{11}p_{11}p_{11}p_{13} + p_{11}p_{12}p_{23} + p_{11}p_{13}p_{33} + p_{12} p_{21} p_{13}\\\\ &amp; \\qquad{}+ p_{12}p_{22}p_{23} + p_{12}p_{23}p_{33} + p_{13}p_{33}p_{33}\\\\ &amp; = 0.4 \\cdot 0.4 \\cdot 0.3 + 0.4\\cdot 0.3\\cdot 0.4 + 0.4\\cdot 0.3 \\cdot 1 + 0.3 \\cdot 0.2 \\cdot 0.3 \\\\ &amp; \\qquad{}+ 0.3\\cdot 0.4 \\cdot 0.4 + 0.3 \\cdot 0.4 \\cdot 1 + 0.3 \\cdot 1 \\cdot 1\\\\ &amp;= 0.702 \\end{align*}\\] 2. Consider a Markov chain \\((X_n)\\) which moves between the vertices of a tetrahedron. At each time step, the process randomly chooses one of the edges connected to the current vertex and follows it to a new vertex. The edge to follow is selected randomly with all options having equal probability and each selection is independent of the past movements. Let \\(X_n\\) be the vertex the process is in after step \\(n\\). (a) Write down the transition matrix \\(\\mathsf P\\) of this Markov chain. The chain can move from a state to any of the other \\(3\\) states, each with probability \\(1/3\\). So \\[ \\mathsf P = \\begin{pmatrix} 0 &amp; \\frac13 &amp; \\frac13 &amp; \\frac13 \\\\ \\frac13 &amp; 0 &amp; \\frac13 &amp; \\frac13 \\\\ \\frac13 &amp; \\frac13 &amp; 0 &amp; \\frac13 \\\\ \\frac13 &amp; \\frac13 &amp; \\frac13 &amp; 0 \\end{pmatrix} . \\] (b) By summing over all relevant paths of length two, calculate the two-step transition probabilities \\(p_{11}(2)\\) and \\(p_{12}(2)\\). Hence, write down the two-step transition matrix \\(\\mathsf P(2)\\). The length-2 paths from 1 to 1 are \\(1 \\to k \\to 1\\) for \\(k = 2,3,4\\), so \\[ p_{11}(2) = p_{12}p_{21} + p_{13}p_{31} + p_{14}p_{41} = \\tfrac13 \\tfrac13 + \\tfrac13 \\tfrac13 + \\tfrac13 \\tfrac13 = \\tfrac13 . \\] The length-2 paths from 1 to 2 are \\(1 \\to 3 \\to 2\\) and \\(1 \\to 4 \\to 2\\), so \\[ p_{12}(2) = p_{13}p_{32} + p_{14}p_{42} = \\tfrac13 \\tfrac13 + \\tfrac13 \\tfrac13 = \\tfrac29 . \\] By symmetry, \\(p_{ii}(2) = p_{11}(2)\\) for all \\(i\\), and \\(p_{ij}(2) = p_{12}(2)\\) for all \\(i \\neq j\\). Therefore \\[ \\mathsf P(2) = \\begin{pmatrix} \\frac13 &amp; \\frac29 &amp; \\frac29 &amp; \\frac29 \\\\ \\frac29 &amp; \\frac13 &amp; \\frac29 &amp; \\frac29 \\\\ \\frac29 &amp; \\frac29 &amp; \\frac13 &amp; \\frac29 \\\\ \\frac29 &amp; \\frac29 &amp; \\frac29 &amp; \\frac13 \\end{pmatrix} . \\] (c) Check your answer by calculating the matrix square \\(\\mathsf P^2\\). We can verify that \\[ \\mathsf P^2 = \\begin{pmatrix} 0 &amp; \\frac13 &amp; \\frac13 &amp; \\frac13 \\\\ \\frac13 &amp; 0 &amp; \\frac13 &amp; \\frac13 \\\\ \\frac13 &amp; \\frac13 &amp; 0 &amp; \\frac13 \\\\ \\frac13 &amp; \\frac13 &amp; \\frac13 &amp; 0 \\end{pmatrix} \\begin{pmatrix} 0 &amp; \\frac13 &amp; \\frac13 &amp; \\frac13 \\\\ \\frac13 &amp; 0 &amp; \\frac13 &amp; \\frac13 \\\\ \\frac13 &amp; \\frac13 &amp; 0 &amp; \\frac13 \\\\ \\frac13 &amp; \\frac13 &amp; \\frac13 &amp; 0 \\end{pmatrix}= \\begin{pmatrix} \\frac13 &amp; \\frac29 &amp; \\frac29 &amp; \\frac29 \\\\ \\frac29 &amp; \\frac13 &amp; \\frac29 &amp; \\frac29 \\\\ \\frac29 &amp; \\frac29 &amp; \\frac13 &amp; \\frac29 \\\\ \\frac29 &amp; \\frac29 &amp; \\frac29 &amp; \\frac13 \\end{pmatrix} , \\] as above. Figure 6.4: A tetrahedron 3. Consider the two-state “broken printer” Markov chain, with state space \\(\\mathcal S = \\{0,1\\}\\), transition matrix \\[ \\mathsf P = \\begin{pmatrix} 1-\\alpha &amp; \\alpha \\\\ \\beta &amp; 1-\\beta \\end{pmatrix} \\] with \\(0 &lt; \\alpha, \\beta &lt; 1\\), and initial distribution \\(\\boldsymbol\\lambda = (\\lambda_0, \\lambda_1)\\). Write \\(\\mu_n =\\mathbb P(X_n = 0)\\). (a) By writing \\(\\mu_{n+1}\\) in terms of \\(\\mu_n\\), show that we have \\[ \\mu_{n+1} - \\big(1-(\\alpha+\\beta)\\big)\\mu_n = \\beta . \\] Using the law of total probability, we have \\[\\begin{multline*} \\mathbb P(X_{n+1} = 0) = \\mathbb P(X_n = 0)\\,\\mathbb P(X_{n+1} = 0 \\mid X_n = 0) \\\\ + \\mathbb P(X_n = 1)\\,\\mathbb P(X_{n+1} = 0 \\mid X_n = 1) , \\end{multline*}\\] which in terms of \\((\\mu_n)\\) is \\[ \\mu_{n+1} = \\mu_n (1-\\alpha) + (1 - \\mu_n)\\beta . \\] We used here that \\(\\mathbb P(X_n = 1) = 1-\\mu_n\\). Rearranging this gives the answer. (b) By solving this linear difference equation using the initial condition \\(\\mu_0 = \\lambda_0\\), or otherwise, show that \\[ \\mu_n = \\frac{\\beta}{\\alpha+\\beta} + \\left(\\lambda_0 - \\frac{\\beta}{\\alpha+\\beta}\\right)\\big(1-(\\alpha+\\beta)\\big)^n . \\] The characteristic equation is \\(\\lambda - (1-(\\alpha+\\beta)) = 0\\) with a single root at \\(\\lambda = 1 - (\\alpha+\\beta)\\). The general solution to the homogeneous equation is, therefore, \\(A(1-(\\alpha+\\beta))^n\\). For a particular solution, we guess a solution \\(\\mu_n = C\\), and \\(C - (1-(\\alpha+\\beta))C = \\beta\\) gives \\(C = \\beta/(\\alpha+\\beta)\\). Thus the general solution to the inhomogeneous equation is \\[ \\mu_n = \\frac{\\beta}{\\alpha+\\beta} + A\\big(1-(\\alpha+\\beta)\\big)^n .\\] From the initial condition, we get \\(\\lambda_0 = \\beta/(\\alpha+\\beta) + A\\), and therefore \\(A = \\lambda_0 - \\beta/(\\alpha+\\beta)\\). The solution is therefore as given. (c) What, therefore, are \\(\\lim_{n\\to\\infty} \\mathbb P(X_n = 0)\\) and \\(\\lim_{n\\to\\infty} \\mathbb P(X_n = 1)\\)? Note that \\(-1 &lt; 1 - (\\alpha + \\beta) &lt; 1\\), so \\((1-(\\alpha+\\beta))^n \\to 0\\). Therefore we have \\[\\begin{align*} \\lim_{n\\to\\infty} \\mathbb P(X_n = 0) &amp;= \\lim_{n\\to\\infty} \\mu_n \\\\ &amp;= \\lim_{n\\to\\infty} \\left( \\frac{\\beta}{\\alpha+\\beta} + \\left(\\lambda_0 - \\frac{\\beta}{\\alpha+\\beta}\\right)\\big(1-(\\alpha+\\beta)\\big)^n \\right) \\\\ &amp;= \\frac{\\beta}{\\alpha+\\beta} . \\end{align*}\\] Since \\(\\mathbb P(X_n = 1) = 1- \\mathbb P(X_n = 0)\\), we have \\[ \\mathbb P(X_n = 1) \\to 1 - \\frac{\\beta}{\\alpha+\\beta} = \\frac{\\alpha}{\\alpha+\\beta} . \\] (d) Explain what happens if the Markov chain is started in the distribution \\[ \\lambda_0 = \\frac{\\beta}{\\alpha+\\beta} , \\qquad \\lambda_1 = \\frac{\\alpha}{\\alpha+\\beta} . \\] Substituting in the value of \\(\\lambda_0\\) into the equation for \\(\\mu_n\\), the second term cancel, and we have that \\(\\mathbb P(X_n = 0) = \\mu_n = \\beta/(\\alpha+\\beta)\\) for all times \\(n\\), and therefor \\(\\mathbb P(X_n = 1) = \\alpha/(\\alpha+\\beta)\\) too. This means that the Markov chain remains in the same “stationary distribution” forever. 4. Let \\((X_n)\\) be a Markov chain. Show that, for any \\(m \\geq 1\\), we have \\[ \\mathbb P(X_{n+m} = x_{n+m} \\mid X_n = x_n, X_{n-1} = x_{n-1}, \\dots, X_0 = x_0) = \\mathbb P(X_{n+m} = x_{n+m} \\mid X_n = x_n) . \\] Note that we have a sequence of statements here, for \\(m = 1, 2, \\dots\\). Note also that the case \\(m = 1\\) is the standard Markov property. When we have a sequence of statements and we can easily prove the first one, this is a good sign that a proof by induction is the way to go. Before starting, for reasons of space, we adopt notation where we suppress the capital \\(X\\)s, so we want to show that \\[ \\mathbb P(x_{n+m} \\mid x_n, x_{n-1}, \\dots, x_0 ) = \\mathbb P(x_{n+m} \\mid x_n) . \\] We work by induction on \\(m\\). The base case \\(m = 1\\) is the standard Markov property. Assume the inductive hypothesis: that result holds for \\(m\\). We now need to prove the inductive step: that the result holds for \\(m+1\\). For \\(m+1\\) we have, by conditioning on the first step \\(x_{n+1}\\), \\[\\begin{multline*} \\mathbb P(x_{n+m+1} \\mid x_n, x_{n-1}, \\dots, x_0 ) \\\\ = \\sum_{x_{n+1}} \\mathbb P(x_{n+1} \\mid x_n, x_{n-1}, \\dots, x_0 )\\,\\mathbb P(x_{n+m+1} \\mid x_{n+1}, x_n, x_{n-1}, \\dots, x_0 ) \\end{multline*}\\] By the standard Markov property the first term simplifies to \\(\\mathbb P(x_{n+1} \\mid x_n)\\), and by the result for \\(m\\) the second term simplifies to \\(\\mathbb P(x_{n+m+1} \\mid x_{n+1})\\). So we have \\[ \\mathbb P(x_{n+m+1} \\mid x_n, x_{n-1}, \\dots, x_0 ) = \\sum_{x_{n+1}} \\mathbb P(x_{n+1} \\mid x_n) \\mathbb P(x_{n+m+1} \\mid x_{n+1}) . \\] But the right-hand side here is \\(\\mathbb P(x_{n+m+1} \\mid x_n)\\) written using conditioning on the first step and using the result for \\(m\\). By induction, we are done. 5. A car insurance company operates a no-claims discount system for existing policy holders. The possible discounts on premiums are \\(\\{0\\%,25\\%,40\\%,50\\%\\}\\). Following a claim-free year, a policyholder’s discount level increases by one level (or remains at 50% discount). If the policyholder makes one or more claims in a year, the discount level decreases by one level (or remains at 0% discount). The insurer believes that the probability of of making at least one claim in a year is \\(0.1\\) if the previous year was claim-free and \\(0.25\\) if the previous year was not claim-free. (a) Explain why we cannot use \\(\\{0\\%,25\\%,40\\%,50\\%\\}\\) as the state space of a Markov chain to model discount levels for policyholders. The Markov property does not hold for the time-homogeneous process described since the probability of moving to a given state at the next time step is not simply dependent on the current state if \\(\\mathcal S=\\{0\\%,25\\%,40\\%,50\\%\\}\\). For example, \\[ \\mathbb P(X_{n+1}=25\\% \\mid X_n= 40\\% )=\\begin{cases} 0.25 &amp; \\text{if $X_{n-1}=50\\%$}\\\\ 0.1 &amp; \\text{if $X_{n-1}=25\\%$.} \\end{cases} \\] (b) By considering additional states, show that a Markov chain can be used to model the discount level. The problem is that the process has a memory of the previous year. If we currently have a discount of 0%, we know a claim was made in the year before, so no changes are required. Similarly, at 50% discount, we know that no claim was made in the previous year. The other two states, 25% and 40%, have different behaviour depending on whether or not there was a claim in the previous year. So we will split each of these into two states: 25+ will denote a 25% discount with no claim in the previous year, while 25- will denote a 25% discount with a claim in the previous year. We define the state 40+ and 40- similarly. Then we have a Markov chain, since the current state and the number of claims in the previous year completely defines the distribution on future behaviour. (c) Draw the transition diagram and write down the transition matrix. The transition diagram is as shown below. Figure 6.5: Transition diagram for the car insurance Markov chain The transition matrix is given by, \\[ \\mathsf P = \\begin{matrix} &amp; \\begin{matrix} 0 &amp; 25+ &amp; 25- &amp; 40+ &amp; 40- &amp; 50 \\end{matrix} \\\\ \\begin{matrix} 0 \\\\ 25+ \\\\ 25- \\\\ 40+ \\\\ 40- \\\\ 50 \\end{matrix} &amp; \\begin{pmatrix} 0.25 &amp; 0.75 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\\\ 0.1 &amp; 0 &amp; 0 &amp; 0.9 &amp; 0 &amp; 0 \\\\ 0.25 &amp; 0 &amp; 0 &amp; 0.75 &amp; 0 &amp; 0 \\\\ 0 &amp; 0 &amp; 0.1 &amp; 0 &amp; 0 &amp; 0.9 \\\\ 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0.75 \\\\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0.1 &amp; 0.9 \\end{pmatrix} \\end{matrix} \\] 6. The credit rating of a company can be modelled as a Markov chain. Assume the rating is assessed once per year at the end of the year and possible ratings are A (good), B (fair) and D (in default). The transition matrix is \\[\\mathsf P=\\begin{pmatrix} 0.92&amp;0.05&amp;0.03\\\\ 0.05&amp;0.85&amp;0.1\\\\ 0&amp;0&amp;1 \\end{pmatrix} . \\] (a) Calculate the two-step transition probabilities, and hence find the expected number of defaults in the next two years from \\(100\\) companies all rated A at the start of the period. The matrix of two-step transition probabilities is given by the matrix square \\[\\mathsf P(2) = \\mathsf P^2= \\begin{pmatrix} 0.8489&amp;0.0885&amp;0.0626\\\\ 0.0885&amp;0.7250&amp;0.1865\\\\ 0&amp;0&amp;1 \\end{pmatrix}. \\] The number of defaults in two years from \\(100\\) A-rated companies is \\(100 \\times p_{\\mathrm{AD}}(2) = 100 \\times 0.0626 = 6.26\\). (b) What is the probability that a company rated A will at some point default without ever having been rated B in the meantime? Let \\(\\delta\\) be the desired probability that an A-rated company will default without having been rated B. We condition on the first step: with probability \\(0.92\\) we remain in state A, and by the Markov property the probability of the given event remains at \\(\\delta\\); with probability \\(0.05\\) we move to state B, and the event fails to occur; and with probability \\(0.03\\) we move to state D and the event occurs immediately. Therefore, we have \\[ \\delta = 0.92\\delta + 0.05\\times 0 + 0.03 \\times 1 = 0.92\\delta + 0.03 , \\] which has solution \\(\\delta = 0.03/(1-0.92) = 0.375\\). A corporate bond portfolio manager follows an investment strategy which means that bonds which fall from A-rated to B-rated are sold and replaced with an A-rated bond. The manager believes this will improve the returns on the portfolio because it will reduce the number of defaults experienced. (c) Calculate the expected number of defaults in the manager’s portfolio over the next two years given there are initially 100 A-rated bonds. Given that B-rated bonds are replaced by A-rated bonds, we have a new Markov chain with state space \\(\\{\\mathrm{A},\\mathrm{D}\\}\\) and transition matrix \\[ \\mathsf P = \\begin{pmatrix} 0.92+0.05 &amp; 0.03 \\\\ 0 &amp; 1 \\end{pmatrix} = \\begin{pmatrix} 0.97 &amp; 0.03 \\\\ 0 &amp; 1 \\end{pmatrix} . \\] The two-step transition probability is \\[ \\mathsf P(2) = \\mathsf P^2 = \\begin{pmatrix} 0.97 &amp; 0.03 \\\\ 0 &amp; 1 \\end{pmatrix} \\begin{pmatrix} 0.97 &amp; 0.03 \\\\ 0 &amp; 1 \\end{pmatrix} = \\begin{pmatrix} 0.9409 &amp; 0.0591 \\\\ 0 &amp; 1 \\end{pmatrix} . \\] Thus the number of defaults from \\(100\\) A-rated bonds in two years is \\(100\\times p_{\\mathrm{AD}}(2) = 100\\times 0.0591 = 5.91\\). The manager was right: this is slightly less than the \\(6.26\\) from part (a). "],["S07-classes.html", "Section 7 Class structure 7.1 Communicating classes 7.2 Periodicity", " Section 7 Class structure Communicating classes and irreducibility Period of a state (and class) 7.1 Communicating classes If we have a large complicated Markov chain, it can be useful to split the state space up into smaller pieces that can be studied separately. The idea is that states \\(i\\) and \\(j\\) should definitely be in the same piece (or \"class) if we can get from \\(i\\) to \\(j\\) and then back to \\(i\\) again after some number of steps. Definition 7.1 Consider a Markov chain on a state space \\(\\mathcal S\\) with transition matrix \\(\\mathsf P\\). We say that state \\(j\\in\\mathcal{S}\\) is accessible from state \\(i\\in\\mathcal{S}\\) and write \\(i \\to j\\) if, for some \\(n\\), \\(p_{ij}(n)&gt;0\\). If \\(i \\to j\\) and \\(j \\to i\\), we say that \\(i\\) communicates with \\(j\\) and write \\(i \\leftrightarrow j\\). Here, the condition \\(p_{ij}(n)&gt;0\\) means that, starting from \\(i\\), there’s a positive chance that we’ll get to \\(j\\) at some point in the future – hence the term “accessible”. Theorem 7.1 Consider a Markov chain on a state space \\(\\mathcal S\\) with transition matrix \\(\\mathsf P\\). Then the “communicates with” relation \\(\\leftrightarrow\\) is an equivalence relation; that is, it has the following properties: reflexive: \\(i \\leftrightarrow i\\) for all \\(i\\); symmetric: if \\(i \\leftrightarrow j\\) then \\(j \\leftrightarrow i\\); transitive: if \\(i \\leftrightarrow j\\) and \\(j \\leftrightarrow k\\) then \\(i \\leftrightarrow k\\). Proof. Reflexivity: Clearly \\(p_{ii}(0) = 1 &gt; 0\\), because in “zero steps” we stay where we are. So \\(i \\leftrightarrow i\\) for all \\(i\\). Symmetry: The definition of \\(i \\leftrightarrow j\\) is symmetric under swapping \\(i\\) and \\(j\\). Transitivity. If we can get from \\(i\\) to \\(j\\) and we can get from \\(j\\) to \\(k\\), then we can get from \\(i\\) to \\(k\\) by going via \\(j\\). We just need to write that out formally. Since \\(i \\to j\\), we have \\(p_{ij}(n) &gt; 0\\) for some \\(n\\), and since \\(j \\to k\\), we also have \\(p_{jk}(m) &gt; 0\\) for some \\(m\\). Then, by the Chapman–Kolmogorov equations, we have \\[ p_{ik}(n+m) = \\sum_{l \\in \\mathcal S} p_{il}(n) p_{lk}(m) \\geq p_{ij}(n) p_{jk}(m) &gt; 0 , \\] from just picking out the \\(l=j\\) term in the sum. So \\(i \\to k\\) too. The same argument with \\(k\\) and \\(i\\) swapped gives \\(k \\to i\\) also, so \\(i \\leftrightarrow k\\). A fact you may remember about equivalence relations is that an equivalence relation, like \\(\\leftrightarrow\\), partitions the space \\(\\mathcal S\\) into equivalence classes. This means that each state \\(i\\) is in exactly one equivalence class, and that class is the set of states \\(j\\) such that \\(i \\leftrightarrow j\\). In this context, we call these communicating classes. Example 7.1 In the simple random walk, provided \\(p\\) is not 0 or 1, every state communicates with every other state, because from \\(i\\) when can get to \\(j &gt; i\\) by going up \\(j - i\\) times, and we can get to \\(j &lt; i\\) by going down \\(i - j\\) times. Therefore the whole state space \\(\\mathcal S = \\mathbb Z\\) is one communicating class. Example 7.2 Consider the gambler’s ruin Markov chain on \\(\\{0,1,\\dots,m\\}\\). There are three communicating classes. The ruin states \\(\\{0\\}\\) and \\(\\{m\\}\\) each don’t communicate with any other states, so each are a class by themselves. The remaining states \\(\\{1,2,\\dots,m-1\\}\\) are all in the same class, like the simple random walk. Example 7.3 Consider the following simple model for an epidemic. We have three states: healthy (H), sick (S), and dead (D). This transition matrix is \\[ \\mathsf P = \\begin{pmatrix} p_{\\mathrm{HH}} &amp; p_{\\mathrm{HS}} &amp; 0 \\\\ p_{\\mathrm{SH}} &amp; p_{\\mathrm{SS}} &amp; p_{\\mathrm{SD}} \\\\ 0 &amp; 0 &amp; 1 \\end{pmatrix} , \\] and the transition diagram is: Figure 7.1: Transition diagram for the healthy–sick–dead chain. Clearly H and S communicate with each other (you can become infected or recover), while D only communicates with itself (the dead do not recover). Hence, the state space \\(\\mathcal S = \\{\\mathrm{H},\\mathrm{S},\\mathrm{D}\\}\\) partitions into two communicating classes: \\(\\{\\mathrm{H},\\mathrm{S}\\}\\) and \\(\\{\\mathrm{D}\\}\\). A few more definitions that will be important later. Definition 7.2 If the entire state space \\(\\mathcal S\\) is one communicating class, we say that the Markov chain is irreducible. We say that a communicating class is closed if no state outside the class is accessible from any state within the class. That is, class \\(C \\subset \\mathcal S\\) is closed if whenever there exist \\(i \\in C\\) and \\(j \\in \\mathcal S\\) with \\(i \\to j\\), then \\(j \\in C\\) also. If a class is not closed, we say it is open. If a state \\(i\\) is in a communicating class \\(\\{i\\}\\) by itself and that class is closed, then we say state \\(i\\) is absorbing. In non-maths language: An irreducible Markov chain can’t be broken down into smaller pieces. Once you enter a closed class, you can’t leave that class. Once you reach an absorbing state, you can’t leave that state. How do these work for our earlier examples? Example 7.4 Going back to the previous examples: In the simple random walk, the whole state space is one communicating class which must therefore be closed. The Markov chain has only one class, so is irreducible. In the gambler’s ruin, classes \\(\\{0\\}\\) and \\(\\{m\\}\\) are closed, because the Markov chain stays there forever, and because these closed classes consist of only one state each, \\(0\\) and \\(m\\) are absorbing states. The class \\(\\{1, 2, \\dots, m-1\\}\\) is open, as we can escape the class by going to \\(0\\) or \\(m\\). The gambler’s ruin chain has multiple classes, so is not irreducible. In the “healthy–sick–dead” chain, the class \\(\\{D\\}\\) is closed, so D is an absorbing state, while the class \\(\\{H, S\\}\\) is open, as one can leave it by dying. The Markov chain is not irreducible. 7.2 Periodicity When we discussed the simple random walk, we noted that it alternates between even-numbered and odd-numbered states. This “periodic” behaviour is important to understand if we want to know which state we will be in at some point in the future. The idea is this: List the number of steps for all possible paths starting and ending in the state. Then the period is the greatest common divisor (or “highest common factor”) of the integers in this list. Definition 7.3 Consider a Markov chain with transition matrix \\(\\mathsf P\\). We say that a state \\(i\\in\\mathcal{S}\\) has period \\(d_i\\), where \\[ d_i=\\text{gcd}\\big\\{n\\in\\{1,2,\\dots,\\} : p_{ii}(n) &gt; 0\\big\\} , \\] where gcd denotes the greatest common divisor. If \\(d_i&gt;1\\), then the state \\(i\\) is called periodic; if \\(d_i = 1\\), then \\(i\\) is called aperiodic. Example 7.5 Consider the simple random walk with \\(p \\neq 0,1\\). We have \\(p_{ii}(n) = 0\\) for odd \\(n\\), since we swap from odd to even each step. But \\(p_{ii}(2) = 2pq &gt; 0\\). Therefore, all states are periodic with period \\(\\text{gcd}\\{2,4,6,\\dots\\} = 2\\). Example 7.6 For the gambler’s ruin, states \\(0\\) and \\(m\\) are aperiodic (have period \\(1\\)), since they are absorbing states. The remaining states states \\(1,2,\\dots,m-1\\) are periodic with period \\(2\\), because we swap between odd and even states, as in the simple random walk. Example 7.7 Consider the Markov chain with transition diagram as shown: Figure 7.2: Transition diagram for an aperiodic irreducible Markov chain. Importantly, we can’t return from the triangle side back to the circle side. We thus see there are two communicating classes: \\(\\{1,2,3,4\\}\\), which is open, and \\(\\{5,6,7\\}\\), which is closed. The Markov chain is not irreducible, and there are no absorbing states. The circle side swaps between odd and even states (until exiting from \\(4\\) to \\(5\\)), so states \\(1\\),\\(2\\), \\(3\\) and \\(4\\) all have period \\(2\\). The triangle side cycles around with certainty, meaning that states \\(5\\), \\(6\\), and \\(7\\) all have period \\(3\\). You may have noticed in these examples that, within a communicating class, every state has the same period. In fact, it’s always the case that states in the same class have the same period. Theorem 7.2 All states in a communicating class have the same period. Formally: Consider a Markov chain on a state space \\(\\mathcal S\\) with transition matrix \\(\\mathsf P\\). If \\(i,j\\in\\mathcal S\\) are such that \\(i \\leftrightarrow j\\), then \\(d_i = d_j\\). In particular, in an irreducible Markov chain, all states have the same period \\(d\\). We say that an irreducible Markov chain is periodic if \\(d&gt;1\\) and aperiodic if \\(d=1\\). Proof. Let \\(i,j\\) be such that \\(i \\leftrightarrow j\\). We want to show that \\(d_i = d_j\\). First we’ll show that \\(d_i \\leq d_j\\), and then we’ll show that \\(d_j \\leq d_i\\), and thus conclude that they’re equal. Since \\(i\\leftrightarrow j\\), there exist \\(n,m\\) such that \\(p_{ij}(n)&gt;0\\) and \\(p_{ji}(m)&gt;0\\). Then, by the Chapman–Kolmogorov equations, \\[ p_{ii}(n+m) = \\sum_{k \\in \\mathcal S} p_{ik}(n) p_{ki}(m) \\geq p_{ij}(n) p_{ji}(m) &gt; 0 . \\] So \\(d_i\\) divides \\(n+m\\). Let \\(r\\) be such that \\(p_{jj}(r)&gt;0\\). Then, by the same Chapman–Kolmogorov argument, \\[ p_{ii}(n+m+r)\\geq p_{ij}(n) p_{jj}(r) p_{ji}(m) &gt; 0, \\] because we can get from \\(i\\) to \\(i\\) by going \\(i \\to j \\to j \\to i\\). Hence \\(d_i\\) divides \\(n+m+r\\). But if \\(d_i\\) divides both \\(n+m\\) and \\(n+m+r\\), it must be that \\(d_i\\) divides \\(r\\) also. So whenever \\(p_{jj}(r)&gt;0\\), we have that \\(d_i\\) divides \\(r\\). Since \\(d_i\\) is a common divisor of all the \\(r\\)s with \\(p_{jj}(r)&gt;0\\), it can’t be any bigger that the greatest common divisor of all those \\(r\\)s. But that greatest common divisor is by definition \\(d_j\\), the period of \\(j\\). So \\(d_i \\leq d_j\\). Repeating the same argument but with \\(i\\) and \\(j\\) swapped over, we get \\(d_j\\leq d_i\\) too, and we’re done. In the next section, we look at two problems to do with “hitting times”: What is the probability we reach a certain state, and how long on average does it take us to get there? "],["S08-hitting-times.html", "Section 8 Hitting times 8.1 Hitting probabilities and expected hitting times 8.2 Return times 8.3 Hitting and return times for the simple random walk", " Section 8 Hitting times Definitions: Hitting probability, expected hitting time, return probability, expected return time Finding these by conditioning on the first step Return probability and expected return time for the simple random walk 8.1 Hitting probabilities and expected hitting times In Section 3 and Section 4, we used conditioning on the first step to find the ruin probability and expected duration for the gambler’s ruin problem. Here, we develop those ideas for general Markov chains. Definition 8.1 Let \\((X_n)\\) be a Markov chain on state space \\(\\mathcal S\\). Let \\(H_{A}\\) be a random variable representing the hitting time to hit the set \\(A \\subset \\mathcal S\\), given by \\[ H_{A} = \\min \\big\\{n \\in \\{0,1,2,\\dots\\} : X_n \\in A \\big\\} . \\] The most common case we’ll be interested in will be when \\(A = \\{j\\}\\) is just a single state, so \\[ H_{j} = \\min \\big\\{n \\in \\{0,1,2,\\dots\\} : X_n = j \\big\\} . \\] (We use the convention that \\(H_A = \\infty\\) if \\(X_n \\not\\in A\\) for all \\(n\\).) The hitting probability \\(h_{iA}\\) of the set \\(A\\) starting from state \\(i\\) is \\[ h_{iA} = \\mathbb P(X_n \\in A \\text{ for some $n \\geq 0$} \\mid X_0 = i) = \\mathbb P(H_A &lt; \\infty \\mid X_0 = i) . \\] Again, the most common case of interest is \\(h_{ij}\\) the hitting probability of state \\(j\\) starting from state \\(i\\). The expected hitting time \\(\\eta_{iA}\\) of the set \\(A\\) starting from state \\(i\\) is \\[ \\eta_{iA} = \\mathbb E(H_A \\mid X_0 = i) . \\] Clearly \\(\\eta_{iA}\\) can only be finite if \\(h_{iA} = 1\\). The short summary of this is: The hitting probability \\(h_{ij}\\) is the probability we hit state \\(j\\) starting from state \\(i\\). The expected hitting time \\(\\eta_{ij}\\) is the expected time until we hit state \\(j\\) starting from state \\(i\\). The good news us that we already know how to find hitting probabilities and expected hitting times, because we already did it for the gambler’s ruin problem! The way we did it then is that we first found equations for hitting probabilities or expected hitting times by conditioning on the first step, and then we solved those equations. We do the same here for other Markov chains. Let’s see an example of how to find a hitting probability. Example 8.1 Consider a Markov chain with transition matrix \\[ \\begin{pmatrix} \\frac15 &amp; \\frac15 &amp; \\frac15 &amp; \\frac25 \\\\ 0 &amp; 1 &amp; 0 &amp; 0 \\\\ 0 &amp; \\frac12 &amp; 0 &amp; \\frac12 \\\\ 0 &amp; 0 &amp; 0 &amp; 1 \\end{pmatrix} . \\] Calculate the probability that the chain is absorbed at state \\(2\\) when started from state \\(1\\). This is asking for the hitting probability \\(h_{12}\\). We use – as ever – a conditioning on the first step argument. Specifically, we have \\[\\begin{align} h_{12} &amp;= p_{11} h_{12} + p_{12} h_{22} + p_{13} h_{32} + p_{14} h_{42} \\\\ &amp;= \\tfrac 15 h_{12} + \\tfrac 15 h_{22} + \\tfrac 15 h_{32} + \\tfrac 25 h_{42} \\tag{8.1} \\end{align}\\] This is because, starting from 1, there’s a \\(p_{11} = \\frac15\\) probability of staying at 1; then by the Markov property it’s like we’re starting again from 1, so the hitting probability is still \\(h_{12}\\). Similarly, there’s a \\(p_{12} = \\frac15\\) probability of moving 2; then by the Markov property it’s like we’re starting again from 2, so the hitting probability is still \\(h_{22}\\). And so on. Since (8.1) includes not just \\(h_{12}\\) but also \\(h_{22}\\), \\(h_{32}\\) and \\(h_{42}\\), we need to find equations for those too. Clearly we have \\(h_{22} = 1\\), as we are “already there”. Also, \\(h_{42} = 0\\), since 4 is an absorbing state. For \\(h_{32}\\), another “condition on the first step” argument gives \\[ h_{32} = p_{32}h_{22} + p_{34}h_{42} = \\tfrac12 h_{22} + \\tfrac12 h_{42} = \\tfrac12 ,\\] where we substituted in \\(h_{22} = 1\\) and \\(h_{42} = 0\\). Substituting \\(h_{22} = 1\\), \\(h_{32} = \\frac12\\) and \\(h_{42} = 0\\) all into (8.1), we get \\[ h_{12} = \\tfrac15 h_{12} + \\tfrac15 + \\tfrac15 \\tfrac12 = \\tfrac15 h_{12} + \\tfrac{3}{10}. \\] Hence \\(\\frac45 h_{12} = \\frac{3}{10}\\), so the answer we were after is \\(h_{12} = \\frac38\\). So the technique to find hitting probability \\(h_{ij}\\) from \\(i\\) to \\(j\\) is: Set up equations for all the hitting probabilities \\(h_{kj}\\) to \\(j\\) by conditioning on the first step. Solve the resulting simultaneous equations. It is recommended to derive equations for hitting probabilities from first principles by conditioning on the first step, as we did in the example above. However, we can state what the general formula is: by the same conditioning method, we get \\[ h_{iA} = \\begin{cases} \\displaystyle\\sum_{j \\in \\mathcal S} p_{ij} h_{jA} &amp; \\text{if $i \\not\\in A$} \\\\ 1 &amp; \\text{if $i \\in A$.} \\end{cases} \\] It can be shown that, if these equations have multiple solutions, then the hitting probabilities are in fact the smallest non-negative solutions. Now an example for expected hitting times. Example 8.2 Consider the simple no-claims discount chain from Lecture 6, which had transition matrix \\[ \\mathsf P =\\begin{pmatrix} \\tfrac14 &amp;\\tfrac34 &amp; 0\\\\ \\tfrac14 &amp;0 &amp; \\tfrac34\\\\ 0 &amp;\\tfrac14 &amp; \\tfrac34\\\\ \\end{pmatrix} .\\] Given we start in state 1 (no discount), find the expected amount of time until we reach state 3 (50% discount). This question asks us to find \\(\\eta_{13}\\). We follow the general method, and start by writing down equations for all the \\(\\eta_{i3}\\)s. Clearly we have \\(\\eta_{33} = 0\\). For the others, we condition on the first step to get \\[\\begin{align*} \\eta_{13} = 1 + \\tfrac14 \\eta_{13} + \\tfrac34 \\eta_{23} \\qquad &amp;\\Rightarrow \\qquad \\phantom{-}\\tfrac34 \\eta_{13} - \\tfrac34\\eta_{23} = 1 ,\\\\ \\eta_{23} = 1 + \\tfrac14 \\eta_{13} + \\tfrac34 \\eta_{33} \\qquad &amp;\\Rightarrow \\qquad - \\tfrac14\\eta_{13} + \\phantom{\\tfrac34}\\eta_{23} = 1 . \\end{align*}\\] This is because the first step takes time \\(1\\), then we condition on what happens next – just like we did for the gambler’s ruin. The first equation plus three-quarters times the second gives \\[ \\big(\\tfrac34 - \\tfrac34\\tfrac14\\big) \\eta_{13} = \\tfrac{9}{16}\\eta_{13} = 1 + \\tfrac34 = \\tfrac 74 = \\tfrac{28}{16} ,\\] which has solution \\(\\eta_{13} = \\tfrac{28}{9} = 3.11\\). Similarly, if we need to, we can give a general formula \\[ \\eta_{iA} = \\begin{cases} 1 + \\displaystyle\\sum_{j \\in \\mathcal S} p_{ij} \\eta_{jA} &amp; \\text{if $i \\not\\in A$} \\\\ 0 &amp; \\text{if $i \\in A$.} \\end{cases} \\] Again, if we have multiple solutions, the expected hitting times are the smallest non-negative solutions. 8.2 Return times Under the definitions above, the hitting probability and expected hitting time to a state from itself are always \\(h_{ii} = 1\\) and \\(\\eta_{ii} = 0\\), as we’re “already there”. In this case, it can be interesting to look instead at the random variable representing the return time, \\[ M_i = \\min \\big\\{n \\in \\{1,2,\\dots\\} : X_n = i \\big\\} . \\] Note that this only considers times \\(n = 1, 2, \\dots\\) not including \\(n = 0\\), so is the next time we come back, after \\(n = 0\\). We then have the return probability and expected return time \\[\\begin{gather*} m_{i} = \\mathbb P(X_n = i \\text{ for some $n \\geq 1$} \\mid X_0 = i) = \\mathbb P(M_i &lt; \\infty \\mid X_0 = i) , \\\\ \\mu_{i} = \\mathbb E(M_i \\mid X_0 = i) . \\end{gather*}\\] Just as before, we can find these by conditioning on the first step. The general equations are \\[ m_i = \\sum_{j \\in \\mathcal S} p_{ij}h_{ji} , \\qquad \\mu_i = 1 + \\sum_{j \\in \\mathcal S} p_{ij}\\eta_{ji}, \\] where, if necessary, we take the minimal non-negative solution again. 8.3 Hitting and return times for the simple random walk We now turn to hitting and return times for the simple random walk, which goes up with probability \\(p\\) and down with probability \\(q = 1-p\\). This material is mandatory and is examinable, but is a bit technical; students who are struggling or have fallen behind might make a tactical decision just to read the two summary theorems below and come back to the details at a later date. Let’s start with hitting probabilities. Without loss of generality, we look at \\(h_{i0}\\), the probability the random walk hits 0 starting from \\(i\\). We will assume that \\(i &gt; 0\\). For \\(i &lt; 0\\), we can get the desired result by looking at the random walk “in the mirror” – that is, by swapping the role of \\(p\\) and \\(q\\), and treating the positive value \\(-i\\). For an initial condition, it’s clear we have \\(h_{00} = 1\\). For general \\(i &gt; 0\\), we condition on the first step, to get \\[ h_{i0} = ph_{i+1\\, 0} + qh_{i-1\\, 0} . \\] We recognise this equation from the gambler’s ruin problem, and recall that we have to treat the cases \\(p \\neq \\frac12\\) and \\(p = \\frac12\\) separately. When \\(p \\neq \\frac12\\), the general solution is \\(h_{i0} = A + B\\rho^i\\), where \\(\\rho = q/p \\neq 1\\), as before. The initial condition \\(h_{00} = 1\\) gives \\(A = 1-B\\), so we have a family of solutions \\[ h_{i0} = (1 - B) + B\\rho^i = 1 + B(\\rho^i - 1) . \\] In the gambler’s ruin problem we had another boundary condition to find \\(B\\). Here we have no other conditions, but we can use the minimality condition that the hitting probabilities are the smallest non-negative solution to the equation. This minimal non-negative solution will depend on whether \\(\\rho &gt; 1\\) or \\(\\rho &lt; 1\\). When \\(\\rho &gt; 1\\), so \\(p &lt; \\frac12\\), the term \\(\\rho^i\\) tends to infinity. Thus the minimal non-negative solution will have to take \\(B = 0\\), because taking \\(B &lt; 0\\) would eventually give a negative solution, while \\(B = 0\\) gives the smallest of the non-negative solutions. Hence the solution is \\(h_{i0} = 1 + 0(\\rho^i-1) = 1\\), meaning we hit 0 with certainty. This makes sense, because for \\(p &lt; \\frac12\\) the random walk “drifts” to the left, and eventually gets back to 0. When \\(\\rho &lt; 1\\), so \\(p &gt; \\frac12\\), we have that \\(\\rho^i - 1\\) is negative and tends to \\(-1\\). So to get a small solution we want \\(B\\) large and positive, but keeping the solution non-negative limits us to \\(B \\leq 1\\), so the minimality condition is achieved at \\(B = 1\\). The solution is \\(h_{i0} = 1 + 1(\\rho^i - 1) = \\rho^i\\). This is strictly less than 1 as expected, because for \\(p &gt; 1/2\\), the random walk drifts to the right, so might drift further and further away from 0 and not come back. For \\(p = \\frac12\\), so \\(\\rho = 1\\), we recall the general solution \\(h_{i0} = A + Bi\\). The condition \\(h_{00} = 1\\) gives \\(A = 1\\), so \\(h_{i0} = 1 + Bi\\). Because \\(i\\) is positive, to get the answer to be small we want \\(B\\) to be small, but non-negativity limits us to \\(B\\) positive, so the minimal non-negative solution takes \\(B = 0\\). This gives \\(h_{i0} = 1 + 0i = 1\\), so we will always get back to 0. In conclusion, we have the following. (Recall that we get the result for \\(i &lt; 0\\) by swapping the role of \\(p\\) and \\(q\\), and treating the positive value \\(-i\\).) Theorem 8.1 Consider a random walk with up probability \\(p \\neq 0, 1\\). Then the hitting probabilities to 0 are givin by, for \\(i &gt; 0\\), \\[ h_{i0} = \\begin{cases} \\left(\\displaystyle\\frac{q}{p}\\right)^i &lt; 1 &amp; \\text{if $p &gt; \\frac12$} \\\\ \\ 1 &amp; \\text{if $p \\leq \\frac12$,} \\end{cases} \\] and for \\(i &lt; 0\\) by \\[ h_{i0} = \\begin{cases} \\left(\\displaystyle\\frac{p}{q}\\right)^{-i} &lt; 1 &amp; \\text{if $p &lt; \\frac12$} \\\\ \\ 1 &amp; \\text{if $p \\geq \\frac12$.} \\end{cases} \\] Now we look at return times. What is the return probability to 0 (or, by symmetry, to any state \\(i \\in \\mathbb Z\\))? By conditioning on the first step, \\(m_0 = ph_{1\\,0} + qh_{-1\\,0}\\), and we’ve calculated those hitting times above. We have \\[ m_0 = \\begin{cases} p\\times 1 \\hspace{0.4em}+ q\\times 1 \\hspace{0.4em}= 1 &amp; \\text{if $p = \\frac12$} \\\\ p \\times \\displaystyle\\frac qp + q\\times 1 \\hspace{0.4em}= 2q &lt; 1 &amp; \\text{if $p &gt; \\frac12$} \\\\ p\\times 1 \\hspace{0.4em} + q \\times \\displaystyle\\frac pq = 2p &lt; 1 &amp; \\text{if $p &lt; \\frac12$.}\\end{cases} \\] So for the simple symmetric random walk (\\(p = \\frac12\\)) we have \\(m_i = 1\\) and are certain to return to the initial state again and again, while for \\(p \\neq \\frac12\\), we have \\(m_i &lt; 1\\) and we might never return. What about the expected return times \\(\\mu_{0}\\)? For \\(p \\neq \\frac12\\), we have \\(\\mu_{0} = \\infty\\), since \\(m_0 &lt; 1\\) and we might never come back. For \\(p = \\frac12\\), though, \\(m_0 = 1\\), so we have work to do. To get the expected return time for \\(p = \\frac12\\), we’ll need the expected hitting times for for \\(p = \\frac12\\) too. Conditioning on the first step gives the equation \\[ \\eta_{i0} = 1 + \\tfrac12\\eta_{i+1\\,0} + \\tfrac12\\eta_{i-1\\,0} , \\] with initial condition \\(\\eta_{00} = 0\\). We again recognise from the gambler’s ruin problem the general solution \\(\\eta_{i0} = A + Bi -i^2\\). The initial condition gives \\(A = 0\\), so \\(\\eta_{i0} = Bi - i^2 = i(B-i)\\). Then non-negativity demands \\(B = \\infty\\), as any other value would get drowned out by the large negative value \\(-i^2\\), making the whole expression negative for big enough \\(i\\). Thus we have \\(\\eta_{i0} = \\infty\\). Then we see easily that the return time is \\[ \\mu_0 = 1 + \\tfrac12 \\eta_{1\\,0} + \\tfrac12 \\eta_{-1\\,0} = 1 + \\tfrac12 \\infty + \\tfrac12 \\infty = \\infty. \\] So for \\(p = \\frac12\\), while the random walk always return, it may take a very long time to do so. In conclusion, this is what we found out: Theorem 8.2 Consider the simple random walk with \\(p \\neq 0,1\\). Then for all states \\(i\\) we have the following: For \\(p \\neq \\frac12\\), the return probability \\(m_i\\) is strictly less than 1, so the expected return time \\(\\mu_i\\) is infinite. For the simple symmetric random walk with \\(p = \\frac12\\), the return probability \\(m_i\\) is equal to 1, but the expected return time \\(\\mu_i\\) is still infinite. In the next section, we look at how the return probabilities and expected return times characterise which states continue to be visited by a Markov chain in the long run. "],["P04.html", "Problem sheet 4", " Problem sheet 4 .fold-btn { float: right; margin: -12px 0 0 0; } You should attempt all these questions and write up your solutions in advance of your workshop in week 5 (Monday 22 or Tuesday 23 February) where the answers will be discussed. 1. Consider the Markov chain with state space \\(\\mathcal S = \\{1,2,3,4\\}\\) and transition matrix \\[ \\mathsf P = \\begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; 0 \\\\ 1-\\alpha &amp; 0 &amp; \\alpha &amp; 0 \\\\ 0 &amp; \\beta &amp; 0 &amp; 1-\\beta \\\\ 0 &amp; 0 &amp; 0 &amp; 1 \\end{pmatrix} \\] where \\(0 &lt; \\alpha, \\beta &lt; 1\\). (a) Draw a transition diagram for this Markov chain. Solution. Figure 8.1: Transition diagram for Question 1. (b) What are the communicating classes for this Markov chain? Is the chain irreducible? Which classes are closed? Which states are absorbing? Solution. Clearly \\(\\{1\\}\\) and \\(\\{4\\}\\) are closed communicating classes, so \\(1\\) and \\(4\\) are absorbing states. The other class, \\(\\{2,3\\}\\) is not closed. Because there are multiple classes, the chain is not irreducible. (c) Find the hitting probability \\(h_{21}\\) that, starting from state 2, the chain hits state 1. Solution. It’s clear that \\(h_{11} = 1\\) and \\(h_{41} = 0\\). Then, by conditioning on the first step, we have \\[\\begin{gather*} h_{21} = \\alpha h_{31} + (1-\\alpha) h_{11} = \\alpha h_{31} + 1 - \\alpha \\\\ h_{31} = \\beta h_{21} + (1-\\beta) h_{41} = \\beta h_{21} . \\end{gather*}\\] Substituting the second equation into the first, we get \\(h_{21} = \\alpha\\beta h_{21} + 1 - \\alpha\\), so \\[ h_{21} = \\frac{1-\\alpha}{1-\\alpha\\beta} . \\] (d) What is the expected time, starting from state 2, to reach an absorbing state? Solution. Let’s write \\(A = \\{1,4\\}\\) for the absorbing states, and \\(\\eta_{iA}\\) for the time to reach an absorbing state starting from state \\(i\\). Clearly \\(\\eta_{1A} = \\eta_{4A} = 0\\). By conditioning on the first step, we have \\[\\begin{gather*} \\eta_{2A} = 1 + \\alpha \\eta_{3A} + (1-\\alpha) \\eta_{1A} = 1 + \\alpha \\eta_{3A} \\\\ \\eta_{3A} = 1 + \\beta \\eta_{2A} + (1-\\beta) \\eta_{4A} = 1+\\beta \\eta_{2A} . \\end{gather*}\\] Substituting the second equation into the first gives \\(\\eta_{2A}= 1 + \\alpha + \\alpha\\beta \\eta_{2A}\\), so \\[ \\eta_{2A} = \\frac{1+\\alpha}{1-\\alpha\\beta} . \\] 2. Consider the Markov chain with state space \\(\\mathcal S = \\{1,2,3,4,5\\}\\) and transition matrix \\[ \\mathsf P = \\begin{pmatrix} 0 &amp; \\frac13 &amp; \\frac23 &amp; 0 &amp; 0 \\\\ 0 &amp; 0 &amp; 0 &amp; \\frac14 &amp; \\frac34 \\\\ 0 &amp; 0 &amp; 0 &amp; \\frac14 &amp; \\frac34 \\\\ 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\\\ 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\end{pmatrix} . \\] (a) Draw a transition diagram for this Markov chain. Solution. Figure 8.2: Transition diagram for Question 2. (b) Show that the chain is irreducible. Solution. We have paths \\(1 \\to 2 \\to 4 \\to 1\\) and \\(1 \\to 3 \\to 5 \\to 1\\), so every state communicates with state 1, and by transitivity every state communicates with every other state. (c) What are the periods of the states? Solution. Any path from \\(1\\) to \\(1\\) goes \\(1 \\to \\{2 \\text{ or }3\\} \\to \\{4 \\text{ or }5\\} \\to 1\\). So \\(p_{11}^{(n)} &gt; 0\\) if and only if \\(n\\) is a multiple of \\(3\\). So state \\(1\\) has period \\(d_1 = 3\\). Because the chain is irreducible, all other states have period \\(3\\) too. (d) Find the expected hitting times \\(\\eta_{i1}\\) from each state \\(i\\) to 1, and the expected return time \\(\\mu_i\\) to 1. Solution. We could do this through a traditional conditioning on the first step argument. But in fact, the cyclic structure \\(1 \\to \\{2 \\text{ or }3\\} \\to \\{4 \\text{ or }5\\} \\to 1\\) makes it immediately clear that \\(\\eta_11 = 0\\), \\(\\eta_{41}=\\eta_{51} = 1\\), \\(\\eta_{21} = \\eta_{31} = 2\\), and \\(\\mu_1 = 3\\). 3. (a) Show that every Markov chain on a finite state space \\(\\mathcal S\\) has at least one closed communicating class. Solution. For communicating classes \\(C,D\\), let’s write \\(C \\to D\\) if there is an \\(i \\in C\\) and \\(j \\in D\\) with \\(i \\to j\\). Note that we can’t have both \\(C \\to D\\) and \\(D \\to C\\) if \\(C\\) and \\(D\\) are distinct classes. This is because there would be \\(i_1, j_2 \\in C\\) and \\(j_1, i_2 \\in D\\) such that \\(i_1 \\to j_1 \\to i_2 \\to j_2 \\to i_1\\), so they would be the same class. Let’s also note that there are a finite number of classes \\(m\\). Pick a class \\(C_1\\). If \\(C_1\\) is closed, we are done; otherwise \\(C_1 \\to C_2\\) for some other class \\(C_2\\). If \\(C_2\\) is closed, we are done; otherwise \\(C_2 \\to C_3\\) for some class \\(C_3\\) different to \\(C_1\\) and \\(C_2\\). (It can’t be \\(C_1\\) by the argument above.) We repeat: if \\(C_k\\) is closed, we are done; otherwise there’s a new class \\(C_{k+1}\\) with \\(C_k \\to C_{k+1}\\). We eventually find a closed class: we either terminate before step \\(m\\) at a closed class, or otherwise \\(C_m\\) must be closed, as none of the previous \\(m-1\\) classes can be accessible from it, by our earlier argument. (b) Give an example of a Markov chain that has no closed communicating classes. Solution. By part (a), the state space must be infinite. Here’s one example: take \\(\\mathcal S = \\mathbb Z\\), and \\(X_{n+1} = X_n + 1\\) with probability 1, so the Markov chain just marches up and up. There are no states \\(i\\) and \\(j\\) such that \\(i \\leftrightarrow j\\) (except for states communicating with themselves) so each state is a separate class. But clearly there is no absorbing state. 4. Prove or give a counterexample: The period of a state \\(i\\) is the smallest \\(d &gt; 0\\) such that \\(p_{ii}(d) &gt; 0\\). Solution. The statement is not true. Here’s one counterexample: Figure 8.3: Transition diagram for a counterexample for Question 4. We see that \\(p_{00} = p_{00}(1) = 0\\), but \\(p_{00}(2) = \\frac12 &gt; 0\\) (going via A) and \\(p_{00}(3) = \\frac12 &gt; 0\\) (going via B and C). Hence \\(d_0 \\leq \\text{gcd}\\{2,3\\} = 1\\), so \\(d_0 = 1\\), contradicting the statement in the question. 5. Consider the simple random walk with \\(p &lt; \\frac12\\), and let \\(i &gt; 0\\). Show that \\(\\eta_{i0} = i/(q-p)\\). Solution. By conditioning on the first step, we have \\[ \\eta_{i0} = 1 + p\\eta_{i+1\\,0} + q\\eta_{i-1\\,0} . \\] Either by solving this linear difference equation directly or by remembering the solution from when we did expected duration of the gambler’s ruin, the general solution is \\[ \\eta_{i0} = A + B\\rho^i + \\frac{i}{q-p} , \\] where \\(\\rho = q/p &gt; 0\\). We have one initial condition \\(\\eta_{00} = 0\\) (since we’re “already there”). This gives \\(0 = A + B\\), so we have \\[ \\eta_{i0} = -B + B\\rho^i + \\frac{i}{q-p} = B(\\rho^i - 1) + \\frac{i}{q-p} . \\] We now have to use the principle of the minimum non-negative solution. Since \\(\\rho &gt; 1\\), we also have \\(\\rho^i - 1 &gt; 0\\). Hence \\(B\\) must be non-negative, to ensure the whole solution is non-negative, but we want \\(B\\) to be as small as possible, to ensure minimality. Hence we must have \\(B = 0\\), finally giving the solution \\[ \\eta_{i0} = \\frac{i}{q-p} \\] as desired. 6. Consider the Markov chain with the following transition matrix and transition diagram: Figure 8.4: Transition diagram for Question 6. \\[ \\mathsf P = \\begin{pmatrix} 0 &amp; \\frac14 &amp; \\frac12 &amp; \\frac14 \\\\ \\frac12 &amp; 0&amp; 0&amp; \\frac12 \\\\ \\frac12 &amp; 0&amp; 0&amp; \\frac12 \\\\ 0 &amp; \\frac13 &amp; \\frac23 &amp; 0 \\end{pmatrix} \\] The Markov chain starts from state 1. (a) What is the probability that we hit state 2 before we hit state 3? Solution. Write \\(k_i\\) for the probability we hit state 2 before state 3 starting from \\(i\\). Then clearly \\(k_2 = 1\\) (since we’ve hit 2 first) and \\(k_3 = 0\\) (since we’ve hit 3 first). Further, by conditioning on the first step, \\(k_4 = \\frac13 k_2 + \\frac23 k_3 = \\frac13\\), and \\[ k_1 = \\tfrac14 k_2 + \\tfrac12k_3 + \\tfrac14 k_4 = \\tfrac14 + \\tfrac14 k_4 = \\tfrac14 + \\tfrac14\\tfrac13 = \\tfrac13 . \\] The desired solution is \\(k_1 = \\frac13\\). (b) What is the expected time until we hit a state in the set \\(\\{2,3\\}\\)? Solution. Let \\(A = \\{2,3\\}\\), and \\(\\eta_{iA}\\) be the expected time until hitting the first of states \\(2\\) and \\(3\\) starting from \\(i\\). Clearly \\(\\eta_{2A} = \\eta_{3A} = 0\\). By conditioning on the first step, \\(\\eta_{4A} = 1+ \\frac13 \\eta_{2A} + \\frac23 \\eta_{3A} = 1\\), and \\[ \\eta_{1A} = 1 + \\tfrac14 \\eta_{2A} + \\tfrac12\\eta_{3A} + \\tfrac14 \\eta_{4A} = 1 + \\tfrac14 = \\tfrac54 . \\] The desired solution is \\(\\eta_{1A} = \\tfrac54\\). "],["S09-recurrence-transience.html", "Section 9 Recurrence and transience 9.1 Recurrent and transient states 9.2 Recurrent and transient classes 9.3 Positive and null recurrence 9.4 Strong Markov property 9.5 A useful lemma", " Section 9 Recurrence and transience Definition of properties of recurrence and transience Recurrence and transience as class properties Positive and null recurrence 9.1 Recurrent and transient states When thinking about the long-run behaviour of Markov chains, it’s useful to classify two different types of states: “recurrent” states and “transient” states. Recurrent states Transient states If we ever visit \\(i\\), then we keep returning to \\(i\\) again and again We might visit \\(i\\) a few times, but eventually we leave \\(i\\) and never come back Starting from \\(i\\), the expected number of visits to \\(i\\) is infinite Starting from \\(i\\), the expected number of visits to \\(i\\) is finite Starting from \\(i\\), the number of visits to \\(i\\) is certain to be infinite Starting from \\(i\\), the number of visits to \\(i\\) is certain to be finite The return probability \\(m_i\\) equals 1 The return probability \\(m_i\\) is strictly less than 1 We’ll take the last one of these, about the return probability, as the definition, then prove that the others follow. Definition 9.1 Let \\((X_n)\\) be a Markov chain on a state space \\(\\mathcal S\\). For \\(i \\in \\mathcal S\\), let \\(m_i\\) be the return probability \\[ m_i = \\mathbb P(X_n = i \\text{ for some $n \\geq 1$} \\mid X_0 = i) . \\] If \\(m_i = 1\\), we say that state \\(i\\) is recurrent; if \\(m_i &lt; 1\\), we say that state \\(i\\) is transient. Before stating this theorem, let us note that, from the point we’re at state \\(i\\), the expected number of visits to \\(i\\) is \\[ \\mathbb E(\\#\\text{ visits to $i$} \\mid X_0 = i) = \\sum_{n=0}^\\infty \\mathbb P(X_n = i \\mid X_0 = i) = \\sum_{n=1}^\\infty p_{ii}(n) . \\] Theorem 9.1 Consider a Markov chain with transition matrix \\(\\mathsf P\\). If the state \\(i\\) is recurrent, then \\(\\sum_{n=1}^\\infty p_{ii}(n) = \\infty\\), and we return to state \\(i\\) infinitely many times with probability 1. If the state \\(i\\) is transient, then \\(\\sum_{n=1}^\\infty p_{ii}(n) &lt; \\infty\\), and we return to state \\(i\\) infinitely many times with probability 0. We’ll come to the proof in a moment, but first some examples. Example 9.1 Consider the simple random walk. In the last section we saw that for the simple symmetric random walk with \\(p = \\frac12\\) we have \\(m_i = 1\\), so the simple symmetric random walk is recurrent, but for \\(p \\neq \\frac12\\) we have \\(m_i &lt; 1\\), so all the other simple random walks are transient. Example 9.2 We saw this chain previously as Example 7.7: Figure 9.1: Transition diagram from Subsection 7.2. For states 5, 6 and 7, it’s clear that the return probability is 1, since the Markov chain cycles around the triangle, so these states are recurrent. States 1, 2, 3 and 4 are transient. In a moment we’ll see a very quick way to show this, but in the meantime we can prove it directly by getting our hands dirty. From state 4, we might go straight to state 5, in which case we can’t come back, so \\(m_4 \\leq 1 - p_{45} = \\frac23\\), and state 4 is transient. Similarly, if we move from 1 to 4 to 5, we definitely won’t come back to 1, so \\(m_1 \\leq 1 - p_{14}p_{45} = \\frac56\\), and state 1 is transient. By the similar arguments, \\(m_3 \\leq 1 - p_{34}p_{45} = \\frac56\\), and \\(m_2 \\leq 1 - p_{21}p_{14}p_{45} = \\frac{11}{12}\\), so these states are both transient too. Notice that all states in the communicating class \\(\\{1,2,3,4\\}\\) are transient, while all states in the communicating class \\(\\{5,6,7\\}\\) are recurrent. We shall return to this point shortly. But first, we’ve put off the proof for too long. Proof (Proof of Theorem 9.1). Suppose state \\(i\\) is recurrent. So starting from \\(i\\), the probability we return is \\(m_i = 1\\). After that return, it’s as if we restart the chain from \\(i\\), because of the Markov property – so the probability we return to \\(i\\) is again still \\(m_i = 1\\). Repeating this, we keep on returning, definitely visit infinitely often (with probability 1). In particular, since the number of visits to \\(i\\) starting from \\(i\\) is always infinite, its expectation is infinite too, and this expectation is \\(\\sum_{n=1}^\\infty p_{ii}(n) = \\infty\\). Suppose, on the other hand, that state \\(i\\) is transient. So starting from \\(i\\) the probability we return is \\(m_i &lt; 1\\). Then the probability we return to \\(i\\) exactly \\(r\\) times before never coming back is \\[ \\mathbb P \\big((\\text{number of returns to $i$}) = r\\big) = m_i^r(1-m_i) , \\] since we must return on the first \\(r\\) occasions, but then fail to return on the next occasion.. This is a geometric distribution \\(\\text{Geom}(1-m_i)\\) (the version with support \\(\\{0,1,2,\\dots\\}\\)). Since the expectation of this type of \\(\\text{Geom}(p)\\) random variable is \\((1 - p)/p\\), the expected number of returns is \\[ \\mathbb E(\\text{number of returns to $i$}) = \\sum_{n=1}^\\infty p_{ii}(n) = \\frac{1 - (1 - m_i)}{1 - m_i} = \\frac{m_i}{1 - m_i} . \\] This is finite, since \\(m_i &lt;1\\). Since the expected number of returns is finite, the probability we return infinitely many times must be 0. 9.2 Recurrent and transient classes We could find whether each state is transient or recurrent by calculating (or bounding) all the return probabilities \\(m_i\\), using the methods in the previous section. But the following two theorems will give some highly convenient short-cuts. Theorem 9.2 Within a communicating class, either every state is transient or every state is recurrent. Formally: Let \\(i, j \\in \\mathcal S\\) be such that \\(i \\leftrightarrow j\\). If \\(i\\) is recurrent, then \\(j\\) is recurrent also; while if \\(i\\) is transient, then \\(j\\) transient also. For this reason, we can refer to a communicating class as a “recurrent class” or a “transient class”. If a Markov chain is irreducible, we can refer to it as a “recurrent Markov chain” or a “transient Markov chain”. Proof. First part. Suppose \\(i \\leftrightarrow j\\) and \\(i\\) is recurrent. Then, for some \\(n\\), \\(m\\) we have \\(p_{ij}(n)\\), \\(p_{ji}(m) &gt; 0\\). Then, by the Chapman–Kolmogorov equations, \\[\\begin{align*} \\sum_{r=1}^\\infty p_{jj}(n+m+r) &amp;\\geq \\sum_{r=1}^\\infty p_{ji}(m)p_{ii}(r) p_{ij}(n) \\\\ &amp;= p_{ji}^{(m)} \\left(\\sum_{r=1}^\\infty p_{ii}(r) \\right) p_{ij}(n) . \\end{align*}\\] If \\(i\\) is recurrent, then \\(\\sum_r p_{ii}(r) = \\infty\\). Then from the above equation, we also have \\(\\sum_r p_{jj}(n+m+r) = \\infty\\), meaning \\(\\sum_s p_{jj}(s) = \\infty\\), and \\(j\\) is recurrent. Second part. Suppose \\(i\\) is transient. Then \\(j\\) cannot be recurrent, because if it were, the previous argument with \\(i\\) and \\(j\\) swapped over would force \\(i\\) to in fact be recurrent also. So \\(j\\) must be transient. Theorem 9.3 Every non-closed communicating class is transient. Every finite closed communicating class is recurrent. This theorem completely classifies the transience and recurrence of classes, with rare exception of infinite closed classes, which can require further examination. Proof. First part. Suppose \\(i\\) is in a non-closed communicating class, so for some \\(j\\) we have \\(i \\to j\\), meaning \\(p_{ij}(n) &gt; 0\\) for some \\(n\\), but \\(j \\not\\to i\\), meaning that once we reach \\(j\\) we cannot return to \\(i\\). We need to show that \\(i\\) is transient. Consider the probability we return to \\(i\\) after time \\(n\\). We condition on whether \\(X_n = j\\) or not. This gives \\[\\begin{align*} \\mathbb P(\\text{return} &amp; \\text{ to } i \\text{ after time $n$} \\mid X_0 = i) \\\\ &amp;= p_{ij}(n)\\,\\mathbb P(\\text{return to $i$ after time $n$} \\mid X_n = j, X_0 = i) \\\\ &amp;\\qquad {}+ \\big(1 - p_{ij}(n)\\big)\\,\\mathbb P(\\text{return to $i$ after time $n$} \\mid X_n \\neq j, X_0 = i) \\\\ &amp;\\leq \\mathbb P(\\text{return to $i$ after time $n$} \\mid X_n = j, X_0 = i) + \\big(1 - p_{ij}(n)\\big) \\\\ &amp;= 0 + \\big(1 - p_{ij}(n)\\big) \\\\ &amp;&lt; 1, \\end{align*}\\] since we can’t get from \\(j\\) to \\(i\\), and since \\(p_{ij}(n) &gt; 0\\). If \\(i\\) were recurrent we would certainly return infinitely often, and in particular certainly return after time \\(n\\). So \\(i\\) must be transient instead. Second part. Suppose the class \\(C\\) is finite and closed. Then there must be an \\(i \\in C\\) such that, once we visit \\(i\\), the probability that we return to \\(i\\) infinitely many times is strictly positive; this is because we are going to stay in the finitely many states of \\(C\\) for infinitely many time steps. Then that state \\(i\\) is not transient, so it must be recurrent, which means that the whole class is recurrent. Going back to the earlier example, we see that the class \\(\\{5,6,7\\}\\) is closed and finite, and therefore recurrent, while class \\(\\{1,2,3,4\\}\\) is not closed and therefore transient. This is much less effort than the previous method! 9.3 Positive and null recurrence It will be useful later to further divide recurrent classes, where the return probability \\(m_i = 1\\), by whether the expected return time \\(\\mu_i\\) is finite or not. (Note that transient states always have \\(\\mu_i = \\infty\\).) Definition 9.2 Let \\((X_n)\\) be a Markov chain on a state space \\(\\mathcal S\\). Let \\(i \\in \\mathcal S\\) be a recurrent state, so \\(m_i = 1\\), and let \\(\\mu_i\\) be the expected return time. If \\(\\mu_i &lt; \\infty\\), we say that state \\(i\\) is positive recurrent; if \\(\\mu_i = \\infty\\), we say that state \\(i\\) is null recurrent. The following facts can be proven in a similar way to the previous results: In a recurrent class, either all states are positive recurrent or all states are null recurrent. All finite closed classes are positive recurrent. The first result means we can refer to a “positive recurrent class” or a “null recurrent class”, and an irreducible Markov chain can be a “positive recurrent Markov chain” or a “null recurrent Markov chain”. Putting everything so far together, we have the following classification: non-closed classes are transient; finite closed classes are positive recurrent; infinite closed classes can be positive recurrent, null recurrent, or transient. We know that the simple symmetric random walk is recurrent. We also saw in the last section that \\(\\mu_i = \\infty\\), so it is null recurrent. We can also consider the simple symmetric random walk in \\(d\\)-dimensions, on \\(\\mathbb Z^d\\). At each step we pick one of the coordinates and increase or decrease it by one; each of the \\(2d\\) possibilities having probability \\(1/(2d)\\). We have seen that for \\(d=1\\) this is null recurrent. A famous result by the Hungarian mathematician George Pólya from 1921 states the simple symmetric random walk is null recurrent for \\(d = 1\\) and \\(d = 2\\), but is transient for \\(d \\geq 3\\). (Perhaps this is why cars often crash into each other, but aeroplanes very rarely do?) 9.4 Strong Markov property This subsection is optional and nonexaminable. There was a cheat somewhere earlier in this section – did you notice it? The Markov property says that, if at some fixed time \\(n\\) we have \\(X_n = i\\), then the Markov chain from that point on is just like starting all over again from the state \\(i\\). When we applied this in the proof of Theorem 9.1, we were using as \\(n\\) the first return to state \\(i\\). But that’s not a fixed time – it’s a random time! Did we cheat? Actually we’re fine. The reason is that the first return to \\(i\\) isn’t just any old random time, it’s a “stopping time”, and the Markov property also applies to stopping times too. Roughly speaking, a stopping time is a random time which has the property that “you know when you get there”. Definition 9.3 Let \\((X_n)\\) be a stochastic process in discrete time, and let \\(T\\) be a random time. Then \\(T\\) is a stopping time if for all \\(n\\), whether or not the event \\(\\{T = n\\}\\) occurs is completely determined by the random variables \\(X_0, X_1, \\dots, X_n\\). So, for example: “The first visit to state \\(i\\)” is stopping time, because as soon as we reach \\(i\\), we know the value of \\(T\\). “Three time-steps after the second visit to \\(j\\)” is a stopping time, because after our second visit we count on three more steps and have \\(T\\). “The time-step before the first visit to \\(i\\)” is not a stopping time, because we still need to go one step further on to know whether we had just been at time \\(T\\) or not. “The final visit to \\(j\\)” is not a stopping time, because at the time of the visit we don’t yet know whether we’ll come back again or not. There are lots of places in probability theory and finance when something that is true about a fixed time is also true about a random stopping time. When we use the Markov property with a stopping time, we call it the “strong Markov property”. Theorem 9.4 (Strong Markov property) Let \\((X_n)\\) be a Markov chain on a state space \\(\\mathcal S\\), and let \\(T\\) be a stopping time that is finite with probability 1. Then all states \\(x_0, \\dots,x_{T-1}, i, j \\in \\mathcal S\\) we have \\[ \\mathbb P(X_{T+1}=j \\mid X_T=i, X_{T-1} = x_{T-1} \\dots, X_0 = x_0) = p_{ij} . \\] Proof. We have \\[\\begin{align*} &amp;\\mathbb P(X_{T+1}={}x_j \\mid X_T=i, X_{T-1} = x_{T-1} \\dots, X_0 = x_0) \\\\ &amp;\\qquad{}= \\sum_{n=0}^\\infty \\mathbb P(T = n) \\mathbb P(X_{n+1}=j \\mid X_n=i, X_{n-1} = x_{n-1} \\dots, X_0 = x_0, T = n) \\\\ &amp;\\qquad{}= \\sum_{n=0}^\\infty \\mathbb P(T = n) \\mathbb P(X_{n+1}=j \\mid X_n=i, X_{n-1} = x_{n-1} \\dots, X_0 = x_0) \\\\ &amp;\\qquad{}= \\sum_{n=0}^\\infty \\mathbb P(T = n) \\mathbb P(X_{n+1}=j \\mid X_n=i) \\\\ &amp;\\qquad{}= \\sum_{n=0}^\\infty \\mathbb P(T = n) p_{ij}\\\\ &amp;\\qquad{}= p_{ij} \\sum_{n=0}^\\infty \\mathbb P(T = n) \\\\ &amp;\\qquad{}= p_{ij} , \\end{align*}\\] as desired. The second line was by conditioning on the value of \\(T\\); in the third line we deleted the superfluous conditioning \\(T = n\\), because \\(T\\) is a stopping time, so the event \\(T = n\\) is entirely decided by \\(X_n, X_{n-1}, \\dots, X_0\\); the fourth line used the (usual non-strong) Markov property; the fifth line is just the definition of \\(p_{ij}\\); the sixth line took \\(p_{ij}\\) out of the sum; and the seventh line is because \\(T\\) is finite with probability 1, so \\(\\mathbb P(T = n)\\) sums to 1. 9.5 A useful lemma This subsection is optional and nonexaminable. The following lemma will be used in some later optional and nonexaminable proofs. Lemma 9.1 Let \\((X_n)\\) be an irreducible and recurrent Markov chain. Then for any initial distribution and any state \\(j\\), we will certainly hit \\(j\\), so the hitting time \\(H_j\\) is finite with probability 1. Proof. It suffices to prove the lemma when the initial distribution is “start at \\(i\\)”. (We can repeat for all \\(i\\), then build any initial distribution from a weighted sum of “start at \\(i\\)”s.) Since the chain is irreducible, we have \\(j \\to i\\), so pick \\(m\\) with \\(p_{ji}(m) &gt; 0\\). Since the chain is recurrent, we know the return probability from \\(j\\) to \\(j\\) is 1, and we return infinitely many times with probability 1. We just need to glue these two facts together. We have \\[\\begin{align*} 1 &amp;= \\mathbb P(X_n = j \\text{ for infinitely many $n$} \\mid X_0 = j) \\\\ &amp;= \\mathbb P(X_n = j \\text{ for some $n &gt; m$} \\mid X_0 = j) \\\\ &amp;= \\sum_k \\mathbb P(X_m = k \\mid X_0 = j) \\,\\mathbb P(X_n = j \\text{ for some $n &gt; m$} \\mid X_m = k, X_0 = j) \\\\ &amp;= \\sum_k p_{jk}(m) \\,\\mathbb P(H_j &lt; \\infty \\mid X_0 = k) , \\end{align*}\\] where the last line used the Markov property to treat the chain as starting over again when it reaches some state \\(k\\) at time \\(m\\). Note that \\(\\sum_k p_{jk}(m) = 1\\), since that’s the sum of the probabilities of going anywhere in \\(m\\) steps. This means we must have \\(\\mathbb P(H_j &lt; \\infty \\mid X_0 = k)\\) whenever \\(p_{jk}(m) &gt; 0\\), to ensure the final line does indeed sum to 1. But we stated earlier that \\(p_{ji}(m) &gt; 0\\), so we indeed have \\(\\mathbb P(H_j &lt; \\infty \\mid X_0 = i)\\), as required. In the next section, we look at how positive recurrent Markov chains can settle into a “stationary distribution” and experience long-term stability. "],["S10-stationary-distributions.html", "Section 10 Stationary distributions 10.1 Definition of stationary distribution 10.2 Finding a stationary distribution 10.3 Existence and uniqueness 10.4 Proof of existence and uniqueness", " Section 10 Stationary distributions Stationary distributions and how to find them Conditions for existence and uniqueness of the stationary distribution 10.1 Definition of stationary distribution Consider the two-state “broken printer” Markov chain from Lecture 5. Figure 10.1: Transition diagram for the two-state broken printer chain. Suppose we start the chain from the initial distribution \\[ \\lambda_0 = \\mathbb P(X_0 = 0) = \\frac{\\beta}{\\alpha+\\beta} \\qquad \\lambda_1 = \\mathbb P(X_0 = 1) = \\frac{\\alpha}{\\alpha+\\beta} . \\] (You may recognise this from Question 3 on Problem Sheet 3 and the associated video.) What’s the distribution after step 1? By conditioning on the initial state, we have \\[\\begin{align*} \\mathbb P(X_1 = 0) &amp;= \\lambda_0 p_{00} + \\lambda_1 p_{10} = \\frac{\\beta}{\\alpha+\\beta}(1-\\alpha) + \\frac{\\alpha}{\\alpha+\\beta}\\beta = \\frac{\\beta}{\\alpha+\\beta} ,\\\\ \\mathbb P(X_1 = 1) &amp;= \\lambda_0 p_{01} + \\lambda_1 p_{11} = \\frac{\\beta}{\\alpha+\\beta}\\alpha + \\frac{\\alpha}{\\alpha+\\beta}(1-\\beta) = \\frac{\\alpha}{\\alpha+\\beta} . \\end{align*}\\] So we’re still in the same distribution we started in. By repeating the same calculation, we’re still going to be in this distribution after step 2, and step 3, and forever. More generally, if we start from a state given by a distribution \\(\\boldsymbol \\pi = (\\pi_i)\\), then after step 1 the probability we’re in state \\(j\\) is \\(\\sum_i \\pi_i p_{ij}\\). So if \\(\\pi_j = \\sum_i \\pi_i p_{ij}\\), we stay in this distribution forever. We call such a distribution a stationary distribution. We again recodnise this formula as a matrix–vector multiplication, so this is \\(\\boldsymbol \\pi = \\boldsymbol \\pi\\mathsf P\\), where \\(\\boldsymbol \\pi\\) is a row vector. Definition 10.1 Let \\((X_n)\\) be a Markov chain on a state space \\(\\mathcal S\\) with transition matrix \\(\\mathsf P\\). Let \\(\\boldsymbol \\pi = (\\pi_i)\\) be a distribution on \\(\\mathcal S\\), in that \\(\\pi_i \\geq 0\\) for all \\(i \\in \\mathcal S\\) and \\(\\sum_{i \\in \\mathcal S} \\pi_i = 1\\). We call \\(\\boldsymbol \\pi\\) a stationary distribution if \\[ \\pi_j = \\sum_{i\\in \\mathcal S} \\pi_i p_{ij} \\quad \\text{for all $j \\in \\mathcal S$,} \\] or, equivalently, if \\(\\boldsymbol \\pi = \\boldsymbol \\pi\\mathsf P\\). Note that we’re saying the distribution \\(\\mathbb P(X_n = i)\\) stays the same; the Markov chain \\((X_n)\\) itself will keep moving. One way to think is that if we started off a thousand Markov chains, choosing each starting position to be \\(i\\) with probability \\(\\pi_i\\), then (roughly) \\(1000 \\pi_j\\) of them would be in state \\(j\\) at any time in the future – but not necessarily the same ones each time. 10.2 Finding a stationary distribution Let’s try an example. Consider the no-claims discount Markov chain from Lecture 6 with state space \\(\\mathcal S=\\{1,2,3\\}\\) and transition matrix \\[ \\mathsf P =\\begin{pmatrix} \\tfrac14 &amp;\\tfrac34 &amp; 0\\\\ \\tfrac14 &amp;0 &amp; \\tfrac34\\\\ 0 &amp;\\tfrac14 &amp; \\tfrac34\\\\ \\end{pmatrix} .\\] We want to find a stationary distribution \\(\\boldsymbol \\pi\\), which must solve the equation \\(\\boldsymbol \\pi =\\boldsymbol \\pi\\mathsf P\\), which is \\[ \\begin{pmatrix} \\pi_1 &amp; \\pi_2 &amp; \\pi_3 \\end{pmatrix} = \\begin{pmatrix} \\pi_1 &amp; \\pi_2 &amp; \\pi_3 \\end{pmatrix} \\begin{pmatrix} \\tfrac14 &amp;\\tfrac34 &amp; 0\\\\ \\tfrac14 &amp;0 &amp; \\tfrac34\\\\ 0 &amp;\\tfrac14 &amp; \\tfrac34\\\\ \\end{pmatrix} .\\] Writing out the equations coordinate at a time, we have \\[\\begin{align*} \\pi_1 &amp;= \\tfrac14\\pi_1+\\tfrac14\\pi_2 , \\\\ \\pi_2 &amp;= \\tfrac34\\pi_1+\\tfrac14\\pi_3 , \\\\ \\pi_3 &amp;= \\tfrac34\\pi_2+\\tfrac34\\pi_3 . \\end{align*}\\] Since \\(\\boldsymbol\\pi\\) must be a distribution, we also have the “normalising condition” \\[ \\pi_1+\\pi_2+\\pi_3=1 . \\] The way to solve these equations is first to solve for all the variables \\(\\pi_i\\) in terms of a convenient \\(\\pi_{j}\\) (called the “working variable”) and then substitute all of these expressions into the normalising condition to find a value for \\(\\pi_{j}\\). Let’s choose \\(\\pi_2\\) as our working variable. It turns out that \\(\\boldsymbol\\pi = \\boldsymbol\\pi \\mathsf{P}\\) always gives one more equation than we actually need, so we can discard one of them for free. Let’s get rid of the second equation, and the solve the first and third equations in terms of our working variable \\(\\pi_2\\), to get \\[\\begin{equation} \\pi_1=\\tfrac13\\pi_2 \\qquad \\pi_3=3\\pi_2 . \\tag{10.1} \\end{equation}\\] Now let’s turn to the normalising condition. That gives \\[ \\pi_1+\\pi_2+\\pi_3 = \\tfrac13\\pi_2+\\pi_2+3\\pi_2 = \\tfrac{13}{3} \\pi_2 = 1 .\\] So the working variable is solved to be \\(\\pi_2 = \\frac{3}{13}\\). Substituting this back into (10.1), we have \\(\\pi_1=\\tfrac13\\pi_2 = \\frac{1}{13}\\) and \\(\\pi_3=3\\pi_2 = \\frac{9}{13}\\). So the full solution is \\[ \\boldsymbol \\pi = (\\pi_1, \\pi_2, \\pi_3) = \\left(\\tfrac{1}{13}, \\tfrac{3}{13}, \\tfrac{9}{13}\\right). \\] The method we used here can be summarised as follows: Write out \\(\\boldsymbol \\pi = \\boldsymbol \\pi\\mathsf P\\) coordinate by coordinate. Discard one of the equations. Select one of the \\(\\pi_i\\) as a working variable and treat it as a parameter. Solve the equations in terms of the working variable. Substitute the solution into the normalising condition to find the working variable, and hence the full solution. It can be good practice to use the equation discarded earlier to check that the calculated solution is indeed correct. One extra example for further practice and to show how you should present your solutions to such problems: Example 10.1 Consider a Markov chain on state space \\(\\mathcal S = \\{1,2,3\\}\\) with transition matrix \\[ \\mathsf P = \\begin{pmatrix} \\tfrac12 &amp; \\tfrac14&amp; \\frac14 \\\\ \\tfrac14&amp; \\frac12&amp; \\frac14 \\\\ 0 &amp; \\frac14 &amp; \\frac34 \\end{pmatrix} . \\] Find a stationary distribution for this Markov chain. Step 1. Writing out \\(\\boldsymbol \\pi = \\boldsymbol \\pi\\mathsf P\\) coordinate-wise, we have \\[\\begin{align*} \\pi_1 &amp;= \\tfrac12 \\pi_1 + \\tfrac14\\pi_2 \\\\ \\pi_2 &amp;= \\tfrac14\\pi_1 + \\tfrac12\\pi_2 + \\tfrac14\\pi_3 \\\\ \\pi_3 &amp;= \\tfrac14\\pi_1 + \\tfrac14\\pi_2 + \\tfrac34\\pi_3 . \\end{align*}\\] We choose to discard the third equation. Step 2. We choose \\(\\pi_1\\) as our working variable. From the first equation we get \\(\\pi_2 = 2\\pi_1\\). From the second equation we get \\(\\pi_3 = 2\\pi_2 - \\pi_1\\), and substituting the previous \\(\\pi_2 = 2\\pi_1\\) into this, we get \\(\\pi_3 = 3\\pi_1\\). Step 3. The normalising condition is \\[ \\pi_1 + \\pi_2 + \\pi_3 = \\pi_1 + 2\\pi_1 + 3\\pi_1 = 6\\pi_1 = 1 . \\] Therefore \\(\\pi_1 = \\frac16\\). Substituting this into our previous expressions, we get \\(\\pi_2 = 2\\pi_1 = \\frac13\\) and \\(\\pi_3 = 3\\pi_1 = \\frac12\\). Thus the solution is \\(\\boldsymbol\\pi = ( \\tfrac16, \\tfrac13, \\tfrac12 )\\). We can check our answer with the discarded third equation, just to make sure we didn’t make any mistakes. We get \\[ \\pi_3 = \\tfrac14\\pi_1 + \\tfrac14\\pi_2 + \\tfrac34\\pi_3 = \\tfrac14\\tfrac16 + \\tfrac14\\tfrac13+\\tfrac34\\tfrac12 = \\tfrac1{24} + \\tfrac2{24} + \\tfrac{9}{24} = \\tfrac{1}{2} , \\] which is as it should be. 10.3 Existence and uniqueness Given a Markov chain its natural to ask: Does a stationary distribution exist? If a stationary distribution does exists, is there only one, or are there be many stationary distributions? The answer is given by the following very important theorem. Theorem 10.1 Consider an irreducible Markov chain. If the Markov chain is positive recurrent, then a stationary distribution \\(\\boldsymbol \\pi\\) exists, is unique, and is given by \\(\\pi_i = 1/\\mu_{i}\\), where \\(\\mu_{i}\\) is the expected return time to state \\(i\\). If the Markov chain is null recurrent or transient, then no stationary distribution exists. We give an optional and nonexaminable proof to the first part below. In our no-claims discount example, the chain is irreducible and, like all finite state irreducible chains, it is positive recurrent. Thus the stationary distribution \\(\\boldsymbol\\pi = (\\tfrac{1}{13}, \\tfrac{3}{13}, \\tfrac{9}{13})\\) we found is the unique stationary distribution for that chain. Once we have the stationary distribution \\(\\boldsymbol\\pi\\), we get the expected return times \\(\\mu_i = 1/\\pi_i\\) for free: the expected return times are \\(\\mu_1 = 13\\), \\(\\mu_2 = \\frac{13}{3} = 4.33\\), and \\(\\mu_3 = \\frac{13}{9} = 1.44\\). Note the condition in Theorem 10.1 that the Markov chain is irreducible. What if the Markov chain is not irreducible, so has more than one communicating class? We can work out what must happen from the theorem: If none of the classes are positive recurrent, then no stationary distribution exists. If exactly one of the classes is positive recurrent (and therefore closed), then there exists a unique stationary distribution, supported only on that closed class. If more the one of the classes are positive recurrent, then many stationary distributions will exist. Example 10.2 Consider the simple random walk with \\(p \\neq 0,1\\). This Markov chain is irreducible, and is null recurrent for \\(p = \\frac12\\) and transient for \\(p \\neq \\frac12\\). Either way, the theorem tells us that no stationary distribution exists. Example 10.3 Consider the Markov chain with transition matrix \\[ \\mathsf P = \\begin{pmatrix} \\frac12 &amp; \\frac12 &amp; 0 &amp; 0 \\\\ \\frac12 &amp; \\frac12 &amp; 0 &amp; 0 \\\\ 0 &amp; 0 &amp; \\frac14 &amp; \\frac34\\\\ 0 &amp; 0 &amp; \\frac12 &amp; \\frac12\\end{pmatrix} . \\] This chain has two closed positive recurrent classes, \\(\\{1,2\\}\\) and \\(\\{3,4\\}\\). Solving \\(\\boldsymbol\\pi = \\boldsymbol\\pi\\mathsf P\\) gives \\[\\begin{align*} \\pi_1 = \\tfrac12 \\pi_1 + \\tfrac12\\pi_2 \\qquad &amp;\\Rightarrow \\qquad \\phantom{3}\\pi_1 = \\pi_2 \\\\ \\pi_2 = \\tfrac12 \\pi_1 + \\tfrac12\\pi_2 \\qquad &amp;\\Rightarrow \\qquad \\phantom{3}\\pi_1 = \\pi_2 \\\\ \\pi_3 = \\tfrac14 \\pi_3 + \\tfrac12\\pi_4 \\qquad &amp;\\Rightarrow \\qquad 3\\pi_3 = 2\\pi_4 \\\\ \\pi_4 = \\tfrac34 \\pi_3 + \\tfrac12\\pi_4 \\qquad &amp;\\Rightarrow \\qquad 3\\pi_3 = 2\\pi_4 , \\end{align*}\\] giving us the same two constraints twice each. We also have the normalising condition \\(\\pi_1 + \\pi_2+\\pi_3+\\pi_4 = 1\\). If we let \\(\\pi_1 + \\pi_2 = \\alpha\\) and \\(\\pi_3 + \\pi_4 = 1-\\alpha\\), we see that \\[ \\boldsymbol\\pi = \\left(\\tfrac12\\alpha\\quad \\tfrac12\\alpha\\quad \\tfrac25(1-\\alpha)\\quad \\tfrac35(1-\\alpha)\\right) \\] is a stationary distribution for any \\(0 \\leq \\alpha \\leq 1\\), so we have infinitely many stationary distributions. 10.4 Proof of existence and uniqueness This subsection is optional and nonexaminable. It’s very important to be able to find the stationary distribution(s) of a Markov chain – you can reasonably expect a question on this to turn up on the exam. You should also know the conditions for existence and uniqueness of the stationary distribution. Being able to prove existence and uniqueness is less important, although for completeness we will do so here. Theorem 10.1 had two points. The more important point was that irreducible, positive recurrent Markov chains have a stationary distribution, that it is unique, and that it is given by \\(\\pi_i = 1/\\mu_i\\). We give a proof of that below, doing the existence and uniqueness parts separately. The less important point was that null recurrent and transitive Markov chains do not have a stationary distribution, and this is more fiddly. You can find a proof (usually in multiple parts) in books such as Norris, Markov Chains, Section 1.7. Existence: Every positive recurrent Markov chain has a stationary distribution. Before we start, one last definition. Let us call a vector \\(\\boldsymbol\\nu\\) a stationary vector if \\(\\boldsymbol\\nu \\mathsf P = \\boldsymbol\\nu\\). This is exactly like a stationary distribution, except without the normalisation condition that it has to sum to 1. Proof. Suppose that \\((X_n)\\) is recurrent (either positive or null, for the moment). Our first task will be to find a stationary vector. Fix an initial state \\(k\\), and let \\(\\nu_i\\) be the expected number of visits to \\(i\\) before we return back to \\(k\\). That is, \\[\\begin{align*} \\nu_i &amp;= \\mathbb E (\\# \\text{ visits to $i$ before returning to $k$} \\mid X_0 = k) \\\\ &amp;= \\mathbb E \\sum_{n=1}^{M_k} \\mathbb P(X_n = i \\mid X_0 = k) \\\\ &amp;= \\sum_{n=1}^\\infty \\mathbb P(X_n = i \\text{ and } n \\leq M_k \\mid X_0 = k) , \\end{align*}\\] where \\(M_k\\) is the return time, as in Section 8. Let us note for later use that, under this definition, \\(\\nu_k = 1\\), because the only visit to \\(k\\) is the return to \\(k\\) itself. Since \\(\\boldsymbol\\nu\\) is counting the number of visits to different states in a certain (random) time, it seems plausible that \\(\\boldsymbol\\nu\\) suitably normalised could be a stationary distribution, meaning that \\(\\boldsymbol\\nu\\) itself could be a stationary vector. Let’s check. We want to show that \\(\\sum_i \\nu_i p_{ij} = \\nu_j\\). Let’s see what we have: \\[\\begin{align*} \\sum_{i \\in \\mathcal S} \\nu_i p_{ij} &amp;= \\sum_{i \\in \\mathcal S} \\sum_{n=1}^\\infty \\mathbb P(X_n = i \\text{ and } n \\leq M_k \\mid X_0 = k) \\, p_{ij} \\\\ &amp;= \\sum_{n=1}^\\infty \\sum_{i \\in \\mathcal S} \\mathbb P(X_n = i \\text{ and } X_{n+1} = j \\text{ and } n \\leq M_k \\mid X_0 = k) \\\\ &amp;= \\sum_{n=1}^\\infty \\mathbb P(X_{n+1} = j \\text{ and } n \\leq M_k \\mid X_0 = k) . \\end{align*}\\] (Exchanging the order of the sums is legitimate, because recurrence of the chain means that \\(M_k\\) is finite with probability 1.) We can now do a cheeky bit of monkeying around with the index \\(n\\), by swapping out the visit to \\(k\\) at time \\(M_k\\) with the visit to \\(k\\) at time \\(0\\). This means instead of counting the visits from \\(1\\) to \\(M_k\\), we can count the visits from \\(0\\) to \\(M_k - 1\\). Shuffling the index about, we get \\[\\begin{align*} \\sum_{i \\in \\mathcal S} \\nu_i p_{ij} &amp;= \\sum_{n=0}^\\infty \\mathbb P(X_{n+1} = j \\text{ and } n \\leq M_k-1 \\mid X_0 = k) \\\\ &amp;= \\sum_{n+1=1}^\\infty \\mathbb P(X_{n+1} = j \\text{ and } n+1 \\leq M_k \\mid X_0 = k) \\\\ &amp;= \\sum_{n=1}^\\infty \\mathbb P(X_{n} = j \\text{ and } n \\leq M_k \\mid X_0 = k) \\\\ &amp;= \\nu_j . \\end{align*}\\] So \\(\\boldsymbol\\nu\\) is indeed a stationary vector. We now want normalise \\(\\boldsymbol\\nu\\) into a stationary distribution by dividing through by \\(\\sum_i \\nu_i\\). We can do this if \\(\\sum_i \\nu_i\\) is finite. But \\(\\sum_i \\nu_i\\) is the expected total number of visits to all states before return to \\(k\\), which is precisely the expected return time \\(\\mu_k\\). Now we use the assumption that \\((X_n)\\) is positive recurrent. This means that \\(\\mu_k\\) is finite, so \\(\\boldsymbol\\pi = (1/\\mu_k) \\boldsymbol\\nu\\) is a stationary distribution. Uniqueness: For an irreducible, positive recurrent Markov chain, the stationary distribution is unique and is given by \\(\\pi_i = 1/\\mu_i\\). I read the following proof in Stirzaker, Elementary Probability, Section 9.5. Proof. Suppose the Markov chain is irreducible and positive recurrent, and suppose \\(\\boldsymbol\\pi\\) is a stationary distribution. We want to show that \\(\\pi_i = 1/\\mu_i\\) for all \\(i\\). The only equation we have for \\(\\mu_k\\) is this one from Section 8: \\[\\begin{equation} \\mu_k = 1 + \\sum_j p_{kj} \\eta_{jk} . \\tag{10.2} \\end{equation}\\] Since that involves the expected hitting times \\(\\eta_{ik}\\), let’s write down the equation for them too: \\[\\begin{equation} \\eta_{ik} = 1 + \\sum_j p_{ij} \\eta_{jk} \\qquad \\text{for all $i \\neq k$.} \\tag{10.3} \\end{equation}\\] In order to apply the fact that \\(\\boldsymbol\\pi\\) is a stationary distribution, we’d like to get these into an equation with \\(\\sum_i \\pi_i p_{ij}\\) in it. Here’s a way we can do that: Take (10.3), multiply it by \\(\\pi_i\\) and sum over all \\(i \\neq k\\), to get \\[\\begin{equation} \\sum_{i} \\pi_i \\eta_{ik} = \\sum_{i \\neq k} \\pi_i + \\sum_j \\sum_{i \\neq k} \\pi_i p_{ij} \\eta_{jk} . \\tag{10.4} \\end{equation}\\] (The sum on the left can be over all \\(i\\), since \\(\\eta_{kk} = 0\\).) Also, take (10.2) and multiply it by \\(\\pi_k\\) to get \\[\\begin{equation} \\pi_k \\mu_k = \\pi_k + \\sum_j \\pi_k p_{kj} \\eta_{jk} \\tag{10.5} \\end{equation}\\] Now add (10.4) and (10.5) together to get \\[ \\sum_{i} \\pi_i \\eta_{ik} + \\pi_k \\mu_k = \\sum_i \\pi_i + \\sum_j \\sum_i\\pi_i p_{ij} \\eta_{jk} . \\] We can now use \\(\\sum_i\\pi_i p_{ij} = \\pi_j\\), along with \\(\\sum_i \\pi_i = 1\\), to get \\[ \\sum_{i} \\pi_i \\eta_{ik} + \\pi_k \\mu_k = 1 + \\sum_j \\pi_j \\eta_{jk} . \\] But the first term on the left and the last term on the right are equal, and because the Markov chain is irreducible and positive recurrent, they are finite. (That was our lemma in the previous section.) Thus we’re allowed to subtract them, and we get \\(\\pi_k \\mu_k = 1\\), which is indeed \\(\\pi_k = 1/\\mu_k\\). We can repeat the argument for every choice of \\(k\\). In the next section, we see how the stationary distribution tells us very important things about the long-term behaviour of a Markov chain. "],["P05.html", "Problem sheet 5", " Problem sheet 5 .fold-btn { float: right; margin: -12px 0 0 0; } You should attempt all these questions and write up your solutions in advance of your workshop in week 6 (Monday 1 or Tuesday 2 March) where the answers will be discussed. 1. Find a stationary distribution for the Markov chain with transition matrix \\[ \\mathsf P = \\begin{pmatrix} \\frac13 &amp; \\frac23 &amp; 0 \\\\ \\frac16 &amp; \\frac13 &amp; \\frac12 \\\\ 0 &amp; \\frac13 &amp; \\frac23 \\end{pmatrix} . \\] Solution. The equations are \\[\\begin{align*} \\pi_1 &amp;= \\tfrac13 \\pi_1 + \\tfrac16 \\pi_2 \\\\ \\pi_2 &amp;= \\tfrac23 \\pi_1 + \\tfrac13 \\pi_2 + \\tfrac23 \\pi_3 \\\\ \\pi_3 &amp;= \\phantom{\\tfrac23 \\pi_1} + \\tfrac12 \\pi_2 + \\tfrac23 \\pi_3 \\end{align*}\\] It’ll make out lives more pleasant if we pick \\(\\pi_2\\) as the working variable and delete the second equation. The first equation becomes \\(\\pi_1 = \\tfrac14 \\pi_2\\), and the third equation become \\(\\pi_3 = \\tfrac32 \\pi_2\\). The normalising condition is \\[ \\pi_1 + \\pi_2 + \\pi_3 = \\left( \\tfrac14 + 1 + \\tfrac32\\right) \\pi_2 = \\tfrac{11}{4} \\pi_2 . \\] So \\(\\pi_2 = \\frac4{11}\\), so \\(\\pi_1 = \\frac{1}{11}\\) and \\(\\pi_3 = \\frac{6}{11}\\). The stationary distribution is \\(\\boldsymbol\\pi = (\\frac{1}{11}, \\frac{4}{11}, \\frac{6}{11})\\). 2. Consider a Markov chain with state space \\(\\mathcal S = \\{1,2,3,4\\}\\) and transition matrix \\[ \\mathsf P = \\begin{pmatrix} \\frac14 &amp; \\frac12 &amp;\\frac14 &amp; 0 \\\\ \\frac14 &amp; \\frac14 &amp; \\frac12 &amp; 0 \\\\ \\frac12 &amp; \\frac12 &amp; 0 &amp; 0 \\\\ \\frac14 &amp; 0 &amp;\\frac14 &amp; \\frac 12 \\end{pmatrix} . \\] (a) Draw a transition diagram for this Markov chain. Solution. Figure 10.2: Transition diagram for Question 2. (b) Identify the communicating classes. State whether each class closed or not. State whether each class is positive recurrent, null recurrent, or transient. Solution. The class \\(\\{1,2,3\\}\\) is closed, so is positive recurrent. The class \\(\\{4\\}\\) is not closed, so is transient. (c) Find a stationary distribution for this Markov chain. Solution. First, we write out the equations \\(\\boldsymbol\\pi = \\boldsymbol\\pi\\mathsf P\\), which are \\[\\begin{align*} \\pi_1 &amp;= \\tfrac14\\pi_1 + \\tfrac14\\pi_2 + \\tfrac12\\pi_3 + \\tfrac14\\pi_4 \\\\ \\pi_2 &amp;= \\tfrac12\\pi_1 + \\tfrac14\\pi_2 + \\tfrac12\\pi_3 \\\\ \\pi_3 &amp;= \\tfrac14\\pi_1 + \\tfrac12\\pi_2 \\phantom{{}+\\tfrac12\\pi_3} + \\tfrac14\\pi_4 \\\\ \\pi_4 &amp;= \\phantom{\\tfrac12\\pi_1 + \\tfrac14\\pi_2 + \\tfrac12\\pi_3+{}} \\tfrac12 \\pi_4 . \\end{align*}\\] From the fourth equation we immediately see that \\(\\pi_4 = 0\\). Second, we rewrite the first two of the other equations with \\(\\pi_1\\) as the working variable, which gives \\[\\begin{align} 3\\pi_1 &amp;= \\phantom{3}\\pi_2 + 2\\pi_3 \\tag{1} \\\\ 2\\pi_1 &amp;= 3\\pi_2 - 2\\pi_3 \\tag{2} . \\end{align}\\] Adding (1) and (2) gives \\(5\\pi_1 = 4\\pi_2\\), so \\(\\pi_2 = \\frac54\\pi_1\\). Substituting this into (1) and solving gives \\(\\pi_3 = \\frac78 \\pi_1\\). Third, the normalising condition is \\[ \\pi_1 + \\pi_2 + \\pi_3 + \\pi_4 = \\pi_1 + \\tfrac54\\pi_1 + \\tfrac78\\pi_1 + 0 = \\tfrac{25}{8}\\pi_1 = 1, \\] so \\(\\pi_1 = \\frac{8}{25}\\). Hence, we have a stationary distribution \\[ \\boldsymbol\\pi = \\left(\\tfrac{8}{25} \\quad \\tfrac{10}{25} \\quad \\tfrac{7}{25} \\quad 0 \\right) .\\] (d) Is this the only stationary distribution? Solution. Yes. The Markov chain has one positive recurrent class, so there is a unique stationary distribution, and it is supported only on that class. 3. Consider a Markov chain with state space \\(\\mathcal S = \\{1,2,3,4,5\\}\\) and transition matrix \\[ \\mathsf P = \\begin{pmatrix} \\frac13 &amp; \\frac23 &amp; 0 &amp;0 &amp; 0 \\\\ \\frac13 &amp; \\frac23 &amp; 0 &amp;0 &amp; 0 \\\\ 0 &amp;\\frac35 &amp; \\frac15 &amp; \\frac15 &amp; 0 \\\\ 0 &amp; 0 &amp; 0 &amp; \\frac14 &amp;\\frac34 \\\\ 0 &amp; 0 &amp; 0 &amp; \\frac12 &amp; \\frac12 \\end{pmatrix} . \\] (a) Draw a transition diagram for this Markov chain. Solution. Figure 10.3: Transition diagram for Question 3. (b) Identify the communicating classes. State whether each class closed or not. State if each class is positive recurrent, null recurrent, or transient. Solution. The class \\(\\{1,2\\}\\) is closed, so is positive recurrent. The class \\(\\{3\\}\\) is not closed, so is transient. The class \\(\\{4,5\\}\\) is closed, so is positive recurrent. (c) Find all of the stationary distributions for this Markov chain. Solution. We can have a stationary distribution supported on either of the positive recurrent classes, but we will always have \\(\\pi_3 = 0\\), as that state is transient. For the class \\(\\{1,2\\}\\) we have \\[ \\pi_1 = \\tfrac13\\pi_1 + \\tfrac13\\pi_2 \\qquad \\pi_2 = \\tfrac23\\pi_1 + \\tfrac23\\pi_2 , \\] giving \\(\\pi_2 = 2\\pi_1\\), and a stationary distribution \\((\\tfrac 13, \\tfrac23, 0, 0, 0)\\). For the class \\(\\{4,5\\}\\), we have \\[ \\pi_4 = \\tfrac14\\pi_4 + \\tfrac12\\pi_5 \\qquad \\pi_5 = \\tfrac34\\pi_4 + \\tfrac12\\pi_5 , \\] giving \\(3\\pi_4 = 2\\pi_5\\), and a stationary distribution \\((0,0,0,\\frac25,\\frac35)\\). Finally, any linear combination of those where the coefficients are positive and add to \\(1\\) will also be a stationary distribution, so we have a family of stationary distributions \\[ \\left( \\tfrac13\\alpha \\quad \\tfrac23\\alpha \\quad 0 \\quad \\tfrac25(1-\\alpha) \\quad \\tfrac35(1-\\alpha) \\right) \\] for \\(0 \\leq \\alpha \\leq 1\\). 4. Consider the simple random walk \\((X_n)\\) on \\(\\mathcal S = \\mathbb Z_+ = \\{0,1,2,\\dots\\}\\) with up probability \\(p\\) and down probability \\(q = 1-p\\), and a mixed barrier at \\(0\\), where \\(p_{01} = p\\), \\(p_{00} = q\\), and \\(p_{0i} = 0\\) otherwise. We seek a stationary distribution for this Markov chain. (a) Suppose \\(p \\neq \\frac12\\). Show that the general solution to \\[ \\pi_j = \\sum_i \\pi_i p_{ij} = p\\pi_{j-1} + q\\pi_{j+1} \\] is \\(\\pi_i = A + B\\tau^i\\), where \\(\\tau = p/q\\). Solution. Let’s rewrite this as \\(q\\pi_{j+1} - \\pi_j + p\\pi_{j-1} = 0\\). This is a homogeneous linear difference equation. The characteristic equation is \\(p\\lambda^2 - \\lambda + p = 0\\), which factorises as \\((q\\lambda - p)(\\lambda-1) = 0\\) (using that \\(p + q = 1\\)), which has solutions \\(\\lambda = 1\\) and \\(\\lambda = p/q = \\tau\\). Since \\(p \\neq \\frac12\\), these roots are distinct. So the general solution is \\(\\pi_i = A + B\\tau^i\\). (b) Show that the initial condition \\(\\pi_0 = q\\pi_0 + q\\pi_1\\) gives \\(A = 0\\). Solution. The initial condition gives \\[ A + B = q(A + B) + q(A + B\\tau) ,\\] which after rearranging gives \\((1-2q)A = 0\\), where we have used \\(q + q\\tau = q + p = 1\\). Since \\(1-2q\\neq 0\\), we must have \\(A = 0\\). (c) By considering the normalising condition \\(\\sum_i \\pi_i =1\\), work out for what values of \\(p \\neq \\frac12\\) there exists a stationary distribution for \\((X_n)\\). What is the stationary distribution (when it exists)? Solution. We have \\(\\pi_i = B\\tau^i\\), so require \\(B \\sum_{i=1}^\\infty \\tau^i = 1\\). When \\(p &gt; \\frac12\\), then \\(\\tau &gt; 1\\) and the sum does not converge, and we have no stationary distribution. When \\(p &lt; \\frac12\\), then \\(\\tau &lt; 1\\), so \\[ \\sum_{i=1}^\\infty \\tau^i = \\frac{1}{1-\\tau} \\qquad \\Rightarrow \\qquad B = \\frac{1}{\\frac{1}{1-\\tau}} = 1 - \\tau, \\] so we have a geometric stationary distribution \\(\\pi_i = (1-\\tau)\\tau^i\\). (d) Does there exist a stationary distribution when \\(p = \\frac12\\)? Solution. Here, the linear difference equation has general solution \\(\\pi_i = A + Bi\\), as we saw with the symmetric gambler’s ruin problem. The initial condition gives \\(A = \\frac12A + \\frac12(A + B)\\), and so \\(B = 0\\), giving \\(\\pi_i = A\\). The normalisation condition is \\(\\infty \\times A = 1\\), which cannot be fulfilled. Hence no stationary distribution exists. 5. The infinite rooted binary tree is a graph with no cycles. There is one special vertex, the root 0, that has two edges, and every other edge has three edges. A Markov chain \\((X_n)\\) starts from 0, then at each time step, takes one of the edges coming out of the current vertex and moves along it to the neighbouring vertex. Note that a step can go away from the root or towards the root. Figure 10.4: The first three-and-a-bit levels of the rooted binary tree. By considering the distance of \\((X_n)\\) from the root, or otherwise, show that \\((X_n)\\) is transient. Solution. We want to show that \\(m_0\\), the return probability to the root, is strictly less than 1. Let \\(Y_n\\) be the distance of \\(X_n\\) from the root as suggested in the question. Then \\(X_n\\) returns to to the root if and only if \\(Y_n\\) returns to \\(0\\), so we can look at that instead. If \\((Y_n)\\) is the distance from the root, than at each time step \\(Y_{n+1} = Y_n + 1\\) with probability \\(\\frac23\\), if we take either of the two edges away from root, or \\(Y_n = Y_n - 1\\) with probability \\(\\frac13\\), if we take the edge back towards the root. If \\(Y_n = 0\\) is at the root, then \\(Y_{n+1} = Y_n+1\\). So \\((Y_n)\\) is a simple random walk with positive drift \\(p = \\frac23 &gt; \\frac12\\) and a reflecting barrier at \\(0\\), which is transient. To prove it’s transient, we can use a conditioning on the first step argument to get \\(m_0 = h_{10}\\), and \\[ h_{i\\,0} = \\tfrac23 h_{i+1\\,0} + \\tfrac23 h_{i-1,\\,0} . \\] The general solution is \\[ h_{i0} = A + B\\left(\\tfrac12\\right)^i , \\] since \\(\\rho = \\frac13 / \\frac23 = \\frac12\\). The initial condition \\(h_{00} = 1\\) gives \\(A + B = 1\\), so \\[ h_{i0} = 1 - B\\left(1 - \\left(\\tfrac12\\right)^i\\right) , \\] and non-negative minimlality requires \\(B = 1\\). Hence \\[ h_{i0} = \\left(\\tfrac12\\right)^i , \\] and \\(m_0 = h_{10} = \\frac12 &lt; 1\\), as required. 6. “Every Markov chain on a finite state space has at least one stationary distribution.” Explain carefully why this is true. You may use facts from the notes or previous example sheets, provided that you state them clearly. Solution. In Problem Sheet 4, Question 3, we showed that every finite-state Markov chain has a closed communicating class. In lectures, we showed the finite closed communicating classes are positive recurrent. If we look at the Markov chain restricted to just such a positive recurrent and closed class, then that restricted Markov chain is irreducible and positive recurrent, so it has a stationary distribution \\(\\boldsymbol\\pi\\). Since the class is closed, we have a stationary distribution that is \\(\\boldsymbol\\pi\\) on the given closed class and \\(0\\) elsewhere. "],["S11-long-term-chains.html", "Section 11 Long-term behaviour of Markov chains 11.1 Convergence to equilibrium 11.2 Examples of convergence and non-convergence 11.3 Ergodic theorem 11.4 Proofs of the limit and ergodic theorems", " Section 11 Long-term behaviour of Markov chains The limit theorem: convergence to the stationary distribution for irreducible, aperiodic, positive recurrent Markov chains The ergodic theorem for the long-run proportion of time spent in each state 11.1 Convergence to equilibrium In this section we’re interested in what happens to a Markov chain \\((X_n)\\) in the long-run – that is, when \\(n\\) tends to infinity. One thing that could happen over time is that the distribution \\(\\mathbb P(X_n = i)\\) of the Markov chain could gradually settle down towards some “equilibrium” distribution. Further, perhaps that long-term equilibrium might not depend on the initial distribution, but the effects of the initial distribution might eventually almost disappear, exhibiting a “lack of memory” of the start of the process. Just in case that does happen, let’s give it a name. Definition 11.1 Let \\((X_n)\\) be a Markov chain on a state space \\(\\mathcal S\\) with transition matrix \\(\\mathsf P\\). Suppose there exists a distribution \\(\\mathbf p^* = (p_i^*)\\) on \\(\\mathcal S\\) (so \\(p_i^* \\geq 0\\) and \\(\\sum_i p_i^* = 1\\)) such that, whatever the initial distribution \\(\\boldsymbol\\lambda = (\\lambda_i)\\), we have \\(\\mathbb P(X_n = j) \\to p^*_j\\) as \\(n \\to \\infty\\) for all \\(j \\in \\mathcal S\\). Then we say that \\(\\mathbf p^*\\) is an equilibrium distribution. It’s clear there can only be at most one equilibrium distribution – but will there be one at all? The following is the most important result in this course. (Recall that an irreducible Markov chain is aperiodic if it has period 1.) Theorem 11.1 (Limit theorem) Let \\((X_n)\\) be an irreducible and aperiodic Markov chain. Then for any initial distribution \\(\\boldsymbol\\lambda\\), we have that \\(\\mathbb P(X_n = j) \\to 1/\\mu_j\\) as \\(n \\to \\infty\\), where \\(\\mu_j\\) is the expected return time to state \\(j\\). In particular: Suppose \\((X_n)\\) is positive recurrent. Then the unique stationary distribution \\(\\boldsymbol\\pi\\) given by \\(\\pi_j = 1/\\mu_j\\) is the equilibrium distribution, so \\(\\mathbb P(X_n = j) \\to \\pi_j\\) for all \\(j\\). Suppose \\((X_n)\\) is null recurrent or transient. Then \\(\\mathbb P(X_n = j) \\to 0\\) for all \\(j\\), and there is no equilibrium distribution. I particularly like how this one theorem gathers together all the ideas from the course in one result (Markov chains, irreducibility, periodicity, recurrence/transience, positive/null recurrence, return times, stationary distribution…). Note the three conditions for convergence to an equilibrium distribution: irreducibility, aperiodicity, and positive recurrence. Consider a irreducible, aperiodic, positive recurrent Markov chain. Taking the initial distribution to be starting in state \\(i\\) with certainty, the limit theorem tells us that \\(p_{ij}(n) \\to \\pi_j\\) for all \\(i\\) and \\(j\\). This means that the \\(n\\)-step transition matrix will have the limiting value \\[ \\lim_{n \\to \\infty} \\mathsf P(n) = \\begin{pmatrix} \\pi_1 &amp; \\pi_2 &amp; \\cdots &amp; \\pi_N \\\\ \\pi_1 &amp; \\pi_2 &amp; \\cdots &amp; \\pi_N \\\\ \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots \\\\ \\pi_1 &amp; \\pi_2 &amp; \\cdots &amp; \\pi_N \\end{pmatrix} , \\] where each row is identical. We give an full proof of the limit theorem below (optional and nonexaminable). However, this easier result gets part way there. Theorem 11.2 If an equilibrium distribution \\(\\mathbf p^*\\) does exist, then \\(\\mathbf p^*\\) is a stationary distribution. Given this result it’s clear that an irreducible Markov chain cannot have an equilibrium distribution if it is null recurrent or transient, as it doesn’t even have a stationary distribution. So the positive recurrent case is the hard (nonexaminable) one. Proof. We need to verify that \\(\\mathbf p^* \\mathsf P = \\mathbf p^*\\). We have \\[ \\sum_i p_i^* p_{ij} = \\sum_i \\left(\\lim_{n\\to\\infty} p_{ki}(n) \\right) p_{ij} = \\lim_{n\\to\\infty} \\sum_i p_{ki}(n) p_{ij} = \\lim_{n\\to\\infty} p_{kj}(n+1) = p^*_j , \\] as desired. (Strictly speaking, swapping the sum and the limit is only formally justified when the state space is finite, although the theorem is true universally.) 11.2 Examples of convergence and non-convergence Example 11.1 The two-state “broken printer” Markov chain is irreducible, aperiodic, and positive recurrent, so its stationary distribution is also the equilibrium distribution. We proved this from first principles in Question 3 on Problem Sheet 3. Example 11.2 Recall the simple no-claims discount Markov chain from Lecture 6, which is irreducible, aperiodic, and positive recurrent. We saw last time that is has the unique stationary distribution \\[ \\boldsymbol\\pi = \\left(\\tfrac1{13} \\quad \\tfrac{3}{13}\\quad \\tfrac9{13}\\right) = (0.0769\\quad 0.2308\\quad 0.6923) . \\] From the limit theorem, we see that the \\(n\\)-step transition probability tends to a limit where every row is equal to \\(\\boldsymbol\\pi\\). We can check using a computer: for \\(n = 12\\), say, \\[ \\mathsf P(12) = \\mathsf P^{12} = \\begin{pmatrix} 0.0770 &amp; 0.2308 &amp; 0.6923 \\\\ 0.0769 &amp; 0.2308 &amp; 0.6923 \\\\ 0.0769 &amp; 0.2308 &amp; 0.6923 \\end{pmatrix}, \\] where \\(p_{ij}(12)\\) is equal to \\(\\pi_j\\) up to at least 3 decimal places for all \\(i,j\\). As \\(n\\) gets bigger, the matrix gets closer and closer to the limiting form. Example 11.3 The simple random walk is null recurrent for \\(p = \\frac12\\) and transient otherwise. Either way, we have \\(\\mathbb P(X_n = i) \\to 0\\) for all states \\(i\\), and there is no equilibrium distribution. Example 11.4 Consider a Markov chain \\((X_n)\\) on state space \\(\\mathcal S = \\{0,1\\}\\) and transition matrix \\[ \\mathsf P = \\begin{pmatrix} 0 &amp; 1 \\\\ 1 &amp; 0 \\end{pmatrix} . \\] So at each stage we swap from state \\(0\\) to state \\(1\\) and back again. This chain is irreducible and positive recurrent, so it has a unique stationary distribution, which is clearly \\(\\boldsymbol\\pi = (\\frac12\\quad\\frac12)\\). However, we don’t have convergence to equilibrium. If we start from initial distribution \\((\\lambda_0, \\lambda_1)\\), then \\(\\mathbb P(X_n = 0) = \\lambda_0\\) for even \\(n\\) and \\(\\mathbb P(X_n = 0) = \\lambda_1\\) for odd \\(n\\). When \\(\\lambda_0 \\neq \\frac12\\), this does not converge. The point is that this chain is not aperiodic: it has period \\(2\\), so the limit theorem does not apply. Example 11.5 Consider a Markov chain with state space \\(\\mathcal S = \\{1,2,3\\}\\) and transition diagram as shown below. Figure 11.1: Transition diagram for a Markov chain with two positive recurrent classes. This chain is not irreducible, but has two aperiodic and positive recurrent communicating classes. In particular, it has many stationary distributions including \\((1, 0, 0)\\) and \\((0, \\frac8{17}, \\frac9{17})\\) (optional exercise for the reader). If we start in state 1, then the limiting distribution is the former, while if we start in states 2 or 3, the limiting distribution is the latter. In particular, as \\(n \\to \\infty\\), we have \\[ \\mathsf P^{(n)} \\to \\begin{pmatrix} 1 &amp; 0 &amp; 0 \\\\ 0 &amp; \\frac8{17} &amp; \\frac9{17} \\\\ 0 &amp; \\frac8{17} &amp; \\frac9{17} \\end{pmatrix}. \\] 11.3 Ergodic theorem The limit theorem looked at the limit of \\(\\mathbb P(X_n = j)\\), the probability that the Markov chain is in state \\(j\\) at some specific point in time \\(n\\) a long time in the future. We could also look at the long-run amount of time spent in state \\(j\\); that is, averaging the behaviour over a long time period. (The word “ergodic” is used in mathematics to refer to concepts to do with the long-term proportion of time.) Let us write \\[ V_j(N) := \\# \\big\\{ n &lt; N : X_n = j \\} \\] for the total number of visits to state \\(j\\) up to time \\(N\\). Then we can interpret \\(V_j(n)/n\\) as the proportion of time up to time \\(n\\) spent in state \\(j\\), and its limiting value (if it exists) to be the long-run proportion of time spent in state \\(j\\). Theorem 11.3 (Ergodic theorem) Let \\((X_n)\\) be an irreducible Markov chain. Then for any initial distribution \\(\\boldsymbol\\lambda\\) we have that \\(V_j(n)/n \\to 1/\\mu_j\\) almost surely as \\(n \\to \\infty\\), where \\(\\mu_j\\) is the expected return time to state \\(j\\). In particular: Suppose \\((X_n)\\) is positive recurrent. Then there is a unique stationary distribution \\(\\boldsymbol\\pi\\) given by \\(\\pi_j = 1/\\mu_j\\), and \\(V_j(n)/n \\to \\pi_j\\) almost surely for all \\(j\\). Suppose \\((X_n)\\) is null recurrent or transient. Then \\(V_j(n)/n \\to 0\\) almost surely for all \\(j\\). For completeness, we should note that “almost sure” convergence means that \\(\\mathbb P(V_j(n)/n \\to 1/\\mu_j) = 1\\), although the precise definition is not important for us in this module. Note that, because we are averaging over a long-time period, we no longer need the condition that the Markov chain is aperiodic; for convergence of the long-term proportion of time to the stationary distribution we just need irreducibility and positive recurrence. Again, we give an optional and nonexaminable proof below. Example 11.6 Recall the simple no-claims discount Markov chain. Since this chain is irreducible and positive recurrent, we now see that the long-term proportion of time spent in each state corresponds to the stationary distribution \\(\\boldsymbol\\pi = (\\frac1{13} \\quad \\frac{3}{13}\\quad \\frac9{13})\\). Therefore, over the lifetime of an insurance policy held for a long period of time, the average discount is approximately \\[ \\tfrac{1}{13}(0\\%) + \\tfrac{3}{13}(25\\%) + \\tfrac{9}{13}(50\\%) = \\tfrac{21}{52} = 40.4\\% . \\] Example 11.7 The two-state “swapping” chain we saw earlier did have a unique stationary distribution \\((\\frac12, \\frac12)\\), but did not have an equilibrium distribution, because it was periodic. But it is true that \\(V_0(n)/n \\to \\pi_0 = \\frac12\\) and \\(V_1(n)/n \\to \\pi_1 = \\frac12\\), due to the ergodic theorem. So although where we are at some specific point in the future depends on where we started from, in the long run we always spend half our time in each state. 11.4 Proofs of the limit and ergodic theorems This subsection is optional and nonexaminable. Again, it’s important to be able to use the limit and ergodic theorems, but less important to be able to prove them. First, the limit theorem. The only bit left is the first part: that for an irreducible, aperiodic, positive recurrent Markov chain, the stationary distribution \\(\\boldsymbol\\pi\\) is an equilibrium distribution. This cunning proof uses a technique called “coupling”. When looking at two different random objects \\(X\\) and \\(Y\\) (like random variables or stochastic processes), it seems natural to prefer \\(X\\) and \\(Y\\) to be independent. However, coupling is the idea that it can sometimes be beneficial to let \\(X\\) and \\(Y\\) actually be dependent on each other. Proof (Proof of Theorem 11.1). Let \\((X_n)\\) be our irreducible, aperiodic, positive recurrent Markov chain with transition matrix \\(\\mathsf P\\) and initial distribution \\(\\boldsymbol\\lambda\\). Let \\((Y_n)\\) be a Markov chain also with transition matrix \\(\\mathsf P\\) but “in equilibrium” – that is, started from the stationary distribution \\(\\boldsymbol\\pi\\), and thus staying in that distribution for ever. Pick a state \\(s \\in \\mathcal S\\), and let \\(T\\) be the first time the \\(X_n = Y_n = s\\) (or \\(T = \\infty\\), if that never happens). Now here’s the coupling: after \\(T\\), when \\((X_n)\\) and \\((Y_n)\\) collide at \\(s\\), then make \\((X_n)\\) stick to \\((Y_n)\\), so \\(X_n = Y_n\\) for \\(n \\geq T\\). Since a Markov chain has no memory, \\((X_{T+n}) = (Y_{T+n})\\) is still just a Markov chain with the same transition probabilities from that point on. (Readers of a previous optional subsection will recognise \\(T\\) as a stopping time and will notice we’re using the strong Markov property.) Most importantly, thanks to the coupling, from the time \\(T\\) onwards, \\((X_n)\\) will also always have distribution \\(\\boldsymbol\\pi\\), a fact that will obviously be very useful in this proof. It will be important that \\(T\\) is finite with probability 1. Define \\((\\mathbf Z_n)\\) by \\(\\mathbf Z_n = (X_n, Y_n)\\). So \\((\\mathbf Z_n)\\) is a Markov chain on \\(\\mathcal S \\times \\mathcal S\\), and \\(T\\) is the expected hitting time of \\((\\mathbf Z_n)\\) to the state \\((s, s) \\in \\mathcal S \\times \\mathcal S\\). The transition probabilities for \\((\\mathbf Z_n)\\) are \\(\\mathsf{\\tilde P} = (\\tilde p_{(i,k)(j,l)})\\) where \\[ \\tilde p_{(i,k)(j,l)} = p_{ij}p_{kl} . \\] This is the probability that the joint chain goes from \\(\\mathbf Z_n = (X_n, Y_n) = (i, k)\\) to \\(\\mathbf Z_{n+1} = (X_{n+1}, Y_{n+1}) = (j, l)\\). Since the original Markov chain is irreducible and aperiodic, this means that \\(p_{ij}(n), p_{kl}(n) &gt; 0\\) for all \\(n\\) sufficiently large, so \\(\\tilde p_{(i,k)(j,l)}(n) &gt; 0\\) for all \\(n\\) sufficiently large also, meaning that \\((\\mathbf Z_n)\\) is irreducible (and, although this isn’t required, aperiodic). Further, \\((\\mathbf Z_n)\\) has a stationary distribution \\(\\mathbf{\\tilde \\pi} = (\\tilde \\pi_{(i,k)})\\) where \\[ \\tilde \\pi_{(i,k)} = \\pi_i \\pi_k , \\] which means that \\((\\mathbf Z_n)\\) is positive recurrent. Thus \\(T\\) is finite with probability 1. So we can finally prove the limit theorem. We want to show that \\(\\mathbb P(X_n = i)\\) tends to \\(\\pi_i\\). The difference between them is \\[\\begin{align*} \\big|\\mathbb P(X_i = i) - \\pi_i\\big| &amp;= \\mathbb P(n \\leq T)\\times\\big|\\mathbb P(X_i = i \\mid n \\leq T) - \\pi_i\\big| + P(n &gt; T) \\times |\\pi_i - \\pi_i| \\\\ &amp;= \\mathbb P(n \\leq T)\\times\\big|\\mathbb P(X_i = i \\mid n \\leq T) \\\\ &amp;\\leq \\mathbb P(n \\leq T) . \\end{align*}\\] Here, the equality on the first line is because \\((X_n)\\) follows the stationary distribution exactly once it sticks to \\((Y_n)\\) after time \\(T\\), and the inequality on the third line is because the absolute difference between two probabilities is between 0 and 1. But we’ve already shown that \\(T\\) is finite with probability 1, so \\(\\mathbb P(n \\leq T) = \\mathbb P(T \\geq n) \\to 0\\), and we’re done. The proof of the ergodic theorem uses the law of large numbers. Recall that the law of large numbers states that if \\(Y_1, Y_2, \\dots\\) are IID random variables with mean \\(\\mu\\), then \\[ \\frac{Y_1 + Y_2 + \\cdots + Y_n}{n} \\to \\mu \\qquad \\text{as $n \\to \\infty$}. \\] This means it’s also true that for any sequence \\((a_n)\\) with \\(a_n \\to \\infty\\), we also have \\[ \\frac{Y_1 + Y_2 + \\cdots + Y_{a_n}}{a_n} \\to \\mu \\qquad \\text{as $n \\to \\infty$}. \\] Proof (Proof of Theorem 11.3). If \\((X_n)\\) is transient, then the number of visits to state \\(i\\) is finite with probability 1, so \\(V_i(n)/n \\to 0\\), as required. Suppose instead that \\((X_n)\\) is recurrent. By our useful lemma we know we will hit \\(i\\) in finite time, so we can ignore that negligible “burn-in” period, and (by the strong Markov property) assume we start from \\(i\\). Let \\(M_{i}^{(r)}\\) be the time between the \\(r\\)th and \\((r+1)\\)th visits to \\(i\\). Note that the \\(M_{i}^{(r)}\\) are IID with mean \\(\\mu_i\\). The time of the last visit to \\(i\\) before time \\(n\\) is \\[ M_{i}^{(1)} + M_{i}^{(2)} + \\cdots + M_{i}^{(V_i(n)-1)} &lt; n ,\\] and the time of the first visit to \\(i\\) after time \\(n\\) is \\[ M_{i}^{(1)} + M_{i}^{(2)} + \\cdots + M_{i}^{(V_i(n))} \\geq n .\\] Hence \\[\\begin{equation} \\frac{M_{i}^{(1)} + M_{i}^{(2)} + \\cdots + M_{i}^{(V_i(n)-1)}}{V_i(n)} &lt; \\frac{n}{V_i(n)} \\leq \\frac{M_{i}^{(1)} + M_{i}^{(2)} + \\cdots + M_{i}^{(V_i(n))}}{V_i(n)} . \\tag{11.1} \\end{equation}\\] Because \\((X_n)\\) is recurrent, we keep returning to \\(i\\), so \\(V_i(n) \\to \\infty\\) with probability 1. Hence, by the law of large numbers, both the left- and right-hand sides of (11.1) tend to \\(\\mathbb E M_{i}^{(r)} = \\mu_i\\). So \\(n/V_i(n)\\) is sandwiched between them, and tends to \\(\\mu_i\\) too. Finally \\(n/V_i(n) \\to \\mu_i\\) is equivalent to \\(V_i(n)/n \\to 1/\\mu_i\\), so we are done. This completes the material on discrete time Markov chains. In the next section, we recap what we have learned, and have a little time for some revision. "],["S12-revision-i.html", "Section 12 End of of Part I: Discrete time Markov chains 12.1 Things to do 12.2 Summary of Part 1", " Section 12 End of of Part I: Discrete time Markov chains No new material in this section, but a half-week break to catch up and take stock on what we’ve learned 12.1 Things to do We’ve now finished the material of the Part 1 of the module, on discrete time Markov chains. So this is a good time to take stock, revise what we’ve learned, and make sure we’re completely up to date before starting Part 2 of the module on continuous time processes. Some things you may want to do in lieu of reading a section of notes: Make sure you’ve completed Problem Sheets 1 to 6, and go back to any questions that stumped you before. Start working on Computational Worksheet 2 (which doubles as Assessment 2). There are optional computer drop-in sessions in Week 7, and the work is due on Thursday 18 March 1400 (week 8). Start working on Assessment 3 which is due on Thursday 25 March 1400 (week 9). Re-read any sections of notes you struggled with earlier. Take the opportunity to look at the optional nonexaminable subsections, if you opted out the first time around. (Section 9, Section 10, Section 11) Let me know if there’s anything from this part of the course you’d like me to go through in next week’s lecture. 12.2 Summary of Part 1 The following list is not exhaustive, but if you can do most of the things on this list, you’re well placed for the exam. Define the simple random walk and other random walks. Perform elementary calculations for the simple random walk, including by referring to the exact binomial distribution. Calculate the expectation and variance of general random walks. Define the gambler’s ruin Markov chain. Find the ruin probability and expected duration for the gambler’s ruin by (i) setting up equations by conditioning on the first step and (ii) solving the resulting linear difference equation. Draw a transition diagram of a Markov chain given the transition matrix. Calculate \\(n\\)-step transitions probabilities by (a) summing the probabilities over all relevant paths or (b) calculating the matrix power. Find the communicating classes in a Markov chain. Calculate the period of communicating class. Calculate hitting probabilities and expected hitting times by (i) setting up equations by conditioning on the first step and (ii) solving the resulting simultaneous equations. Define positive recurrence, null recurrence and transience, and explain their properties. Find the positive recurrence, null recurrence or transience of communicating classes. Find the stationary distribution of Markov chain. Give conditions for a stationary distribution to exist and be unique. Give conditions for convergence to an equilibrium distribution. Calculate long-term proportions of time using the ergodic theorem. In the next section, we begin our study of continuous time Markov processes by looking at the most important example: the Poisson process. "],["P06.html", "Problem sheet 6", " Problem sheet 6 .fold-btn { float: right; margin: -12px 0 0 0; } You should attempt all these questions and write up your solutions in advance of your workshop in week 7 (Monday 8 or Tuesday 9 March) where the answers will be discussed. Remember that the mid-semester survey is still open. 1. Consider a Markov chain \\((X_n)\\) with state space \\(\\mathcal S =\\{1,2,3\\}\\) and transition matrix \\[ \\mathsf P = \\begin{pmatrix} 0 &amp; 1 &amp; 0 \\\\ 0 &amp; 0 &amp; 1 \\\\ 1 &amp; 0 &amp; 0 \\end{pmatrix}. \\] (a) Draw a transition diagram for this Markov chain. Is it irreducible? Is each state periodic or aperiodic? Solution. Figure 12.1: Transition diagram for Question 1. The Markov chain is irreducible, since we have \\(1 \\to 2 \\to 3 \\to 1\\). Since we continually cycle around the triangle, it’s clear that the period is \\(d = 3\\). (b) What is \\(m_i\\), the return probability, for each state? What is \\(\\mu_i\\), the expected return time for each state. Solution. Again, since we continually cycle around the triangle, we always return in \\(3\\) steps, so \\(m_i = 1\\) and \\(\\mu_i =3\\) for all \\(i\\). (c) By solving \\(\\boldsymbol \\pi = \\boldsymbol\\pi \\mathsf P\\), find the stationary distribution. Use this to confirm the values of \\(\\mu_i\\). Solution. The equations give \\(\\pi_1 = \\pi_3\\), \\(\\pi_2 = \\pi_1\\) and \\(\\pi_3 = \\pi_2\\), meaning they’re all equal. The normalising condition gives \\(\\boldsymbol\\pi = (\\frac13, \\frac13, \\frac13)\\). The expected return times are \\(\\mu_i = 1/\\pi_i = 3\\), as predicted. (d) For what initial distributions \\(\\boldsymbol\\lambda\\) do the limits \\(\\lim_{n \\to \\infty} \\mathbb P(X_n = i)\\) exist? Solution. For a given initial condition \\((\\lambda_1, \\lambda_2, \\lambda_3)\\) it’s clear we cycle through the initial condition, \\((\\lambda_2, \\lambda_3, \\lambda_1)\\), and \\((\\lambda_3, \\lambda_1, \\lambda_2)\\). Hence the limits only exist if \\(\\lambda_1 = \\lambda_2 = \\lambda_3 = \\frac13\\). (e) What is the long-run proportion of time spent in each state? Solution. Since the Markov chain is irreducible and positive recurrent (like every finite irreducible chain), the ergodic theorem tells us that the long-run proportion of time spent in each state \\(i\\) is \\(\\pi_i = \\frac13\\). 2. Every person has two chromosomes; each chromosome is a copy of a chromosome from one of the person’s parents. There are two types of chromosome, which are conventionally labelled X and Y. A child born with a Y chromosome is male, while a child with two X chromosomes is female. Haemophilia is a blood-clotting disorder caused by a defective X chromosome (we will label this as \\(\\text X^*\\)). Females with the defective chromosome (\\(\\text X^*\\text X\\)) will not typically show symptoms of the disease but can pass it on to children – they are “carriers”. Males with the defective chromosome (\\(\\text X^* \\text Y\\)) have the disease and its symptoms. A medical statistician is studying the progress of the disease through first-born children, starting with a female carrier. The statistician makes the following assumptions: First, each parent has an equal probability of passing either of their chromosomes to their children. Second, the partner of each person in the study does not have a defective X chromosome. Third, no new genetic disorders occur. (a) Show that we can use a Markov chain to model the progress of the disease under the above assumptions. What is the state space? Draw a transition diagram. Solution. Consider a stochastic process on the state space \\(\\mathcal S = \\{\\text{F}, \\text{M}, \\text{m}, \\text{f}\\}\\), where F means the first-born child is a female carrier, M means the child is a male haemophiliac, f means the child is a female non-carrier, and m means the child is a male without the disease. (This is not the only way to set up the Markov chain.) If we let \\((X_n)\\) be the status of the first-born child at the \\(n\\)th generation, then it is clear that \\(X_{n+1}\\), the status of the \\((n+1)\\)st individual, will depend on the status of their parent \\(X_n\\), but, given that, will not depend further on the history of the process. So we have the Markov property. The transition probabilities are: From a female carrier, \\(p_{\\mathrm{FF}} = \\frac14\\) or \\(p_{\\mathrm{FM}} = \\frac14\\) if she passes on the \\(\\text X^*\\), or \\(p_{\\mathrm{Ff}} = p_{\\mathrm{Fm}} = \\frac14\\) if not. From a male haemophiliac, \\(p_{\\mathrm{MF}} = \\frac12\\) if he passes on the \\(\\text X^*\\), or \\(p_{\\mathrm{Mm}} = \\frac12\\) if not. From those without the \\(\\text X^*\\), we have \\(p_{\\mathrm{ff}} = p_{\\mathrm{fm}} = p_{\\mathrm{mf}} =p_{\\mathrm{mm}} = \\frac12\\). Figure 12.2: Transition diagram for Question 2. (b) What are the communicating classes in the chain? Is each class positive recurrent, null recurrent, or transient? Solution. Note we can move from F or M to f or m but not back again. So the class \\(\\{\\text F, \\text M\\}\\) is non-closed and thus transient, while the class \\(\\{\\text f, \\text m\\}\\) is closed and thus positive recurrent. (c) Calculate a stationary distribution. Is this the only stationary distribution? Solution. We have a stationary distribution is \\(\\pi_{\\mathrm M} = \\pi_{\\mathrm{F}} = 0\\), \\(\\pi_{\\mathrm m} = \\pi_{\\mathrm f} = \\frac12\\). One way to see this is to solve \\(\\boldsymbol\\pi = \\boldsymbol\\pi\\mathsf P\\). Another way is the following: Since F and M are transient we must have \\(\\pi_{\\mathrm M} = \\pi_{\\mathrm{F}} = 0\\). But, within the recurrent class, m and f are symmetrical, so we must have \\(\\pi_{\\mathrm m} = \\pi_{\\mathrm f}\\). The result follows. Since there is exactly one positive recurrent class, the stationary distribution is unique. (d) Under this model, what is the limiting probability that, in many generations’ time, a child has haemophilia? Solution. Since M and F are transient states, we have \\(\\lim \\mathbb P(X_n = \\mathrm F) = \\lim \\mathbb P(X_n = \\mathrm M) = 0\\), so the limiting probability is \\(0\\). 3. An airline operates a frequent flyer scheme with four classes of membership; Ordinary, Bronze, Silver and Gold. Scheme members get benefits according to their membership class. Changing membership class operates as follows: If a member books two or more flights in a given year, they are moved up a class of membership for the next year (or remain at Gold). If a member books a single flight, they remain in their current class in the following year. If a member books no flights, they move down a class (or remain at Ordinary). The airline’s research has shown that in a given year 40% of members book no flights, 40% book exactly one flight and the remaining 20% book two or more flights, independent of their history. Moreover, the cost of running the scheme per member is estimated as £0 for Ordinary members, £10 for Bronze members, £20 for Silver members, and £30 for Gold members. (a) Show that this system can be modelled using a Markov chain. Write down the transition probabilities and draw a transition diagram. Solution. We write \\(\\mathcal S = \\{\\text{O},\\text{B},\\text{S},\\text{G}\\}\\) for the set of states, and let \\(X_n\\) be the membership level in year \\(n\\). Next year’s membership level depends on this year’s, but not, given this year’s, on the previous history, so we have the Markov property. With probability \\(40\\%\\), a member books no flights, giving \\[ p_{\\mathrm{BO}} = p_{\\mathrm{SB}} = p_{\\mathrm{GG}} = 0.4 . \\] With probability \\(40\\%\\), a member books one flights, giving \\[ p_{\\mathrm{BB}} = p_{\\mathrm{SS}} = 0.4 \\] and \\(p_{\\mathrm{OO}} = 0.4+0.4 = 0.8\\). With probability \\(20\\%\\), a member books two or more flights, giving \\[ p_{\\mathrm{OB}} = p_{\\mathrm{BS}} = p_{\\mathrm{SG}} = 0.2 \\] and \\(p_{\\mathrm{GG}} = 0.4+0.2 = 0.6\\). Figure 12.3: Transition diagram for Question 3. (b) Explain why a unique stationary distribution exists and calculate it. Solution. The Markov chain is irreducible and positive recurrent, so has a unique stationary distribution. The equations from \\(\\boldsymbol\\pi = \\boldsymbol\\pi \\mathsf P\\) are \\[\\begin{align} \\pi_{\\mathrm O} &amp;= 0.8 \\pi_{\\mathrm O} + 0.4 \\pi_{\\mathrm B } \\\\ \\pi_{\\mathrm B} &amp;= 0.2\\pi_{\\mathrm O} + 0.4\\pi_{\\mathrm B} + 0.4\\pi_{\\mathrm S} \\\\ \\pi_{\\mathrm S} &amp;= \\phantom{0.2 \\pi_{\\mathrm S} +} 0.2 \\pi_{\\mathrm B} + 0.4 \\pi_{\\mathrm S} + 0.4 \\pi_{\\mathrm G} \\\\ \\pi_{\\mathrm G} &amp;= \\phantom{0.2 \\pi_{\\mathrm S} + 0.2 \\pi_{\\mathrm B} +} 0.2 \\pi_{\\mathrm S} + 0.6 \\pi_{\\mathrm G} . \\end{align}\\] We will choose \\(\\pi_{\\mathrm B}\\) as the working variable and discard the last equation. Rearranging the other three equations gives \\[\\begin{align*} \\pi_{\\mathrm O} \\phantom{{}+ 2\\pi_{\\mathrm S} - 2\\pi_{\\mathrm G}} &amp;= 2\\pi_{\\mathrm B} \\\\ \\pi_{\\mathrm O} + 2\\pi_{\\mathrm S} \\phantom{{}- 2\\pi_{\\mathrm G}} &amp;= 3\\pi_{\\mathrm B} \\\\ 3\\pi_{\\mathrm S} - 2\\pi_{\\mathrm G} &amp;= \\pi_{\\mathrm B} \\end{align*}\\] Substituting the first of these into the second and rearranging gives \\(\\pi_{\\mathrm S} = \\frac12 \\pi_{\\mathrm B}\\). Substituting this into the third and rearranging gives \\(\\pi_{\\mathrm S} = \\frac14 \\pi_{\\mathrm B}\\) The normalising condition is \\[ \\pi_{\\mathrm O} + \\pi_{\\mathrm B} + \\pi_{\\mathrm S} + \\pi_{\\mathrm G} = \\left(2 + 1 + \\tfrac12 + \\tfrac14 \\right)\\pi_{\\mathrm B} = \\tfrac{15}{4} \\pi_{\\mathrm B} = 1 . \\] Hence \\(\\pi_{\\mathrm B} = \\frac{4}{15}\\). Back-solving, we get the solution \\[ \\left(\\pi_{\\mathrm O},\\pi_{\\mathrm B},\\pi_{\\mathrm S},\\pi_{\\mathrm G}\\right) = \\left(\\tfrac8{15},\\tfrac{4}{15},\\tfrac{2}{15},\\tfrac{1}{15} \\right) . \\] (c) The airline makes a profit of £10 per passenger per flight, before the cost of the frequent flyer scheme. In the long run, does the airline expect to remain in profit after the cost of the scheme? Solution. By the ergodic theorem, the long run time spent in state \\(x\\) is \\(\\pi_x\\). So the long-run cost per member is \\[ 0\\pi_{\\mathrm O} + 10\\pi_{\\mathrm B} + 20 \\pi_{\\mathrm S} + 30\\pi_{\\mathrm G} = 0 \\cdot\\tfrac8{15} + 10\\cdot\\tfrac{4}{15} + 20\\cdot\\tfrac{2}{15} + 30 \\cdot \\tfrac{1}{15} = \\tfrac{110}{15} = \\tfrac{22}{3} , \\] for a cost of 7.33. The average number of flights taken per member is at least \\[ 0.4\\times 0 + 0.4 \\times 1 + 0.2\\times 2 = 0.8 , \\] for a profit of at least \\(10\\times0.8 = \\text{\\pounds}8\\). (“At least” because the probability \\(0.2\\) refers to “two or more” flights.) Since \\(8 &gt;7.33\\), the airline will make a profit in the long run. 4. We have \\(N\\) balls, each of which is placed into one of two urns. At each time step, a ball is chosen uniformly at random and moved to the other urn. (a) Show that the stationary probability the first urn contains \\(i\\) balls is \\[ \\frac{1}{2^N} \\binom{N}{i} . \\] Solution. One way to solve this is to let \\(X_n\\) be the number of balls in the first urn after having moved \\(n\\) balls. This has transition probabilities \\[ p_{i,i+1} = 1 - \\frac{i}{N} \\qquad p_{i,i-1} = \\frac{i}{N} . \\] The equations for the stationary distribution are \\[ \\pi_i = \\left(1 - \\frac{i-1}{N}\\right)\\pi_{i-1} + \\frac{i+1}N \\pi_{i+1} . \\] One can check that \\(\\pi_i = C \\binom{N}{i}\\) satisfies this for any constant \\(C\\) by using the combinatorial identities \\[\\begin{align*} \\left(1 - \\frac{i-1}{N}\\right)\\binom{N}{i-1} &amp;= \\binom{N-1}{i-1} \\\\ \\frac{i+1}N \\binom{N}{i+1} &amp;= \\binom{N-1}{i} \\\\ \\binom{N-1}{i-1} + \\binom{N-1}{i} &amp;= \\binom Ni , \\end{align*}\\] and check that the normalising condition demands \\(C = 1/2^N\\) because of \\[ \\sum_{i=0}^N \\binom Ni = 2^N . \\] The following is perhaps a better way. Let \\(Y_n^j = 1\\) denote that ball \\(j\\) is in the first urn at time \\(n\\), and \\(Y_n^j = 2\\) denote that it is in the second urn. Let \\(\\mathbf Y_n = (Y_n^1, Y_n^2, \\dots, Y_n^N)\\). Then \\((\\mathbf Y_n)\\) is a Markov chain on the state space \\(\\mathcal S = \\{1,2\\}^N\\). The transition probabilities are that \\(p_{\\mathbf{yz}} = 1/N\\) for any \\(\\mathbf y, \\mathbf z \\in \\mathcal S\\) that differ in exactly one of the \\(N\\) coordinates. Because of the symmetry, it’s clear that we have a stationary distribution \\(\\boldsymbol\\phi = (\\phi_{\\mathbf y})\\) where \\(\\phi_{\\mathbf y} = 1/|\\mathcal S| = 1/2^N\\) for all \\(\\mathbf y \\in \\mathcal S\\). Since the Markov chain is irreducible and positive recurrent, this is the only stationary distribution. Hence the stationary probability the first urn contains \\(i\\) balls is \\[ \\sum_{\\mathbf y \\in \\mathcal S(i)} \\phi_{\\mathbf y} = \\big|\\mathcal S(i)\\big|\\, \\frac{1}{2^N} = \\binom{N}{i} \\frac 1{2^N} , \\] where \\(\\mathcal S(i)\\) is the set of \\(\\mathbf y \\in \\mathcal S\\) consisting of \\(i\\) \\(1\\)s and \\(N-i\\) \\(2\\)s. (b) Is this an equilibrium distribution? Solution. No. The number of balls in the left-hand urn switches between odd and even each turn, so the chain is periodic with period 2, and does not have an equilibrium distribution. (c) In the long run, for what proportion of time are all of the balls in the same urn? Solution. By the ergodic theorem, the long run proportion of time that all the balls are in the same urn is \\[ \\pi_0 + \\pi_N = \\phi_{(1,1,\\dots,1)} + \\phi_{(2,2,\\dots,2)} = \\frac{1}{2^N} + \\frac{1}{2^N} = \\frac{1}{2^{N-1}} . \\] "],["A3.html", "Assessment 3", " Assessment 3 This assessment counts as 4% of your final module grade. You should attempt both questions. You must show your working, and there are marks for the quality of your mathematical writing. The deadline for submission is Thursday 25 March at 2pm. Submission will be to Gradescope via Minerva, from Monday 21 March. It would be helpful to start your solution to Question 2 on a new page. If you hand-write your solutions and scan them using your phone, please convert to PDF using a scanning app (I like Microsoft Office Lens or Adobe Scan) rather than submit images. Late submissions up to Wednesday 31 March at 2pm will still be marked, but the total mark will be reduced by 10% per day or part-day for which the work is late. Submissions are not permitted after Wednesday 31 March. Your solutions to this assessment should be your own work. Copying, collaboration or plagiarism are not permitted. Asking others to do your work, including via the internet, is not permitted. Transgressions are considered to be a very serious matter, and will be dealt with according to the University’s disciplinary procedures. 1. A firm rents out cars and operates from three locations – the Airport, the Beach and the City. Customers may return vehicles to any of the three locations. The company estimates that the probability of a car being returned to each location is as follows: Figure 12.4: Table of car-hire data. (a) A car is currently parked at the beach. What is the probability that, after being hired twice, it ends up at the airport? [2 marks] (b) A car is parked in the city. On average, how many times will it need to be hired until it is left at the beach? [2] (c) The firm has been running for many years with a fleet of 25 cars, of which 7 are currently on hire. How many of the other cars would you expect to be parked at each of the three locations? Explain your answer clearly. [4] 2. Consider a Markov chain \\((X_n)\\) with state space \\(\\mathcal S = \\{1,2,3,4,5\\}\\) and transition matrix \\[ \\mathsf P = \\begin{pmatrix} 0.2 &amp; 0.8 &amp; 0 &amp; 0 &amp; 0 \\\\ 0.4 &amp; 0.6 &amp; 0 &amp; 0 &amp; 0 \\\\ 0.2 &amp; 0.1 &amp; 0.2 &amp; 0.5 &amp; 0 \\\\ 0 &amp; 0 &amp; 0 &amp; 0.4 &amp; 0.6 \\\\ 0 &amp; 0 &amp; 0 &amp; 0.8 &amp; 0.2 \\end{pmatrix}. \\] (a) What are the communicating classes in the Markov chain? State, giving brief reasons, whether each class is positive recurrent, null recurrent, or transient. [3] (b) Calculate the hitting probability \\(h_{34}\\). [2] (c) Find two different stationary distributions for this Markov chain. [3] (d) What is the limit as \\(n \\to \\infty\\) of the \\(n\\)-step transition matrix \\(\\mathsf P(n)\\)? Explain your answer. [4] "],["S13-poisson-poisson.html", "Section 13 Poisson process with Poisson increments 13.1 Poisson distribution 13.2 Definition 1: Poisson increments 13.3 Summed and marked Poisson processes", " Section 13 Poisson process with Poisson increments Reminder: the Poisson distribution The Poisson process has independent Poisson increments Summed and marked Poisson processes 13.1 Poisson distribution In the next three sections we’ll be considering the Poisson process, a continuous time discrete space process with the Markov property. Given its name, it’s not surprising to hear the Poisson process is related to the Poisson distribution. Let’s start with a reminder of that. Recall that a discrete random variable \\(X\\) has a Poisson distribution with rate \\(\\lambda\\), written \\(X \\sim \\operatorname{Po}(\\lambda)\\), if its probability mass function is \\[ \\mathbb P(X = n) = \\mathrm{e}^{-\\lambda} \\frac{\\lambda^n}{n!} \\qquad n = 0,1,2,\\dots. \\] The Poisson distribution is often used to model the number of “arrivals” in a fixed amount of time – for example, the number of calls to a call centre in one hour, the number of claims to an insurance company in one year, or the number of particles decaying from a large amount of radioactive material in one second. The Poisson distribution is named after the French mathematician and physicist Siméon Denis Poisson, who studied it in 1837, although it was used by another French mathematician, Abraham de Moivre, more than 100 years earlier. Recall the following facts about of the Poisson distribution: Its expectation is \\(\\mathbb EX = \\lambda\\) and the variance is \\(\\operatorname{Var}(X) = \\lambda\\). If \\(X \\sim \\operatorname{Po}(\\lambda)\\) and \\(Y \\sim \\operatorname{Po}(\\mu)\\) are independent, then \\(X + Y \\sim \\operatorname{Po}(\\lambda+\\mu)\\). Let \\(X \\sim \\operatorname{Po}(\\lambda)\\) represent some arrivals, and independently “mark” each arrival with probability \\(p\\). Then the number of marked arrivals \\(Y\\) has distribution \\(Y = \\operatorname{Po}(p\\lambda)\\), the number of unmarked arrivals \\(Z\\) has distribution \\(Z \\sim \\operatorname{Po}((1-p)\\lambda)\\), and \\(Y\\) and \\(Z\\) are independent. (I say “recall”, but it’s OK if the third one is new to you.) 13.2 Definition 1: Poisson increments Suppose that, instead of just modelling the number of arrivals in a fixed amount of time, we want to continually model the total number of arrivals as it changes over time. This will be a stochastic process with discrete state space \\(\\mathcal S = \\mathbb Z_+ = \\{0,1,2,\\dots\\}\\) and continuous time \\(\\mathbb R_+ = [0,\\infty)\\). In continuous time, we will normally write stochastic processes as \\((X(t))\\), with the time variable being a \\(t\\) in brackets, rather than a subscript \\(n\\) as we had in discrete time. Suppose calls arrive at a call centre at a rate of \\(\\lambda = 100\\) an hour. The following assumptions seem reasonable: We begin counting with \\(X(0) = 0\\) calls. The number of calls in the first hour is \\(X(1) \\sim \\operatorname{Po}(100)\\). The number of calls in the second hour \\(X(2) - X(1)\\) will also be \\(\\operatorname{Po}(100)\\), and will be independent of the number of calls in the first hour. The number of calls in a two hour period will be \\(X(t+2) - X(t) \\sim \\operatorname{Po}(200)\\), while the number of calls in a half-hour period will be \\(X(t+\\frac12) - X(t) \\sim \\operatorname{Po}(50)\\). These properties will define the Poisson process. Definition 13.1 The Poisson process with rate \\(\\lambda\\) is defined as followed. It is a stochastic process \\((X(t))\\) with continuous time \\(t \\in [0,\\infty)\\) and discrete state space \\(\\mathcal S = \\mathbb Z_+\\) with the following properties: \\(X(0) = 0\\); Poisson increments: \\(X(t+s) - X(t) \\sim \\operatorname{Po}(\\lambda s)\\) for all \\(s,t&gt;0\\); independent increments: \\(X(t_2) - X(t_1)\\) and \\(X(t_4) - X(t_3)\\) are independent for all \\(t_1 \\leq t_2 \\leq t_3 \\leq t_4\\). Note that the condition \\(t_1 \\leq t_2 \\leq t_3 \\leq t_4\\) means that the time interval from \\(t_1\\) to \\(t_2\\) and the time interval from \\(t_3\\) to \\(t_4\\) don’t overlap. (Overlapping time intervals will not have independent increments, as arrivals in the overlap will count for both.) The Poisson process was discovered in the first decade 20th century, and the process was named after the distribution. Many people were working on similar things, so it’s difficult to say who discovered it first, but important work was done by the Swedish actuary and mathematician Filip Lundberg and the Danish engineer and mathematician AK Erlang. Example 13.1 Claims arrive at insurance company at a rate of \\(\\lambda = 8\\) per hour, modelled as a Poisson process. What is the probability there are no claims in a given \\(15\\) minute period? By property 2, the number of claims in \\(15\\) minutes is a Poisson distribution with mean \\(\\frac{15}{60}\\lambda = 2\\). The probability there are no claims is \\[ \\mathrm{e}^{-2} \\frac{2^0}{0!} = \\mathrm{e}^{-2} = 0.135 . \\] Example 13.2 A professor receives visitors to her office at a rate of \\(\\lambda = 2.5\\) per day, modelled as a Poisson process. What is the probability she gets at least one visitor every day this (5-day) week? The probability she gets at least one visitor on any given day is \\[ 1 - \\mathrm{e}^{-2.5} \\frac{2.5^0}{0!} = 1 - \\mathrm{e}^{-2.5} = 0.918. \\] By property 3, the numbers of visitors on different days are independent, so the probability of getting at least one visitor each day this week is \\(0.918^5 = 0.652\\). 13.3 Summed and marked Poisson processes The following theorem shows that the sum of two Poisson processes is itself a Poisson process. Theorem 13.1 Let \\((X(t))\\) and \\((Y(t))\\) be independent Poisson processes with rates \\(\\lambda\\) and \\(\\mu\\) respectively. Then the process \\((Z(t))\\) given by \\(Z(t) = X(t) + Y(t)\\) is a Poisson process with rate \\(\\lambda+\\mu\\). Proof. The proof of this is a question on Problem Sheet 7. Example 13.3 A student receives email to her university mail address at a rate of \\(\\lambda = 4\\) emails per hour, and to her personal email address at a rate of \\(\\mu = 2\\) per hour. Using a Poisson process model, what is the probability the student receives 3 or fewer emails in a 30 minute period? The total number of emails is a sum of Poisson processes with rate \\(\\lambda + \\mu = 6\\). The total number of emails received in half an hour is Poisson with rate \\((\\lambda + \\mu)/2 = 3\\). Thus the probability that 3 or fewer emails are received is \\[ \\mathrm{e}^{-3} \\frac{3^0}{0!} + \\mathrm{e}^{-3} \\frac{3^1}{1!} + \\mathrm{e}^{-3} \\frac{3^2}{2!} + \\mathrm{e}^{-3} \\frac{3^3}{3!} = 13\\mathrm{e}^{-3} = 0.647 . \\] We also have the marked Poisson process, which can be thought of as the opposite to the summed process: the summed process combines two processes together, while the marked process splits one process into two. Theorem 13.2 Let \\((X(t))\\) be a Poisson process with rate \\(\\lambda\\). Each arrival is independently marked with probability \\(p\\). Then the marked process \\((Y(t))\\) is a Poisson process with rate \\(p\\lambda\\), the unmarked process \\((Z(t))\\) is a Poisson process with rate \\((1-p)\\lambda\\), and \\((Y(t))\\) and \\((Z(t))\\) are independent. Proof. Given the third fact that you were “reminded” of, it’s easy to check the necessary properties. Example 13.4 In the 2019/20 English Premier League football season, an average of \\(\\lambda = 2.72\\) goals were scored per game, with a proportion \\(p = 0.56\\) of them scored by the home team. If we model this as a Poisson process, what is the probability a match ends in a 1–1 draw? The number of home goals scored is Poisson with rate \\(p\\lambda = 0.56\\times 2.72 = 1.52\\), and the number of away goals scored is Poisson with rate \\((1-p)\\lambda = 1.20\\). Under the Poisson process assumption, these are independent, so the probability the home and the away team both score \\(1\\) goal is \\[ \\mathrm{e}^{-1.52} \\frac{1.52^1}{1!} \\times \\mathrm{e}^{-1.20} \\frac{1.20^1}{1!} = 1.52\\mathrm{e}^{-1.52} \\times 1.20 \\mathrm{e}^{-1.20} = 0.12, \\] or 12%. In the next section, we look at the Poisson process in a different way: the times in between arrivals have an exponential distribution. "],["S14-poisson-exponential.html", "Section 14 Poisson process with exponential holding times 14.1 Exponential distribution 14.2 Definition 2: exponential holding times 14.3 Markov property in continuous time", " Section 14 Poisson process with exponential holding times Reminder: the exponential distribution The Poisson process has exponential holding times The Markov property in continuous time 14.1 Exponential distribution Last time, we introduced the Poisson process by looking at the random number of arrivals in fixed amount of time, which follows a Poisson distribution. Another way of looking at the Poisson process is to look at the random amount of of time required for a fixed number of arrivals. For this, we’ll need the exponential distribution. We start by recalling the exponential distribution. Recall that we say a continuous random variable \\(T\\) has the exponential distribution with rate \\(\\lambda\\), and write \\(T \\sim \\operatorname{Exp}(\\lambda)\\), if it has the probability distribution function \\(f(t) = \\lambda \\mathrm{e}^{-\\lambda t}\\) for \\(t \\geq 0\\). Exponential distributions are often used to model “waiting times” – for example, the amount of time until a light bulb breaks, the times between buses arriving, or the time between withdrawals from a bank account. You are reminded of the following facts about the exponential distribution: The cumulative distribution function is \\(F(t) = \\mathbb P(T \\leq t) = 1 - \\mathrm{e}^{-\\lambda t}\\); although it is usually more convenient to deal with the tail probability \\(\\mathbb P(T &gt; t) = 1 - F(t) = \\mathrm{e}^{-\\lambda t}\\). The expectation is \\(\\mathbb E T = 1/\\lambda\\) and the variance is \\(\\operatorname{Var}(T) = 1/\\lambda^2\\). The following memoryless property will of course be important in a course about memoryless Markov processes. Theorem 14.1 Let \\(T \\sim \\operatorname{Exp}(\\lambda)\\). Then, for any \\(s,t\\geq0\\), \\[ \\mathbb P(T &gt; t + s \\mid T &gt; t) = \\mathbb P(T &gt; s) . \\] Suppose we are waiting an exponentially distributed time for an alarm to go off. No matter how long we’ve been waiting for, the remaining time to wait is still exponentially distributed, with the same parameter – hence “memoryless”. Proof. By standard use of conditional probability, we have \\[ \\mathbb P(T &gt; t + s \\mid T &gt; t) = \\frac{\\mathbb P(T &gt; t + s \\text{ and } T &gt; t)}{\\mathbb P(T &gt; t)} = \\frac{\\mathbb P(T &gt; t + s)}{\\mathbb P(T &gt; t)} = \\frac{\\mathrm{e}^{-\\lambda(t+s)}}{\\mathrm{e}^{-\\lambda t}} = \\mathrm{e}^{-\\lambda s} , \\] which is still the tail probability of the exponential distribution. The following property will be important later on in the course. Theorem 14.2 Let \\(T_1 \\sim \\operatorname{Exp}(\\lambda_1)\\), \\(T_2 \\sim \\operatorname{Exp}(\\lambda_2)\\), \\(\\dots\\), \\(T_n \\sim \\operatorname{Exp}(\\lambda_n)\\) be independent exponential distributions, and let \\(T\\) be the minimum of the \\(T_i\\)s, so \\(T = \\min\\{T_1, T_2, \\dots, T_n \\}\\). Then \\[ T \\sim \\operatorname{Exp}(\\lambda_1 + \\lambda_2 + \\cdots + \\lambda_n) . \\] Further, the probability that \\(T_j\\) is the smallest of all the \\(T_i\\)s is \\[ \\mathbb P(T = T_j) = \\frac{\\lambda_j}{\\lambda_1 + \\lambda_2 + \\cdots + \\lambda_n} . \\] Proof. The proof of this is an question on Problem Sheet 7. 14.2 Definition 2: exponential holding times We mentioned before that exponential distributions are often used to model “waiting times”. When modelling a process \\((X(t))\\) counting many arrivals at rate \\(\\lambda\\), we might model the process like this: after waiting an \\(\\operatorname{Exp}(\\lambda)\\) amount of time, an arrival appears. After another \\(\\operatorname{Exp}(\\lambda)\\) amount of time, another arrival appears. And so on. We often use the term “holding time” to refer to the time between consecutive arrivals. This suggests a process with the following properties: We start with \\(X(0) = 0\\). Let \\(T_1, T_2, \\dots \\sim \\operatorname{Exp}(\\lambda)\\) be the holding times, all independent. Then \\[ X(t) = \\begin{cases} 0 &amp; \\text{for $0 \\leq t &lt; T_1$} \\\\ 1 &amp; \\text{for $T_1 \\leq t &lt; T_1 + T_2$} \\\\ 2 &amp; \\text{for $T_1+T_2 \\leq t &lt; T_1 + T_2 + T_3$} \\\\ \\text{and so on.} &amp; \\end{cases} \\] A process described like this is also the Poisson process! Figure 14.1: A Poisson process with exponentially distributed holding times. Theorem 14.3 Let \\((X(t))\\) be a Poisson process with rate \\(\\lambda\\), as defined by its independent Poisson increments (see Subsection 13.2). Then \\((X(t))\\) has the exponential holding times structure described above. Proof. Let \\((X(t))\\) be a Poisson process with rate \\(\\lambda\\). We seek the distribution of the first arrival time \\(T_1\\). We have \\[ \\mathbb P(T_1 &gt; t_1) = \\mathbb P\\big(X(t_1) - X(0) = 0\\big) = \\mathrm{e}^{-\\lambda t_1} \\frac{(\\lambda t_1)^0}{0!} = \\mathrm{e}^{-\\lambda t_1} , \\] since the arrival comes after \\(t_1\\) if there are no arrivals in the interval \\([0,t_1]\\). But this is precisely the tail probability of an exponential distribution with rate \\(\\lambda\\). Now consider the second holding time. We have \\[ \\mathbb P(T_2 &gt; t_2 \\mid T_1 = t_1) = \\mathbb P\\big(X(t_1 + t_2) - X(t_1) = 0\\big) = \\mathrm{e}^{-\\lambda ((t_1 + t_2) - t_1)} = \\mathrm{e}^{-\\lambda t_2} \\] by the same argument as before. This is the tail distribution for another \\(\\operatorname{Exp}(\\lambda)\\) distribution, independent of \\(T_1\\). Repeating this argument for all \\(n\\) gives the desired exponential holding time structure. Example 14.1 Customers visit a second-hand bookshop at a rate of \\(\\lambda = 5\\) per hour. Each customer a book with probability \\(p = 0.4\\). What is the expected time to make ten sales, and what is the standard deviation? The count of books sold marked Poisson process, which we saw last time is itself a Poisson process with rate \\(p\\lambda = 2\\). The expected time of the tenth sale is \\[ \\mathbb E(T_1 + \\dots + T_{10}) = 10\\,\\mathbb ET_1 = 10 \\times \\tfrac{1}{2} = 5 \\text{ hours} .\\] The variance is \\[ \\operatorname{Var}(T_1 + \\dots + T_{10}) = 10\\,\\operatorname{Var}(T_1) = 10 \\times \\frac{1}{2^2} = 2.5 , \\] where we used that the holding times are independent and identically distributed, so the standard deviation is \\(\\sqrt{2.5} = 1.58\\) hours. What is the probability it takes more than an hour to sell the first book? This is the probability the first holding time is longer than an hour, which is the tail of the exponentital distribution, \\[ \\mathbb P(T_1 &gt; 1) = \\mathrm{e}^{-2\\times 1} = \\mathrm{e}^{-2} = 0.135. \\] An alternative way to solve this would be to say that the first book is is sold later than 1 hour in if \\(X(1) = 0\\). So using the Poisson increments definition from last time, we have \\[ \\mathbb P\\big(X(1) = 0\\big) = \\mathrm{e}^{-2\\times 1} \\frac{(2\\times 1)^0}{0!} = \\mathrm{e}^{-2} = 0.135. \\] We get the same answer either way. 14.3 Markov property in continuous time We previously saw the Markov “memoryless” property in discrete time. The equivalent definition in continuous time is the following. Definition 14.1 Let \\((X(t))\\) be a stochastic process on a discrete state space \\(\\mathcal S\\) and continuous time \\(t \\in [0,\\infty)\\). We say that \\((X(t))\\) has the Markov property if \\[\\begin{multline*} \\mathbb P\\big( X(t_{n+1}) = x_{n+1} \\mid X(t_n) = x_n, \\dots, X(t_1) = x_1, X(t_0) = x_0 \\big) \\\\ = \\mathbb P\\big( X(t_{n+1}) = x_{n+1} \\mid X(t_n) = x_{n}\\big) \\end{multline*}\\] for all times \\(t_0 &lt; t_1 &lt; \\cdots &lt; t_n &lt; t_{n+1}\\) and all states \\(x_0, x_1, \\dots, x_n, x_{n+1} \\in \\mathcal S\\). In other words, the state of the process at some point \\(t_{n+1}\\) in the future depends on where we are now \\(t_n\\), but, given that, does not depend on any collection of previous times \\(t_0, t_1, \\dots, t_{n-1}\\). The Poisson process does indeed have the Markov property, since, by the property of independent increments, we have that \\[ \\mathbb P\\big( X(t_{n+1}) = x_{n+1} \\mid X(t_n) = x_n, \\dots, X(t_0) = x_0 \\big) = \\mathbb P\\big( X(t_{n+1}) -X(t_n) = x\\big) , \\] where \\(x = x_{n+1}-x_n\\). By Poisson increments, this has probability \\[ \\mathrm{e}^{-\\lambda(t_{n+1}-t_n)} \\frac{\\big(\\lambda(t_{n+1}-t_n)\\big)^x}{x!} . \\] Alternatively, by the memoryless property of the exponential distribution, we see that we can restart the holding time from \\(t_n\\) and still have this and all future holding times exponentially distributed. In the next section, we look at the Poisson process in a third way, by looking at what happens in a very small time period. "],["P07.html", "Problem sheet 7", " Problem sheet 7 .fold-btn { float: right; margin: -12px 0 0 0; } You should attempt all these questions and write up your solutions in advance of your workshop in week 8 (Monday 15 or Tuesday 16 March) where the answers will be discussed. 1. Let \\((X(t))\\) be a Poisson process with rate \\(\\lambda = 5\\). Calculate: (a) \\(\\mathbb P\\big(X(0.4) \\leq 2\\big)\\); Solution. We have that \\(X(0.4) \\sim \\text{Po}(2)\\), so \\[ \\mathbb P\\big(X(0.4) \\leq 2\\big) = \\mathrm{e}^{-2} + 2\\mathrm{e}^{-2} + \\frac{2^2}{2} \\mathrm{e}^{-2} = 5 \\mathrm{e}^{-2} = 0.677 .\\] (b) \\(\\mathbb EX(6.4)\\); Solution. We have that \\(X(6.4) \\sim \\text{Po}(32)\\), so \\(\\mathbb E X(6.4) = 32\\). (c) \\(\\mathbb P\\big(X(0.5) = 0 \\text{ and } X(1) = 1\\big)\\). Solution. This happens if we have \\(X(0.5) - X(0) = 0\\) and also the independent event \\(X(1) - X(0.5) = 1\\). Both increments are \\(\\text{Po}(2.5)\\), so \\[\\mathbb P\\big(X(0.5) = 0 \\text{ and } X(1) = 1\\big) = \\mathrm{e}^{-2.5} \\times 2.5\\mathrm{e}^{-2.5} = 0.0168. \\] Let \\(T_n\\) be the \\(n\\)th holding time, and let \\(J_n = T_1 + \\cdots + T_n\\) be the \\(n\\)th arrival time. Calculate: (d) \\(\\mathbb P(0.1 \\leq T_2 &lt; 0.3)\\); Solution. We have \\(T_2 \\sim \\text{Exp}(5)\\), so \\[\\begin{multline*} \\mathbb P(0.1 \\leq T_2 &lt; 0.3) = \\mathbb P(T_2 &gt; 0.1) - \\mathbb P(T_2 &gt; 0.3) \\\\= \\mathrm{e}^{-5\\times0.1} - \\mathrm{e}^{-5\\times0.3} = \\mathrm{e}^{-0.5} - \\mathrm{e}^{-1.5} = 0.383. \\end{multline*}\\] (e) \\(\\mathbb E J_{100}\\); Solution. \\[ \\mathbb E J_{100} = \\mathbb E (T_1 + \\dots + T_{100}) = 100 \\, \\mathbb ET_1 = 100 \\times \\tfrac15 = 20. \\] (f) \\(\\operatorname{Var}(J_{100})\\). Solution. Using independence, \\[ \\operatorname{Var}( J_{100}) = \\operatorname{Var}E (T_1 + \\dots + T_{100}) = 100 \\, \\operatorname{Var}(T_1) = 100 \\times \\tfrac1{5^2} = 4. \\] (g) Using a normal approximation, approximate \\(\\mathbb P(18 \\leq J_{100} \\leq 22)\\). Solution. The normal approximation is \\(J_{100} \\sim \\mathrm N(20,4)\\). So, letting \\(Z \\sim \\text{N}(0,1)\\), we have \\[\\begin{multline*} \\mathbb P(18 \\leq J_{100} \\leq 22) = \\mathbb P\\left(\\frac{18-20}{\\sqrt4} \\leq Z \\leq \\frac{18-20}{\\sqrt4}\\right) \\\\ = \\mathbb P(-1 \\leq Z \\leq 1) = 2\\Phi(1) - 1 = 0.683. \\end{multline*}\\] 2. Suppose that telephone calls arrive at a call centre according to a Poisson process with rate \\(\\lambda = 100\\) per hour, and are answered with probability \\(0.6\\). (a) What is the probability that there are no answered calls in the next minute? Solution. The answered calls form a Poisson process with rate \\(100 \\times 0.6 = 60\\) per hour, or \\(1\\) per minute. The probability there are no unanswered calls in one minute are \\(\\mathrm{e}^{-1} = 0.368\\). (b) Use a suitable normal approximation, with a continuity correction, to find the probability that there will be at least \\(25\\) answered calls in the next \\(30\\) minutes. Solution. The number of calls in \\(30\\) minutes is Poisson of rate \\(30\\), which has expectation \\(30\\) and variance \\(30\\). So, using a continuity correction, we have \\[\\begin{multline} \\mathbb P \\big(X(30) \\geq 24.5 \\big) = \\mathbb P \\left( Z \\geq \\frac{24.5 - 30}{\\sqrt{30}} \\right) \\\\= \\mathbb P(Z \\geq -1.00 ) = \\Phi(1.00) = 0.842 . \\end{multline}\\] 3. (a) Let \\(X \\sim \\text{Po}(\\lambda)\\) and \\(Y \\sim \\text{Po}(\\mu)\\) be two independent Poisson distributions. Show that \\(X + Y \\sim \\text{Po}(\\lambda + \\mu)\\). One way to start would be to write \\[ \\mathbb P(X+Y = z) = \\sum_{x=0}^z \\mathbb P(X = x) \\, \\mathbb P(Y = z-x) . \\] Solution. The most direct method is to use the hint in the question. We have \\[\\begin{align*} \\mathbb P(X+Y = z) &amp;= \\sum_{x=0}^z \\mathbb P(X = x) \\, \\mathbb P(Y = z-x) \\\\ &amp;= \\sum_{x=0}^z \\mathrm{e}^{-\\lambda} \\frac{\\lambda^x}{x!} \\mathrm{e}^{-\\mu} \\frac{\\mu^{z-x}}{(z-x)!} \\\\ &amp;= \\mathrm{e}^{-(\\lambda + \\mu)} \\sum_{x=0}^z \\frac{1}{x!(z-x)!} \\lambda^x \\mu^{z-x} \\\\ &amp;= \\mathrm{e}^{-(\\lambda + \\mu)} \\frac{1}{z!} \\sum_{x=0}^z \\frac{z!}{x!(z-x)!} \\lambda^x \\mu^{z-x} \\\\ &amp;= \\mathrm{e}^{-(\\lambda + \\mu)} \\frac{1}{z!} \\sum_{x=0}^z \\binom{z}{x} \\lambda^x \\mu^{z-x} . \\end{align*}\\] But the sum here is precisely \\[ (\\lambda + \\mu)^z = \\sum_{x=0}^z \\binom{z}{x} \\lambda^x \\mu^{z-x} , \\] so we have \\[ \\mathbb P(X+Y = z) = \\mathrm{e}^{-(\\lambda + \\mu)} \\frac{(\\lambda+\\mu)^z}{z!} , \\] as desired. Alternatively, if you know about probability generating functions (PGFs), it can be easier to use those. The PGF \\(G_X(s)\\) of a \\(\\operatorname{Po}(\\lambda)\\) distribution is \\[ G_X(s) = \\mathbb Es^X = \\sum_{x=0}^\\infty s^x \\mathrm{e}^{-\\lambda} \\frac{\\lambda^x}{x!} = \\mathrm{e}^{-\\lambda}\\sum_{x=0}^\\infty \\frac{(\\lambda s)^x}{x!} = \\mathrm{e}^{-\\lambda} \\mathrm{e}^{\\lambda s} = \\mathrm{e}^{\\lambda (s-1)} . \\] Generally, the PGF of an independent sum \\(Z = X+Y\\) is \\[ G_Z(s) = \\mathbb E s^{X+Y} = \\mathbb E s^{X}s^{Y} = \\big(\\mathbb Es^X\\big)\\big( \\mathbb Es^Y\\big) = G_X(s) G_Y(s) .\\] Here, that is \\[ G_Z(s) = G_X(s) G_Y(s) = \\mathrm{e}^{\\lambda (s-1)}\\mathrm{e}^{\\mu(s-1)} = \\mathrm{e}^{(\\lambda+\\mu) (s-1)} , \\] which is the PGF of a \\(\\operatorname{Po}(\\lambda + \\mu)\\) distribution, as desired. (b) Let \\((X(t))\\) and \\((Y(t))\\) be independent Poisson processes with rate \\(\\lambda\\) and \\(\\mu\\) respectively. Use part (a) to show that \\((X(t) + Y(t))\\) is a Poisson process with rate \\(\\lambda + \\mu\\). Solution. First, that \\(Z(0) = X(0) + Y(0) = 0 + 0 = 0\\) is immediate. Second, the previous result shows that \\((Z(t))\\) has independent Poisson increments with rate \\(\\lambda + \\mu\\). Third, since \\((X(t))\\) and \\((Y(t))\\) each have independent increments and are independent of each other, it follows that \\((Z(t))\\) has independent increments also. (c) Number 1 buses arrive at a bus stop at a rate of \\(\\lambda_1 = 4\\) per hour, and Number 6 buses arrive at the rate \\(\\lambda_6 = 2\\) per hour. I’ve been waiting at the bus stop for 5 minutes for either bus to arrive; how much longer do I have to wait, on average? Solution. By the above, the arrivals of buses form a Poisson process of rate \\(\\lambda_1 + \\lambda_6 = 6\\). By the memoryless property of the exponential distribution, the fact we have already been waiting for 5 minutes is irrelevant. The waiting time is \\(\\text{Exp}(6)\\), with mean \\(\\frac16\\) of an hour, or 10 minutes. 4. Let \\(T_1 \\sim \\operatorname{Exp}(\\lambda_1), T_2 \\sim \\operatorname{Exp}(\\lambda_2), \\dots, T_n \\sim \\operatorname{Exp}(\\lambda_n)\\) be independent exponential distributions, and let \\(T\\) be the minimum \\(T = \\min \\{T_1, T_2 \\dots, T_n\\}\\). (a) Show that \\(T \\sim \\operatorname{Exp}(\\lambda_1 + \\lambda_2 + \\cdots + \\lambda_n)\\). (You may use the fact that \\[ \\mathbb P(T &gt; t) = \\mathbb P(T_1 &gt; t) \\, \\mathbb P(T_2 &gt; t) \\cdots \\mathbb P(T_n &gt; t) , \\] provided you explain why it’s true.) Solution. For the minimum to be bigger than \\(t\\), we need all \\(n\\) of the times to be bigger than \\(t\\). Hence \\[\\begin{multline*} \\mathbb P(T &gt; t) = \\mathbb P(T_1 &gt; t) \\, \\mathbb P(T_2 &gt; t)\\cdots \\mathbb P(T_n &gt; t)\\\\ = \\mathrm{e}^{-\\lambda_1 t} \\mathrm{e}^{-\\lambda_2 t} \\cdots \\mathrm{e}^{-\\lambda_n t} = \\mathrm{e}^{-(\\lambda_1 + \\lambda_2 + \\cdots + \\lambda_n) t} . \\end{multline*}\\] But this is precisely the tail probability of an \\(\\operatorname{Exp}(\\lambda_1 + \\lambda_2 + \\cdots + \\lambda_n)\\) distribution. (b) Show that the probability that the minimum is \\(T_j\\) is given by \\[ \\mathbb P(T_j = T) = \\frac{\\lambda_j}{\\lambda_1 + \\lambda_2 + \\cdots + \\lambda_n} . \\] (You could choose to begin by proving the \\(n = 2\\) case, if you want.) Solution. By conditioning on the value of \\(T_j\\) and arguing as above, we have \\[ \\mathbb P(T_j = T) = \\int_0^\\infty f_{T_j}(t) \\, \\mathbb P(\\text{all other $T_k$s} \\geq t) \\, \\mathrm dt . \\] Using the result above and substituting in the PDF of an exponential distribution, we get \\[\\begin{align*} \\mathbb P(T_j = T) &amp;= \\int_0^\\infty \\lambda_j \\mathrm{e}^{-\\lambda_j t}\\, \\mathrm{e}^{-(\\lambda_1 + \\cdots + \\lambda_{j-1} + \\lambda_{j+1} + \\cdots + \\lambda_n)t} \\, \\mathrm dt \\\\ &amp;= \\lambda_j \\int_0^\\infty \\mathrm{e}^{-(\\lambda_1 + \\lambda_2 + \\cdots + \\lambda_n) t} \\, \\mathrm dt \\\\ &amp;= \\lambda_j \\left[ -\\frac{1}{\\lambda_1 + \\lambda_2 + \\cdots + \\lambda_n} \\mathrm{e}^{-(\\lambda_1 + \\lambda_2 + \\cdots + \\lambda_n) t} \\right]_0^\\infty \\\\ &amp;= \\lambda_j \\left(-0 - \\left(- \\frac{1}{\\lambda_1 + \\lambda_2 + \\cdots + \\lambda_n}\\right)\\right) \\\\ &amp;= \\frac{\\lambda_j}{\\lambda_1 + \\lambda_2 + \\cdots + \\lambda_n} . \\end{align*}\\] 5. Let \\((X(t))\\) be a Poisson process with rate \\(\\lambda\\). Conditional on there being exactly 1 arrival before time \\(t\\), find the distribution of the time of that arrival. Solution. Clearly the arrival is in the interval \\([0,t]\\). The conditional CDF is \\[\\begin{align*} \\mathbb P\\big(T_1 \\leq s \\mid X(t) = 1\\big) &amp;= \\frac{\\mathbb P\\big( T_1 \\leq s \\text{ and } X(t) = 1 \\big)}{\\mathbb P\\big(X(t) = 1 \\big)} %\\\\ % &amp;= \\frac{\\mathbb P( T_1 \\leq s \\text{ and } T_2 &gt; t-s )}{\\mathbb P\\big(X(t) = 1 \\big)} \\\\ % &amp;= \\frac{ (1 - \\ee^{-\\lambda s} ) \\ee^{-\\lambda(t-s)}{\\ee^{-\\lambda t}} \\\\ % &amp;= \\frac{ \\ee^{-\\lambda(t-s)} \\end{align*}\\] The denominator is \\(\\lambda t \\mathrm{e}^{-\\lambda t}\\). The numerator is \\[\\begin{align*} \\mathbb P\\big( T_1 \\leq s \\text{ and } X(t) = 1 \\big) &amp;= \\mathbb P\\big(X(s) = 1 \\text{ and } X(t) = 1 \\big) \\\\ &amp;= \\mathbb P \\big(X(s)-X(0) = 1\\big) \\, \\mathbb P\\big(X(t) - X(s) = 0\\big) \\\\ &amp;= \\lambda s \\mathrm{e}^{-\\lambda s} \\mathrm{e}^{\\lambda(t-s)} \\\\ &amp;= \\lambda s \\mathrm{e}^{-\\lambda t} . \\end{align*}\\] Putting this together, the conditional CDF is \\[ \\mathbb P\\big(T_1 \\leq s \\mid X(t) = 1\\big) = \\frac{\\lambda s \\mathrm{e}^{-\\lambda t}}{\\lambda t \\mathrm{e}^{-\\lambda t}} = \\frac{s}{t} . \\] This is precisely the CDF for the uniform distribution on \\([0,t]\\). "],["S15-poisson-infinitesimal.html", "Section 15 Poisson process in infinitesimal time periods 15.1 Definition 3: increments in infinitesimal time 15.2 Example: sum of two Poisson processes 15.3 Forward equations and proof of equivalence", " Section 15 Poisson process in infinitesimal time periods Poisson process in terms of increments in infinitesimal time Forward equations for the Poisson process 15.1 Definition 3: increments in infinitesimal time We have seen two definitions of the Poisson process so far: one in terms of increments having a Poisson distribution, and one in therms of holding times having an exponential distribution. Here we will see another definition, by looking at what happens in a very small time period of length \\(\\tau\\). Advantages of this approach include that does not require direct assumptions on the distributions involved, so may seem more “natural” or “inevitable”. It also shows links between Markov processes and differential equations. A disadvantage is that it’s normally easier to do calculations with the Poisson or exponential definitions. Let \\((X(t))\\) be a stochastic processes counting some arrivals over time. Consider the number of arrivals in a very small time period of length \\(\\tau\\); that number of arrivals is \\(X(t+\\tau) - X(t)\\). The following (seemingly) weak assumptions seem justified: It’s quite likely that there will be no arrivals in the very small time period. It is possible there will be one arrival, and that probability will be roughly proportional to the length \\(\\tau\\) of the time period. It’s extremely unlikely there will be two or more arrivals in such a short time period. To write this down formally in maths, we will consider \\(\\mathbb P(X(t+\\tau) - X(t) = j)\\) as the length \\(\\tau\\) of the time period tends to zero. It will be helpful for us to use “little-\\(o\\)” notation. Here \\(o(\\tau)\\) means a term that is of “lower order” compared to \\(\\tau\\). These are terms like \\(\\tau^2\\) or \\(\\tau^3\\) that are so tiny that we’re safe to ignore them. Formally, \\(o(\\tau)\\) stands for a function of \\(\\tau\\) that tends to \\(0\\) as \\(\\tau \\to 0\\) even when divided by \\(\\tau\\). That is, \\[ f(\\tau) = o(\\tau) \\qquad \\iff \\qquad \\frac{f(\\tau)}{\\tau} \\to 0 \\quad \\text{as $\\tau \\to 0$.} \\] Then our suggestions above translate to \\[\\begin{equation} \\mathbb P \\big(X(t+\\tau) - X(t) = j\\big) = \\begin{cases} 1 - \\lambda \\tau + o(\\tau) &amp; \\text{if $j = 0$,} \\\\ \\lambda\\tau + o(\\tau) &amp; \\text{if $j = 1$,} \\\\ o(\\tau) &amp; \\text{if $j \\geq 2$.} \\end{cases} \\tag{15.1} \\end{equation}\\] as \\(\\tau \\to 0\\). It turns out that we have once again defined the Poisson process with rate \\(\\lambda\\). Theorem 15.1 Let \\((X(t))\\) be a stochastic process with the following properties: \\(X(0) = 0\\); infinitesimal increments: \\(X(t+\\tau) - X(t)\\) has the structure in (15.1) above, as \\(\\tau \\to 0\\); independent increments: \\(X(t_2) - X(t_1)\\) and \\(X(t_4) - X(t_3)\\) are independent for all \\(t_1 \\leq t_2 \\leq t_3 \\leq t_4\\). Then \\((X(t))\\) is a Poisson process with rate \\(\\lambda\\). We will prove this in a moment. First let’s see an example of its use. 15.2 Example: sum of two Poisson processes We mentioned before the sum of two Poisson processes: that if \\((X(t))\\) is a Poisson process with rate \\(\\lambda\\) and \\((Y(t))\\) is an independent Poisson process with rate \\(\\mu\\), then the sum \\((Z(t))\\) where \\(Z(t) = X(t) + Y(t)\\) is a Poisson process with rate \\(\\lambda + \\mu\\). On Problem Sheet 7, Question 3, you proved this from the Poisson increments definition. But it’s perhaps even easier to prove using the infinitesimals definition. We have \\[\\begin{align*}\\mathbb P\\big( Z(t+\\tau) - Z(t) = 0 \\big) &amp;= \\mathbb P\\big( X(t+\\tau) - X(t) = 0 \\big) \\, \\mathbb P\\big( Y(t+\\tau) - Y(t) = 0 \\big) \\\\ &amp;=\\big(1 - \\lambda \\tau + o(\\tau) \\big)\\big(1 - \\mu \\tau + o(\\tau) \\big) \\\\ &amp;= 1 - (\\lambda + \\mu)\\tau + o(\\tau) , \\end{align*}\\] since \\(Z\\) does not increase provided neither \\(X\\) nor \\(Y\\) increases. We also have \\[\\begin{align*}\\mathbb P\\big( Z(t+{}&amp;\\tau) - Z(t) = 1 \\big) \\\\ &amp;= \\mathbb P\\big( X(t+\\tau) - X(t) = 1 \\big) \\, \\mathbb P\\big( Y(t+\\tau) - Y(t) = 0 \\big) \\\\ &amp;\\qquad {}+ \\mathbb P\\big( X(t+\\tau) - X(t) = 0 \\big) \\, \\mathbb P\\big( Y(t+\\tau) - Y(t) = 1 \\big) \\\\ &amp;= \\big(\\lambda \\tau + o(\\tau) \\big)\\big(1 - \\mu \\tau + o(\\tau) \\big) + \\big(1 - \\lambda \\tau + o(\\tau) \\big)\\big(\\mu \\tau + o(\\tau) \\big) \\\\ &amp;= (\\lambda + \\mu)\\tau + o(\\tau) , \\end{align*}\\] since \\(Z\\) increases by 1 if either \\(X\\) increases by 1 and \\(Y\\) stays fixed or vice versa. We used here that the probability that both \\(X\\) and \\(Y\\) increase is of order \\(\\tau^2 = o(\\tau)\\). Finally, since probabilities must add up to 1, we must have \\[ \\mathbb P\\big( Z(t+\\tau) - Z(t) \\geq 2 \\big) = o(\\tau) . \\] But what we have written down is precisely the infinitesimals definition of a Poisson process with rate \\(\\lambda + \\mu\\), so we are done. 15.3 Forward equations and proof of equivalence If we compare Theorem 15.1 to the definition of the Poisson process in terms of Poisson increments, we see that properties 1 and 3 are the same. We only need to check property 2, that \\(X(t+s) - X(s)\\) is a Poisson distribution with rate \\(\\lambda t\\). Since the increments as defined in (15.1) are time homogeneous, it will suffice to consider \\(s = 0\\). So we need to show that \\(X(t) \\sim \\text{Po}(\\lambda t)\\). Write \\(p_j(t) = \\mathbb P(X(t) = j)\\). Then for \\(j \\geq 1\\) we have \\[ p_j(t + \\tau) = \\big(1 - \\lambda\\tau + o(\\tau)\\big)p_j(t) + \\big(\\lambda\\tau + o(\\tau)\\big) p_{j-1}(t) + o(\\tau) , \\] since we get to \\(j\\) either by staying at \\(j\\) or by moving up from \\(j-1\\), with all other highly unlikely possibilities being absorbed into the \\(o(\\tau)\\). In order to deal with increments, it will be convenient to take a \\(p_{j}(t)\\) to the left-hand side and rearrange, to get the increment \\[ p_j(t + \\tau) - p_j(t) = -\\lambda\\tau p_j(t) + \\lambda\\tau p_{j-1}(\\tau) + o(\\tau) , \\] where “constant times \\(o(\\tau)\\)” is itself \\(o(\\tau)\\). The only way to deal with the \\(o(\\tau)\\) term, given its definition, is to divide everything by \\(\\tau\\) and send \\(\\tau \\to 0\\). Dividing by \\(\\tau\\) gives \\[ \\frac{p_j(t + \\tau) - p_j(t)}{\\tau} = -\\lambda p_j(t) + \\lambda p_{j-1}(t) + \\frac{o(\\tau)}{\\tau} . \\] Sending \\(\\tau\\) to 0, the term \\(o(\\tau)/\\tau\\) tends to 0 and vanishes, while we recognise the limit of the left-hand side as being the derivative \\(\\mathrm d p_j(t) / \\mathrm d t = p&#39;_j(t)\\). This leaves us with the differential equation \\[ p&#39;_j(t) = -\\lambda p_j(t) + \\lambda p_{j-1}(t) . \\] We also have the initial condition \\(p_j(0) = 0\\) for \\(j \\geq 1\\), since we start at 0, not at any \\(j \\geq 1\\). We have to deal with the case \\(j = 0\\) separately. This is similar but a bit easier. We have \\[ p_0(t + \\tau) = \\big(1 - \\lambda\\tau + o(\\tau)\\big)p_0(t) , \\] since we must previously been at 0, then seen no arrivals. After rearranging to get an increment and sending \\(\\tau \\to 0\\), as before, we get the differential equation \\[ p&#39;_0(t) = -\\lambda p_0(t) \\] with the initial condition \\(p_0(0) = 1\\), since we always start at 0. In summary, we have derived the following equations: \\[\\begin{align*} p&#39;_0(t) &amp;= -\\lambda p_0(t) &amp; p_0(0) &amp; = 1 ,\\\\ p&#39;_j(t) &amp;= -\\lambda p_j(t) + \\lambda p_{j-1}(t) &amp; p_j(0) &amp;= 0 \\quad \\text{for $j \\geq 1$} . \\end{align*}\\] These are called the Kolmogorov forward equations. We claim that the solution to these equations is the Poisson distribution \\[ p_j(t) = \\mathrm{e}^{-\\lambda t} \\frac{(\\lambda t)^j}{j!} . \\] This would prove the theorem. We must check that the claim holds. For \\(j = 0\\), the Poisson probability is \\[ p_0(t) = \\mathrm{e}^{-\\lambda t} \\frac{(\\lambda t)^0}{0!} = \\mathrm{e}^{-\\lambda t} . \\] This has \\[ p&#39;_0(t) = -\\lambda \\mathrm{e}^{-\\lambda t} = -\\lambda p_0(t) , \\] as desired, and we also have the correct initial condition \\(p_0(0) = \\mathrm{e}^{0} = 1\\). For \\(j \\geq 1\\), the left-hand side is \\[\\begin{align*} p&#39;_j(t) &amp;= \\frac{\\mathrm d}{\\mathrm d t} \\mathrm{e}^{-\\lambda t} \\frac{(\\lambda t)^j}{j!} \\\\ &amp; = \\frac{1}{j!} \\left(-\\lambda \\mathrm{e}^{-\\lambda t}(\\lambda t)^j + \\mathrm{e}^{-\\lambda t} \\lambda j(\\lambda t)^{j-1} \\right) \\\\ &amp;= - \\lambda \\mathrm{e}^{-\\lambda t} \\frac{(\\lambda t)^j}{j!} + \\lambda \\mathrm{e}^{-\\lambda t} \\frac{(\\lambda t)^{j-1}}{(j-1)!} \\\\ &amp;= -\\lambda p_j(t) + \\lambda p_{j-1}(t) \\end{align*}\\] as desired. We also have the initial condition \\(p_j(0) = \\mathrm{e}^{0} 0^j/j! = 0\\). The claim is proven, and we are (finally) done. In the next section, we two new types of process that are similar to the Poisson process. "],["S16-counting-processes.html", "Section 16 Counting processes 16.1 Birth processes 16.2 Time inhomogeneous Poisson process", " Section 16 Counting processes Birth processes, including the simple birth process Time inhomogeneous Poisson processes 16.1 Birth processes The Poisson process was made easier to understand because it was a counting process. That is, because it was counting arrivals, we always knew that the next change would be an increase by 1; the only question was when that increase would happen. In this section, we look at two other types of counting process; the only transitions will still only ever be from \\(i\\) to \\(i+1\\), but the holding times will not just be IID exponential distributions any more. We start with the simple birth process, which can model, for example, the division of cells in a biological experiment. We suppose that each individual has an offspring (eg the cell divides) after an \\(\\operatorname{Exp}(\\lambda)\\) period of time, and continues to have more offspring after another \\(\\operatorname{Exp}(\\lambda)\\) period of time, and so on. We start with \\(X(0) = 1\\) individual. After an \\(\\operatorname{Exp}(\\lambda)\\) time, the individual has an offspring, and we have \\(X(t) = 2\\). Now each of these two individuals will have an offspring after an \\(\\operatorname{Exp}(\\lambda)\\) time each. So how much longer will it be until the first offspring appears and we get \\(X(t) = 3\\)? Well, the earliest offspring will appear at the minimum of these two \\(\\operatorname{Exp}(\\lambda)\\) times, and we saw in the Section 14 that this has an \\(\\operatorname{Exp}(2\\lambda)\\) distribution. (Remember that the mean of an exponential distribution is the reciprocal of the rate parameter, so the holding time for the second offspring is half that of the first, on average.) Now suppose we have \\(n\\) individuals. By the memoryless property of the exponential distribution, they each still have an \\(\\operatorname{Exp}(\\lambda)\\) time until producing an offspring, so the time until the next offspring is the minimum of these, which is \\(\\operatorname{Exp}(n\\lambda)\\). In general, we have built a counting process defined entirely by its starting point \\(X(0) = 1\\), that the \\(n\\)th holding time \\(T_n\\) is exponential with rate \\(n\\lambda\\), and that all transitions are increases by 1. On Problem Sheet 8, you will show that the expected size of the population of the simple birth process at time \\(t\\) is \\(\\mathbb EX(t) = \\mathrm{e}^{\\lambda t}\\), so the population grows exponentially quickly (on average). The simple birth process is an example of the more general class of birth processes. Definition 16.1 A birth process \\((X_n)\\) with rates \\((\\lambda_n)\\) is defined by its starting population \\(X(0) = x_0\\) and that the holding times are \\(T_n \\sim \\operatorname{Exp}(\\lambda_n)\\). So we have \\[ X(t) = \\begin{cases} x_0 &amp; 0 \\leq t &lt; J_1 \\\\ x_0 + n &amp; J_n \\leq t &lt; J_{n+1}, \\text{ for } n=1,2,\\dots ,\\end{cases} \\] where \\(J_n = T_1 + T_2 + \\cdots + T_n\\) are the jump times. Example 16.1 We have the following examples: Setting \\(x_0 = 1\\) and \\(\\lambda_n = n\\lambda\\) gives the simple birth process. Setting \\(x_0 = 0\\) and \\(\\lambda_n = \\lambda\\) constant gives the Poisson process. Setting \\(x_0 = 1\\) and \\(\\lambda = n\\lambda + \\mu\\) gives a birth process with immigration from outside the system at rate \\(\\mu\\). We can also give an equivalent definition using infinitesimal time periods, as we did for the Poisson process. Suppose we start from \\(X(0) = 1\\). We have \\[\\begin{align*} \\mathbb P \\big(X(t+\\tau) = j\\phantom{{}+1} \\mid X(t) = j\\big) &amp;= 1 - \\lambda_j\\tau + o(\\tau) ,\\\\ \\mathbb P \\big(X(t+\\tau) = j+1 \\mid X(t) = j\\big) &amp;= \\lambda_j\\tau + o(\\tau) ,\\\\ \\mathbb P \\big(X(t+\\tau) \\geq j+2 \\mid X(t) = j\\big) &amp;= o(\\tau) , \\end{align*}\\] which is exactly the same as the Poisson process, except with \\(\\lambda\\) replaced by \\(\\lambda_j\\). We can continue as for the Poisson process. Write \\(p_j(t) = \\mathbb P(X(t) = j)\\). Then, for \\(j \\geq 2\\), \\[ p_j(t + \\tau) = \\big(1 - \\lambda_{j}\\tau + o(\\tau)\\big)p_j(t) + \\big(\\lambda_{j-1}\\tau + o(\\tau)\\big)p_{j-1}(t) + o(\\tau) , \\] since the two ways to get to \\(j\\) are either we’re already at \\(j\\) and the \\(j\\)th arrival doesn’t occur, or we’re at \\(j-1\\) and the \\((j-1)\\)th arrival does occur; other possibilities have \\(o(\\tau)\\) probability. As before, take \\(p_j(t)\\) over to the left-hand side, divide by \\(\\tau\\) to get \\[ \\frac{p_j(t + \\tau) - p_j(t)}{\\tau} = -\\lambda_j p_j(t) + \\lambda_{j-1}p_{j-1}(t) + \\frac{o(\\tau)}{\\tau} , \\] and then send \\(\\tau \\to 0\\). We end up with the forward equation \\[ p&#39;_j(t) = -\\lambda_j p_j(t) + \\lambda_{j-1}p_{j-1}(t) . \\] The initial condition is \\(p_j(0) = 0\\), since we start at \\(1\\), not at any \\(j \\geq 2\\). Following the similar process for \\(j =1\\), we get \\[ p&#39;_1(t) = -\\lambda_1 p_1(t) , \\] with initial condition \\(p_1(0) = 1\\), since we start from \\(1\\). In some cases the forward equations can be explicitly solved to give an expression for \\(p_j(t) = \\mathbb P(X(t) = j)\\). We saw the solution for the Poisson process in Lecture 14, and you will find a solution for the simple birth process on Problem Sheet 8. 16.2 Time inhomogeneous Poisson process When we dealt with the Poisson process, the rate of arrivals \\(\\lambda\\) was the same all the time – so our call centre always received calls at the same rate, or the insurance company always received claims at the same rate. In real life, though, the rate of arrivals might be lower at some times and higher at some other times, so the rate \\(\\lambda = \\lambda(t)\\) should perhaps depend on the time \\(t\\). This gives a process that is time inhomogeneous. The normal Poisson process and the birth processes were all time homogeneous; that is, the transition probabilities \\(\\mathbb P(X(t+s) = j \\mid X(t) = i)\\) depended on the state \\(i,j\\) and on the length of time period \\(t\\) but not on the current time \\(s\\). Most of the processes we consider in the rest of this course will be time homogeneous, but this subsection is the exception, because here the transition probabilities will change over time. Definition 16.2 The time inhomogeneous Poisson process with rate function \\(\\lambda = \\lambda(t) \\geq 0\\) is defined as followed. It is a stochastic process \\((X(t))\\) with continuous time \\(t \\in [0,\\infty)\\) a state space \\(\\mathcal S = \\mathbb Z_+\\) with the following properties: \\(X(0) = 0\\); Poisson increments: \\(X(t+s) - X(t) \\sim \\operatorname{Po}(\\int_t^{t+s} \\lambda(u) \\, \\mathrm d u)\\) for all \\(s,t&gt;0\\); independent increments: \\(X(t_2) - X(t_1)\\) and \\(X(t_4) - X(t_3)\\) are independent for all \\(t_1 \\leq t_2 \\leq t_3 \\leq t_4\\). The difference here is in point 2, where we integrate the rate function \\(\\lambda(t)\\) over the interval of interest. In particular, if \\(\\lambda(t) = \\lambda\\) is constant, then \\(\\int_t^{t+s} \\lambda(u) \\, \\mathrm d u = \\lambda s\\), and we get back the definition of the Poisson process in terms of Poisson increments. Example 16.2 A call centre notes that, when it opens the phone lines in the morning, phone calls arrive slowly at first, gradually becoming more common over the first hour. The owners of the centre model this is a time inhomogeneous Poisson process with rate function \\[ \\lambda(t) = \\begin{cases} 20t &amp; 0 \\leq t &lt; 1 \\\\ 20 &amp; t \\geq 1 \\end{cases} \\] calls per hour. What is the probability they receive no calls in the first 10 minutes? The number of calls in the first 10 minutes, or \\(\\frac16\\) of an hour, is Poisson with rate \\[ \\int_0^{1/6} \\lambda(t) \\, \\mathrm dt = \\int_0^{1/6}20t \\, \\mathrm dt = \\left[10t^2\\right]_0^{1/6} = \\frac{10}{36} = 0.278 . \\] The probability no calls are received is \\[ \\mathrm{e}^{-0.278} \\frac{0.278^0}{0!} = \\mathrm{e}^{-0.278} = 0.757 . \\] What is the expected number of calls in the first 2 hours? The number of calls in the first 2 hours is Poisson with rate \\[ \\int_0^2 \\lambda(t) \\, \\mathrm dt = \\int_0^1 20t \\, \\mathrm dt + \\int_1^2 20 \\, \\mathrm dt = \\left[10t^2\\right]_0^1 + \\left[20t\\right]_1^2 = 10 + (40 - 20) = 30 . \\] So the expected number of calls is 30. The time inhomogeneous Poisson process can also be given a definition in terms of inifinitesimal increments. We have \\[\\begin{equation*} \\mathbb P \\big(X(t+\\tau) - X(t) = j\\big) = \\begin{cases} 1 - \\lambda(t) \\tau + o(\\tau) &amp; \\text{if $j = 0$,} \\\\ \\lambda(t)\\tau + o(\\tau) &amp; \\text{if $j = 1$,} \\\\ o(\\tau) &amp; \\text{if $j \\geq 2$.} \\end{cases} \\end{equation*}\\] The only difference here is that we have replaced the rate \\(\\lambda\\) with the “current rate” \\(\\lambda(t)\\). In the next section, we begin to look at the general theory of continuous time Markov jump processes. "],["P08.html", "Problem Sheet 8", " Problem Sheet 8 .myanswers { display: none !important; } You should attempt all these questions and write up your solutions in advance of your workshop in week 9 (Monday 22 or Tuesday 23 March) where the answers will be discussed. 1.Let \\((X(t))\\) be a Poisson process with rate \\(\\lambda\\). (a) Fix \\(n\\). What is the expected time between the \\(n\\)th arrival and the \\((n+1)\\)th arrival? Solution. The waiting time is \\(\\operatorname{Exp}(\\lambda)\\) with mean \\(1/\\lambda\\). (b) Fix \\(t\\). What is the expected time between the previous arrival before \\(t\\) and the next arrival after \\(t\\)? Solution. The time between the arrivals is \\(S + T\\), where \\(S\\) is the time backwards from \\(t\\) since the previous arrival, and \\(T\\) is the time forwards from \\(t\\) until thenext arrival. By the memoryless property of the exponential distribution, \\(T \\sim \\operatorname{Exp}(\\lambda)\\), with mean \\(1/\\lambda\\). What about \\(S\\)? We have \\[ \\mathbb P(S &gt; s) = \\mathbb P\\big(\\text{no arrivals in }[t-s,t]\\big) = \\exp{-\\lambda s} \\frac{(\\lambda s)^0}{0!} = \\exp{-\\lambda s} , \\] which is itself is the tail probability of another \\(\\operatorname{Exp}(\\lambda)\\) distribution, so \\(S \\sim \\operatorname{Exp}(\\lambda)\\) with mean \\(1/\\lambda\\) too. Hence \\[ \\mathbb E(S + T) = \\frac1\\lambda + \\frac1\\lambda = \\frac2\\lambda .\\] (c) Your answers to the previous two questions should be different. Explain why one should expect the second answer to be bigger than the first. Solution. Imagine the arrivals being placed on the real line – some with big gaps between them, and some with small gaps between them. If we then place the time \\(t\\), it is more likely to be placed in one of the large gaps than one of the small ones, because each large gap fills up more of the line than a small one. Hence the size of the gap surrounding the given point \\(t\\) is “size-biased”, and is larger than a unfirotmly randomly chosen gap. 2. Let \\(X(t)\\) be a Poisson process with rate \\(\\lambda\\), and mark each arrival independently with probability \\(p\\). Use the infinitesimals definition to show that the marked process is a Poisson process with rate \\(p\\lambda\\). Solution. Let \\(Y(t)\\) be the marked process Consider an infinitesimal increment \\(Y(t + \\tau) - Y(t)\\) as \\(\\tau \\to 0\\). We have one arrival in \\((Y(t))\\) if there was one arrival for \\((X(t))\\) and it was marked – all other possibilities rely on extra arrivals in \\((X(t))\\), so have lower order probability – giving \\[ \\mathbb P \\big( Y(t + \\tau) - Y(t) = 1\\big) = p\\lambda t + o (\\tau) . \\] We have no arrivals in \\((Y(t))\\) if there were no arrivals in \\((X(t))\\), there was one arrival that was unmarked, or lower order terms, giving \\[ \\mathbb P \\big( Y(t + \\tau) - Y(t) = 0 \\big) = 1 - \\lambda t + (1-p)\\lambda t + o(\\tau) = 1 - p\\lambda t + o(\\tau) . \\] Larger increments in \\((Y(t))\\) require larger increments in \\((X(t))\\), so \\[ \\mathbb P \\big( Y(t + \\tau) - Y(t) \\geq 2 \\big) = o(\\tau) . \\] Since we have \\(Y(0) = 0\\) and independent increments, we have written down precisely the infinitesimal increments definition of a Poisson process with rate \\(p\\lambda\\). 3. Let \\((X(t))\\) be a simple birth process with rates \\(\\lambda_j = \\lambda j\\) starting from \\(X(0)=1\\). Let \\(p_j(t) = \\mathbb P(X(t) = j)\\). (a) Write down the Kolmogorov forward equations for \\(p_j(t)\\). You should have separate equations for \\(j = 1\\) and \\(j \\geq 2\\). Remember to include the initial conditions \\(p_j(0)\\). Solution. From Section 16.1 of the notes, and putting \\(\\lambda_j = \\lambda j\\), the forward equations are \\[\\begin{align*} j &amp;= 1\\colon &amp; p&#39;_j(t) &amp;= -\\lambda p_1(t) &amp; p_1(0) &amp;= 1 \\\\ j &amp;\\geq 2 \\colon &amp; p&#39;_j(t) &amp;= -\\lambda j p_j(t) + \\lambda (j-1)p_{j-1}(t) &amp; p_j(0) &amp;= 0 \\end{align*}\\] (b) Show that \\(X(t)\\) follows a geometric distribution \\(X(t) \\sim \\text{Geom} (\\mathrm{e}^{-\\lambda t})\\). That is, show that \\[ p_j(t) = \\big(1 - \\mathrm{e}^{-\\lambda t}\\big)^{j-1}\\mathrm{e}^{-\\lambda t} \\] satisfies the forward equation. Solution. For \\(j = 1\\), we have \\(p_1(t) = \\mathrm{e}^{-\\lambda t}\\). This clearly has \\(p_1(0) = \\mathrm{e}^0 = 1\\), and \\(p&#39;_1(t) = -\\lambda \\mathrm{e}^{-\\lambda t} = \\lambda p_1(t)\\), as required. Now consider \\(j \\geq 2\\). We indeed have \\(p_j(0) = 0\\). By the product rule, the derivative on the left-hand side is \\[\\begin{align*} p&#39;_j(t) &amp;= -\\lambda \\big(1 - \\mathrm{e}^{-\\lambda t}\\big)^{j-1}\\mathrm{e}^{-\\lambda t} + \\lambda \\mathrm{e}^{-\\lambda t} (j-1) \\big(1 - \\mathrm{e}^{-\\lambda t}\\big)^{j-2}\\mathrm{e}^{-\\lambda t} , \\\\ &amp;= -\\lambda \\big(1 - \\mathrm{e}^{-\\lambda t}\\big)^{j-2}\\mathrm{e}^{-\\lambda t} \\big(1 - \\mathrm{e}^{-\\lambda t} -\\mathrm{e}^{-\\lambda t} (j-1) \\big) \\\\ &amp;=- \\lambda \\big(1 - \\mathrm{e}^{-\\lambda t}\\big)^{j-2}\\mathrm{e}^{-\\lambda t} \\big(1 - j \\mathrm{e}^{-\\lambda t} \\big). \\end{align*}\\] The right-hand side is \\[\\begin{align*} -\\lambda j p_j(t) + {}&amp;\\lambda (j-1)p_{j-1}(t) \\\\ &amp;= - \\lambda j \\big(1 - \\mathrm{e}^{-\\lambda t}\\big)^{j-1}\\mathrm{e}^{-\\lambda t} + \\lambda (j-1) \\big(1 - \\mathrm{e}^{-\\lambda t}\\big)^{j-2}\\mathrm{e}^{-\\lambda t} \\\\ &amp;= -\\lambda\\big(1 - \\mathrm{e}^{-\\lambda t}\\big)^{j-2}\\mathrm{e}^{-\\lambda t}\\big(j(1 - \\mathrm{e}^{-\\lambda t}) - (j-1)\\big) \\\\ &amp;= - \\lambda \\big(1 - \\mathrm{e}^{-\\lambda t}\\big)^{j-2}\\mathrm{e}^{-\\lambda t} \\big(1 - j \\mathrm{e}^{-\\lambda t} \\big) . \\end{align*}\\] These are indeed equal. (c) Hence, calculate \\(\\mathbb E X(t)\\), the expected population size at time \\(t\\). Solution. The expectation of a \\(\\text{Geom}(\\theta)\\) random variable is \\(1/\\theta\\), so \\(\\mathbb EX(t) = 1/\\mathrm{e}^{-\\lambda t} = \\mathrm{e}^{\\lambda t}\\). 4. Let \\((X(t))\\) be a simple birth process with rates \\(\\lambda_n = \\lambda n\\) starting from \\(X(0)=1\\). Let \\(T_n \\sim \\operatorname{Exp}(\\lambda n)\\) be the \\(n\\)th holding time, and let \\(J_n = T_1 + T_2 +\\cdots+T_n\\) be the time of the \\(n\\)th birth. (a) Write down \\(\\mathbb E T_n\\) and \\(\\operatorname{Var}(T_n)\\). Solution. By standard results about the exponential distribution, \\(\\mathbb E T_n = 1/\\lambda n\\) and \\(\\operatorname{Var}(T_n) = 1/(\\lambda n)^2 = 1/\\lambda^2 n^2\\). (b) Show that, as \\(n \\to \\infty\\), the expectation \\(\\mathbb E J_n\\) tends to infinity, but the variance \\(\\operatorname{Var}(J_n)\\) is bounded. Solution. By linearity of expectation, \\[ \\mathbb E J_n = \\sum_{j=1}^n \\mathbb E T_j = \\sum_{j=1}^n \\frac{1}{\\lambda j} = \\frac{1}{\\lambda} \\sum_{j=1}^n \\frac{1}j . \\] Since the holding times are independent, \\[ \\operatorname{Var}(J_n) = \\sum_{j=1}^n \\operatorname{Var}(T_j) = \\sum_{j=1}^n \\frac{1}{\\lambda^2 j^2} = \\frac{1}{\\lambda^2} \\sum_{j=1}^n \\frac{1}{j^2} . \\] The harmonic series \\(\\sum_j 1/j\\) diverges, so \\(\\mathbb E J_n\\) tends to infinity. The series \\(\\sum_j 1/j^2\\), on the other hand, converges (to \\(\\pi^2/6\\), although you don’t need to know that), so \\(\\operatorname{Var}(J_n)\\) is bounded (by \\(\\pi^2/6\\lambda^2\\)). 5. The number of phonecalls my office receives in a three hour period is modelled as a time inhomogeneous Poisson process with rate function \\[ \\lambda(t) = \\begin{cases} 3t &amp; 0 \\leq t &lt; 1 \\\\ 3 &amp; 1 \\leq t &lt; 2 \\\\ 9 - 3t &amp; 2 \\leq t \\leq 3 \\end{cases}. \\] (a) Calculate the probability I receive exactly one phonecall (i) in the first hour; (ii) in the second hour; (iii) in the third hour. Solution. (i) The number of phonecalls in the first hour is Poisson with rate \\[ \\int_0^1 3t\\,\\mathrm dt = \\left[\\tfrac32 t^2 \\right]_0^1 = \\tfrac32 . \\] The probability there is exactly one phonecall in this time is \\(\\frac32 \\mathrm{e}^{-3/2} = 0.335\\). The number of phonecalls in the second hour is Poisson with rate \\(3\\). The probability there is exactly one phonecall in this time is \\(3 \\mathrm{e}^{-3} = 0.149\\). The number of phonecalls in the first hour is Poisson with rate \\[ \\int_2^3 (9-3t)\\,\\mathrm dt = \\left[9t - \\tfrac32 t^2 \\right]_2^3 = 3 - \\tfrac32 = \\tfrac32 . \\] The probability there is exactly one phonecall in this time is \\(\\frac32 \\mathrm{e}^{-3/2} = 0.335\\). (b) Calculate the probability I receive exactly \\(3\\) phonecalls over the three hour period. Solution. The number of phonecalls over the three hour period is Poisson with rate \\[ \\int_0^3 \\lambda(t)\\,\\mathrm dt = \\tfrac32 + 3 + \\tfrac32 = 6 . \\] The probability there are exactly three calls is \\[ \\frac{6^3}{3!} \\mathrm{e}^{-6} = 36 \\mathrm{e}^{-6} = 0.089. \\] "],["S17-continuous-time.html", "Section 17 Continuous time Markov jump processes 17.1 Jump chain and holding times 17.2 Examples 17.3 A brief note on explosion", " Section 17 Continuous time Markov jump processes Time homogeneous continuous time Markov jump processes in terms of the jump Markov chain and the holding times Explosion of Markov jump processes 17.1 Jump chain and holding times In this section, we will start looking at general Markov processes in continuous time and discrete space. All our examples will be time homogeneous, in that the transition probabilities and transition rates will remain constant over time. We call these Markov jump processes, as we will wait in a state for a random holding time, and then we will suddenly “jump” to another state. The idea will be treat two matters separately: where we jump too: This will be studied through the “jump chain”, a discrete time Markov chain that tells us what transitions are made (but not when they are made). how long we wait until we jump: we call these the “holding times”. To preserve the Markov property, these holding times must have an exponential distribution, since this is the only random variable that has the memoryless property. Let us consider a Markov jump process \\((X(t))\\) on a state space \\(\\mathcal S\\). Suppose we are at a state \\(i \\in \\mathcal S\\). The transition rate at which we wish to jump to a state \\(j \\neq i\\) will be written \\(q_{ij} \\geq 0\\). This means that, after a time with an exponential distribution \\(\\operatorname{Exp}(q_{ij})\\), if the process has not jumped yet, it will jump to state \\(j\\). (We use the convention that if \\(q_{ij} = 0\\) for some \\(j \\neq i\\), this means we will never jump from \\(i\\) to \\(j\\). If for some \\(i\\) we have \\(q_{ij} = 0\\) for all \\(j \\neq i\\), then we stay in state \\(i\\) forever, and \\(i\\) is an abaorbing state.) So from state \\(i\\), there are many other states \\(j\\) we could jump to, each waiting for a time \\(\\operatorname{Exp}(q_{ij})\\). Which of these times will be up first, leading the process to jump to that state? And how long will it be until that first time is up and we move? The answer is given by Theorem 14.2, which showed us the distribution of the minimum of the \\(\\operatorname{Exp}(q_{ij})\\)s is itself exponential, with rate \\[ q_i := \\sum_{j \\neq i} q_{ij} . \\] Further, and also from Theorem 14.2, the probability that we move to some state \\(j \\neq i\\) is \\[ r_{ij} := \\frac{q_{ij}}{\\sum_{j \\neq i} q_{ij}} = \\frac{q_{ij}}{q_i} . \\] These last two displayed equations define the quantities \\(q_i\\) and \\(r_{ij}\\). (If \\(i\\) is an absorbing state \\(i\\), then by convenetion we put \\(r_{ii} = 1\\) and \\(r_{ij} = 0\\) for \\(j \\neq i\\). So, this is the crucial idea: from state \\(i\\), we wait for a holding time with distribution \\(\\operatorname{Exp}(q_i)\\), then move to another state, choosing state \\(j\\) with probability \\(r_{ij}\\). It will be convenient to write all the transition rates \\(q_{ij}\\) down in a generator matrix \\(\\mathsf Q\\) defined as follows: the off-diagonal entries are \\(q_{ij}\\), for \\(i \\neq j\\), and the diagonal entries are \\[ q_{ii} = - q_i = -\\sum_{j \\neq i} q_{ij} . \\] In particular, the off-diagonal entries are positive (or 0), the diagonal entries are negative (or 0) and each row adds up to 0. One convenient way to keep track of the movement of a continuous time Markov jump process will be to look at which states it jumps to, leaving the holding times for later consideration. That is, we can consider the discrete time jump Markov chain (or just jump chain) \\((Y_n)\\) associated with \\((X(t))\\) given by \\(Y_0 = X(0)\\) and \\[ Y_n = \\text{state of $X(t)$ just after the $n$th jump.} \\] This is a discrete time Markov chain that starts from the same place \\(Y_0 = X(0)\\) as \\((X(t))\\) does, and has transitions given by \\(r_{ij} = q_{ij}/q_i\\). (The jump chain cannot move from a state to itself.) Once we know where the jump process will move, we then know what the next holding time will be: from state \\(j\\), the holding time will be \\(\\operatorname{Exp}(q_j)\\) We can some all this up in the following (rather long-winded) formal definition. Definition 17.1 Let \\(\\mathcal S\\) be a set, and \\(\\boldsymbol\\lambda\\) a distribution on \\(\\mathcal S\\). Let \\(\\mathsf Q = (q_{ij} : i,j \\in \\mathcal S)\\) be a matrix where \\(q_{ij} \\geq 0\\) for \\(i \\neq j\\) and \\(\\sum_j q_{ij} = 0\\) for all \\(i\\), and write \\(q_i = -q_{ii} = -q_i = \\sum_{j \\neq i} q_{ij}\\). Define \\(\\mathsf R = (r_{ij} : i,j \\in \\mathcal S)\\) as follows: for \\(i\\) such that \\(q_i \\neq 0\\), write \\(r_{ij} = q_{ij}/q_i\\) for \\(j \\neq i\\), and \\(r_{ii}= 0\\); and for \\(i\\) such that \\(q_i = 0\\), write \\(r_{ij} = 0\\) for \\(j \\neq i\\), and \\(r_{ii} = 1\\). We wish to define the Markov jump process on a state space \\(\\mathcal S\\) with generator matrix \\(\\mathsf Q\\) and initial distribution \\(\\boldsymbol\\lambda\\). The jump chain \\((Y_n)\\) is the discrete time Markov chain on \\(\\mathcal S\\) with initial distribution \\(\\boldsymbol\\lambda\\) and transition matrix \\(\\mathsf R\\). The holding times \\(T_1, T_2, \\dots\\) have distribution \\(T_n \\sim \\operatorname{Exp}(q_{Y_{n-1}})\\), and are conditionally independent given \\((Y_n)\\). The jump times are \\(J_n = T_1 + T_2 + \\cdots + T_n\\). Then (at last!) the Markov jump process \\((X(t))\\) is defined by \\[ X(t) = \\begin{cases} Y_0 &amp; \\text{for }t &lt; J_1 \\\\ Y_n &amp; \\text{for }J_n \\leq t &lt; J_{n+1} .\\end{cases} \\] 17.2 Examples Example 17.1 Consider the Markov jump process on a state space \\(\\mathcal S = \\{1,2,3\\}\\) with transition rates as illustrated in the following transition rate diagram. (Note that a transition rate diagram never has arrows from a state to itself.) Figure 17.1: Transition diagram for a continuous Markov jump process. The generator matrix is \\[ \\mathsf Q = \\begin{pmatrix} -2 &amp; 2 &amp; 0 \\\\ 1 &amp; -3 &amp; 2 \\\\ 0 &amp; 1 &amp; -1 \\end{pmatrix} , \\] where the off-diagonal entries are the rates from the diagram, and the diagonal entries are chosen to make sure the rows add up to 0. The transition matrix of the jump chain is \\[ \\mathsf R = \\begin{pmatrix} 0 &amp; 1 &amp; 0 \\\\ \\frac13 &amp; 0 &amp; \\frac23 \\\\ 0 &amp; 1 &amp; 0 \\end{pmatrix} , \\] where we set the diagonal elements equal to 0, then normalize each row so that it adds up to 1. So, for example, starting from state 2, we wait for a holding time \\(T_1 \\sim \\operatorname{Exp}(q_2) = \\operatorname{Exp}(-q_{22}) = \\operatorname{Exp}(3)\\). We then move to state 1 with probability \\(r_{21} = q_{21}/q_2 = \\frac13\\) and to state 3 with probability \\(r_{23} = q_{23}/q_2 = \\frac23\\). Suppose we move to state 1. Then we stay in state 1 for a time \\(\\operatorname{Exp}(q_1) = \\operatorname{Exp}(2)\\), before moving with certainty back to state 2. And so on. Example 17.2 Consider the Markov jump process with state space \\(\\mathcal S = \\{A,B,C\\}\\) and this transition rate diagram. Figure 17.2: Transition diagram for a continuous Markov jump process with an absorbing state. The generator matrix is \\[ \\mathsf Q = \\begin{pmatrix} -q_A &amp; q_{AB} &amp; q_{AC} \\\\ q_{BA} &amp; -q_B &amp; q_{BC} \\\\ 0 &amp; 0 &amp; 0\\end{pmatrix} , \\] where \\(q_A = q_{AB} + q_{AC}\\) and \\(q_B = q_{BA} + q_{BC}\\). Here, state C is an absorbing state, so if we ever reach it, we stay there forever. So the jump chain has transition rates \\[ \\mathsf R = \\begin{pmatrix} 0 &amp; q_{AB}/q_A &amp; q_{AC}/q_A \\\\ q_{BA}/q_B &amp; 0 &amp; q_{BC}/q_B \\\\ 0 &amp; 0 &amp; 1 \\end{pmatrix} . \\] Example 17.3 The Poisson process with rate \\(\\lambda\\) has state space \\(\\mathcal S = \\mathbb Z_+ = \\{0,1,2,\\dots\\}\\). The transition rates from \\(i\\) to \\(i+1\\) are \\(q_{i,i+1} = \\lambda\\), and all other transition rates are 0. So the generator matrix is \\[ \\mathsf Q = \\begin{pmatrix} -\\lambda &amp; \\lambda &amp; 0 &amp; 0 &amp; \\\\ 0 &amp; -\\lambda &amp; \\lambda &amp; 0 &amp; \\\\ 0 &amp; 0 &amp; -\\lambda &amp; \\lambda &amp; \\\\ &amp; &amp; &amp; \\ddots &amp; \\ddots \\\\ \\end{pmatrix}. \\] The jump chain is very boring: it starts from 0 and moves with certainty to 1, then with certainty to 2, then to 3, and so on. 17.3 A brief note on explosion There is one point we have to be a little careful about with when dealing with continuous time processes with an infinite state space – the potential of “explosion”. Explosion is when the process can get arbitrarily large in finite time. Think, for example, of a birth process with birth rates \\(\\lambda_j = \\lambda j^2\\). The \\(n\\)th birth is expected to be occur at time \\[ \\sum_{j=1}^n \\frac{1}{\\lambda_j} = \\frac{1}{\\lambda} \\sum_{j=1}^n \\frac{1}{n^2} . \\] But this has a finite limit as \\(n \\to \\infty\\), meaning we expect to get infinitely many births in a finite amount of time. When explosion happens, it can then be rather difficult to define what’s going on. In that birth process, for example, the state space is \\(\\mathcal S = \\mathbb Z_+\\); but after some finite time, we have \\(X(t) &gt; j\\) for all \\(j \\in \\mathcal S\\) – so what state is the process in? Although there are often technical fixes that can get around this problem (doing things like creating an “infinity” state, or restarting the process from \\(X(0)\\) again), we will not concern ourselves with them here. We shall normally deal with finite state spaces, where explosion is not a concern. When we do use infinite state space models (such as birth processes, for example), we shall only look at examples that explode with probability 0. In the next section, we look at how to find the transition probilities \\(p_{ij}(t) = \\mathbb P(X(t) = j \\mid X(0) = i)\\), which are the equivalents to the \\(n\\)-step transition probabilities in discrete time. "],["S18-forward-backward.html", "Section 18 Forward and backward equations 18.1 Transitions in infinitesimal time periods 18.2 Transition semigroup and the forward and backward equations 18.3 Matrix exponential", " Section 18 Forward and backward equations Markov jump process in infinitesimal time periods Transition semigroup, Chapman–Kolmogorov equations, and forward and backward equations Matrix exponential as a solution to the forward and backward equations 18.1 Transitions in infinitesimal time periods In the last section, we defined the continuous time Markov jump process with generator matrix \\(\\mathsf Q\\) in terms of the holding times and the jump chain: from state \\(i\\), we wait for a holding time exponentially distributed with rate \\(q_i = -q_{ii}\\), then jump to state \\(j\\) with probability \\(r_{ij} = q_{ij}/q_i\\). So what happens starting from state \\(i\\) in a very small amount of time \\(\\tau\\)? The remaining time until a move is still \\(T \\sim \\operatorname{Exp}(q_i)\\), by the memoryless property. So the probability we don’t move in the small amount of time \\(\\tau\\) is \\[ \\mathbb P(T &gt; \\tau) = \\mathrm{e}^{-q_i \\tau} = 1 - q_i\\tau + o(\\tau) . \\] Here we have used the tail probability of the exponential distribution and the first two terms of the Taylor series. \\[ \\mathrm{e}^x = 1 + x + o(x) \\qquad \\text{as $x \\to 0$.} \\] The probability that we do move in the small amount of time \\(\\tau\\), and that the move is to state \\(j\\) is \\[ \\mathbb P(T \\leq \\tau)r_{ij} = \\big(q_i\\tau + o(\\tau)\\big) \\frac{q_{ij}}{q_i} = q_{ij}\\tau + o(\\tau) . \\] The probability we make two or more jumps is a lower order term \\(o(\\tau)\\). Thus we have \\[ \\mathbb P\\big(X(t+\\tau) = j \\mid X(t) = i \\big) = \\begin{cases} 1 - q_i\\tau + o(\\tau) &amp; \\text{for } i = j \\\\ q_{ij}\\tau + o(\\tau) &amp; \\text{for } i \\neq j. \\end{cases} \\] This is an equivalent definition of the Markov jump process. 18.2 Transition semigroup and the forward and backward equations Video to appear here soon. Let us write \\(p_{ij}(t) = \\mathbb P(X(t) = j \\mid X(0) = i)\\) for the transition probability over a time \\(t\\). This is the continuous-time equivalent to the \\(n\\)-step transition probability \\(p_{ij}(n)\\) we had before in discrete time, but now \\(t\\) can be any positive real value. It can be convenient to use the matrix form \\(\\mathsf P(t) = (p_{ij}(t) : i,j \\in \\mathcal S)\\). In discrete time, we were given a transition matrix \\(\\mathsf P\\), and it was easy to find \\(\\mathsf P(n) = \\mathsf P^n\\) as a matrix power. In continuous time, we are given the generator matrix \\(\\mathsf Q\\), so how can we find \\(\\mathsf P(t)\\) from \\(\\mathsf Q\\)? First, let’s consider \\(p_{ij}(s+t)\\). To get from \\(i\\) to \\(j\\) in time \\(s + t\\), we could first go from \\(i\\) to some \\(k\\) in time \\(s\\), then from that \\(k\\) to \\(j\\) in time \\(t\\), and the intermediate state \\(k\\) can be any state. So we have \\[ p_{ij}(s+t) = \\sum_{k\\in \\mathcal S} p_{ik}(s)p_{kj}(t) . \\] You should recognise this as the Chapman–Kolmogorov equations again. In matrix form, we can write this as \\[ \\mathsf P(s+t) = \\mathsf P(s) \\mathsf P(t) . \\] Pure mathematicians sometimes call this equation the “semigroup property”, so we sometimes call the matrices \\((\\mathsf P(t) : t \\geq 0)\\) the transition semigroup. Second, as in previous examples, we can try to get a differential equation for \\(p_{ij}(t)\\) by looking at an infinitesimal increment \\(p_{ij}(t+\\tau)\\). We can start with the Chapman–Kolmogorov equations. We have \\[\\begin{align*} p_{ij}(t+\\tau) &amp;= \\sum_k p_{ik}(t)p_{kj}(\\tau) \\\\ &amp;=p_{ij}(t)(1 - q_j\\tau) + \\sum_{k \\neq j} p_{ik}(t)q_{kj}\\tau + o(\\tau) \\\\ &amp;= p_{ij}(t) + \\sum_k p_{ik}(t)q_{kj}\\tau + o(\\tau) , \\end{align*}\\] where we have treated the \\(k = j\\) term of the sum separately, and taken advantage of the fact that \\(q_{jj} = - q_j\\). As we have done many times before, we take a \\(p_{ij}(t)\\) to the left hand side and divide through by \\(\\tau\\) to get \\[ \\frac{p_{ij}(t + \\tau) - p_{ij}(t)}{\\tau} = \\sum_k p_{ik}(t)q_{kj} + \\frac{o(\\tau)}{\\tau} . \\] Sending \\(\\tau\\) to 0 gives us the (Kolmogorov) forward equation \\[ p&#39;_{ij} (t) = \\sum_k p_{ik}(t)q_{kj} . \\] The initial condition is, of course, \\(p_{ii}(0) = 1\\) and \\(p_{ij}(0) = 0\\) for \\(j \\neq i\\). Writing \\(\\mathsf P(t) = (p_{ij}(t))\\), and recognising the right hand side as a matrix multiplication, we get the convenient matrix form \\[ \\mathsf P&#39;(t) = \\mathsf{P}(t) \\mathsf{Q} \\qquad \\mathsf P(0) = \\mathsf I ,\\] where \\(\\mathsf I\\) is the identity matrix. Alternatively, we could have started with the Chapman–Kolmogorov equations the other way round as \\[ p_{ij}(t+\\tau) = \\sum_k p_{ik}(\\tau)p_{kj}(t) , \\] with the \\(\\tau\\) in the first term rather than the second. Following through the same argument would have given the Kolmogorov backward equation \\[ \\mathsf P&#39;(t) = \\mathsf{Q} \\mathsf{P}(t) \\qquad \\mathsf P(0) = \\mathsf I ,\\] where the \\(\\mathsf Q\\) and \\(\\mathsf P\\) are also the other way round. The forward and backward equations both define the transition semigroup \\((\\mathsf P(t))\\) in terms of the generator matrix \\(\\mathsf Q\\). 18.3 Matrix exponential Video to appear here soon. When the state space \\(\\mathcal S\\) is finite, a crucial role is played for continuous time jump processes by the matrix exponential \\(\\mathrm{e}^{t\\mathsf Q}\\). In the discrete time setting, the matrix power \\(\\mathsf P^n\\) (for integers \\(n\\)) was very important; the matrix exponential allows us to do matrix algebra with the powers including arbitrary real numbers, which is important for continuous time processes. You may remember that the usual exponential function is defined by the Taylor series \\[ \\mathrm{e}^x = \\exp(x) = \\sum_{n=0}^\\infty \\frac{x^n}{n!} = 1 + x + \\frac{x^2}{2} + \\frac{x^3}{6} + \\cdots. \\] Similarly, we can define the matrix exponential for any square matrix by the same series \\[ \\mathrm{e}^{\\mathsf A} = \\exp({\\mathsf A}) = \\sum_{n=0}^\\infty \\frac{{\\mathsf A}^n}{n!} = {\\mathsf I} + {\\mathsf A} + \\tfrac12 \\mathsf A^2+ \\tfrac16 \\mathsf A^3 + \\cdots, \\] where we interpret \\(\\mathsf A^0 = \\mathsf I\\) to be the identity matrix. Since a matrix commutes with itself, we have \\(\\mathsf {A}^n \\mathsf A = \\mathsf{AA}^n\\), so a matrix commutes with its own exponential, meaning that \\(\\mathsf A \\mathrm{e}^{\\mathsf A} = \\mathrm{e}^{\\mathsf A} \\mathsf A\\). This will be useful later. Some properties of the standard exponential include \\[ (\\mathrm{e}^x\\big)^n = \\mathrm{e}^{nx} \\qquad \\frac{\\mathrm d}{\\mathrm d x} \\mathrm{e}^{ax} = a \\mathrm{e}^{ax} . \\] Similarly, we have for the matrix exponential \\[ (\\mathrm{e}^{\\mathsf A}\\big)^n = \\mathrm{e}^{n{\\mathsf A}} \\qquad \\frac{\\mathrm d}{\\mathrm d t} \\mathrm{e}^{t{\\mathsf A}} = {\\mathsf A} \\mathrm{e}^{t{\\mathsf A}} = \\mathrm{e}^{t{\\mathsf A}} {\\mathsf A} . \\] From this last expression, we get that \\[ \\frac{\\mathrm d}{\\mathrm d t} \\mathrm{e}^{t{\\mathsf Q}} = \\mathrm{e}^{t{\\mathsf Q}} {\\mathsf Q} = {\\mathsf Q} \\mathrm{e}^{t{\\mathsf Q}} . \\] Comparing this to the forward equation \\(\\mathsf P&#39;(t) = \\mathsf{P}(t) \\mathsf Q\\) and backward equation \\(\\mathsf{P}&#39;(t) = \\mathsf Q \\mathsf{P}(t)\\), we see that we have a solution to the forward and backward equations of \\(\\mathsf P(t) = \\mathrm{e}^{t\\mathsf Q}\\), which also satisfies the common initial condition \\(\\mathsf P(0) = \\mathrm{e}^{0\\mathsf Q} = \\mathsf I\\). We also see that we have the semigroup property \\[ \\mathsf P(s+t) = \\mathrm{e}^{(s+t)\\mathsf Q} = \\mathrm{e}^{s \\mathsf Q + t \\mathsf Q} = \\mathrm{e}^{s \\mathsf Q}\\mathrm{e}^{t \\mathsf Q} = \\mathsf P(s) \\mathsf P(t) . \\] As a formal summary, we have the following. ::: {.theorem exp-thm} Let \\((X(t))\\) be a time homogeneous continuous time Markov jump process with generator matrix \\(\\mathsf Q\\). Let \\((\\mathsf P(t))\\) be the transition semigroup, where \\(\\mathsf P(t) = (p_{ij}(t))\\) is defined by \\(p_{ij}(t) = \\mathbb P(X(t) = j \\mid X(0) = i)\\). Then \\((\\mathsf P(t))\\) is the minimal nonnegative solution to the forward equation \\[ \\mathsf P&#39;(t) = \\mathsf P(t) \\mathsf Q \\qquad \\mathsf P(0) = \\mathsf I , \\] and is also the minimal nonnegative solution to the backward equation \\[ \\mathsf P&#39;(t) = \\mathsf Q \\mathsf P(t) \\qquad \\mathsf P(0) = \\mathsf I . \\] When the state space \\(\\mathcal S\\) is finite, the forward and backward equations both have a unique solution given by the matrix exponential \\(\\mathsf P(t) = \\mathrm{e}^{t \\mathsf Q}\\). ::: "],["P09.html", "Problem Sheet 9", " Problem Sheet 9 .myanswers { display: none !important; } You should attempt all these questions and write up your solutions in advance of your workshop in week 10 (Monday 26 or Tuesday 27 April) where the answers will be discussed. 1. Consider a Markov jump process with state space \\(\\mathcal S = \\{0,1,2,\\dots,N\\}\\) and generator matrix \\[ \\mathsf Q = \\begin{pmatrix} -q_0 &amp; q_{01} &amp; q_{02} &amp; \\cdots &amp; q_{0N} \\\\ 0 &amp; 0 &amp; 0 &amp; \\cdots &amp; 0 \\\\ 0 &amp; 0 &amp; 0 &amp; \\cdots &amp; 0 \\\\ \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ 0 &amp; 0 &amp; 0 &amp; \\cdots &amp; 0 \\end{pmatrix} . \\] (a) Draw a transition rate diagram for this jump process. Solution. This process is a “multiple decrement model”: there is one “active state” 0 and a number of “exit states” \\(1,2,\\dots,N\\). (b) What is the probability that the process exits at state \\(i\\)? Solution. The probability of exit at \\(i\\) is \\(r_{0i} = q_{0i}/q_0\\). (c) Give a \\(95\\%\\) prediction interval for the amount of time spent in the active state. (Your answer will be in terms of \\(q_0\\).) Solution. The amount of time in the active state is \\(T_1 \\sim \\operatorname{Exp}(q_0)\\). The \\(\\alpha\\)-upper quantile of this distribution is the \\(t\\) such that \\(\\alpha = \\mathrm{e}^{-q_0 t}\\) which is \\(-(\\log\\alpha)/q_0\\). So the \\(95\\%\\) prediction interval is \\[ \\left[ \\frac{-\\log0.975}{q_0} , \\frac{-\\log0.025}{q_0} \\right] = \\left[ \\frac{0.025}{q_0}, \\frac{3.69}{q_0} \\right] . \\] 2. Consider the Markov jump process \\((X(t))\\) with state space \\(\\mathcal S = \\{1,2,3\\}\\) and generator matrix \\[ \\mathsf Q = \\begin{pmatrix} -3 &amp; 2 &amp; 1 \\\\ 2 &amp; -6 &amp; 4 \\\\ 1 &amp; 3 &amp; -4 \\end{pmatrix} . \\] The process begins from the state \\(X(0) = 1\\). Let \\((Y_n)\\) be the associated Markov jump chain. (a) Write down the transition matrix \\(\\mathsf R\\) of the jump chain. Solution. \\[ \\mathsf R = \\begin{pmatrix} 0 &amp; \\frac23 &amp; \\frac13 \\\\[0.5ex] \\frac13 &amp; 0 &amp; \\frac23 \\\\[0.5ex] \\frac14 &amp; \\frac34 &amp; 0 \\end{pmatrix} . \\] (b) What is the expected time of the first jump \\(J_1\\)? Solution. The first jump time has the distribution \\(J_1 = T_1 \\sim \\operatorname{Exp}(q_1) = \\operatorname{Exp}(3)\\), which has expectation \\(\\mathbb E J_1 = \\frac13\\). (c) What is the probability the first jump is to state 2? Solution. The probability the first jump from \\(1\\) is to \\(2\\) is \\(r_{12} = \\frac23\\). (d) By conditioning on the first jump, calculate the expected time of the second jump time \\(J_2 = T_1 + T_2\\). Solution. We have \\[\\begin{align*} \\mathbb E(T_1 + T_2) &amp;= \\mathbb ET_1 + \\mathbb P(Y_1 = 2) \\mathbb E(T_2 \\mid Y_1 = 2) \\\\ &amp;\\qquad{}+ \\mathbb P(Y_1 = 2) \\mathbb E(T_2 \\mid Y_1 = 3) \\\\&amp;= \\frac1{q_1} + r_{12} \\frac{1}{q_2} + r_{23} \\frac{1}{q_3} \\\\&amp;= \\tfrac13 + \\tfrac23 \\, \\tfrac16 + \\tfrac13 \\, \\tfrac14 \\\\ &amp;= \\tfrac{19}{36} = 0.528 \\end{align*}\\] (e) What is the probability that the second jump is to state 2? Solution. In the jump chain, the only length-\\(2\\) path from \\(1\\) to \\(2\\) is \\(1 \\to 3 \\to 2\\), with probability \\(r_{12}^{(2)}=\\frac13 \\times \\frac34 = \\frac14\\). (f) What is the probability that the third jump is to state 2? Solution. In the jump chain, paths of length \\(3\\) from \\(1\\) to \\(2\\) are \\[\\begin{align*} 1 &amp;\\to 2 \\to 1 \\to 2 &amp; \\tfrac23 \\times \\tfrac13 \\times \\tfrac23 &amp;= \\tfrac{16}{108} , \\\\ 1 &amp;\\to 2 \\to 3 \\to 2 &amp; \\tfrac23 \\times \\tfrac23 \\times \\tfrac34 &amp;= \\tfrac{36}{108} , \\\\ 1 &amp;\\to 3 \\to 1 \\to 2 &amp; \\tfrac13 \\times \\tfrac14 \\times \\tfrac23 &amp;= \\tfrac{6}{108} . \\end{align*}\\] The total probability is \\(r_{12}^{(3)} = \\frac{58}{108} = 0.537\\). 3. Consider the Markov jump process on \\(\\mathcal S = \\{1,2\\}\\) with generator matrix \\[ \\mathsf Q = \\begin{pmatrix} -\\alpha &amp; \\alpha \\\\ \\beta &amp; -\\beta \\end{pmatrix} , \\] where \\(\\alpha, \\beta &gt; 0\\). (a) Write down the Kolmogorov forward equation for \\(p_{11}(t)\\), including the initial condition. Solution. The forward equation is \\(p_{11}&#39;(t) = -\\alpha p_{11}(t) + \\beta p_{12}(t)\\), with initial condition \\(p_{11}(0) = 1\\). (b) Hence, show that \\[ p&#39;_{11}(t) + (\\alpha + \\beta)p_{11}(t) = \\beta . \\] Solution. We have \\(p_{11}(t) + p_{12}(t) = 1\\), since rows of \\(\\mathsf P\\) add to \\(1\\). Substituting \\(p_{12}(t) = 1 - p_{11}(t)\\) into part (a) and rearranging gives the desired differential equation. (c) Solve this differential equation to find \\(p_{11}(t)\\). (You may wish to first find a general solution the homogeneous differential equation by guessing a solution of the form \\(\\mathrm{e}^{\\lambda t}\\), then find a particular solution to the inhomogeneous differential equation, and then use the initial condition.) Solution. The homogeneous differential equation has solution \\(A \\mathrm e^{-(\\alpha + \\beta)t}\\) (for example, by guessing a solution \\(\\mathrm e^{\\lambda t}\\), or other methods you may know from other courses). We can guess a particular solution \\(p_{11}(t) = C\\) and find \\(C = \\beta/(\\alpha + \\beta)\\). So the general solution of the inhomogeneous differential equation is \\[ p_{11}(t) = \\frac{\\beta}{\\alpha+\\beta} + A \\mathrm e^{-(\\alpha + \\beta)t} . \\] Using the initial condition \\(p_{11}(0) = 1\\) gives \\[ A = 1-\\frac{\\beta}{\\alpha + \\beta} = \\frac{\\alpha}{\\alpha + \\beta} . \\] We end up with the solution \\[ p_{11}(t) = \\frac{\\beta}{\\alpha + \\beta} + \\frac{\\alpha}{\\alpha + \\beta} \\mathrm e^{-(\\alpha + \\beta)t} . \\] 4. We continue with the setup of Question 3. (a) Show that \\(\\mathsf Q^2 = -(\\alpha + \\beta) \\mathsf Q\\). Solution. We have \\[\\begin{align*} \\mathsf Q^2 &amp;= \\begin{pmatrix} -\\alpha &amp; \\alpha \\\\ \\beta &amp; -\\beta \\end{pmatrix}\\begin{pmatrix} -\\alpha &amp; \\alpha \\\\ \\beta &amp; -\\beta \\end{pmatrix} \\\\ &amp;= \\begin{pmatrix} \\alpha^2 + \\alpha\\beta &amp; -\\alpha^2 - \\alpha\\beta \\\\ -\\alpha\\beta - \\beta^2 &amp; \\alpha\\beta + \\beta^2 \\end{pmatrix} \\\\ &amp;= -(\\alpha + \\beta) \\begin{pmatrix} -\\alpha &amp; \\alpha \\\\ \\beta &amp; -\\beta \\end{pmatrix} , \\end{align*}\\] as required. (b) Hence, write down \\(\\mathsf Q^n\\) for \\(n \\geq 1\\) in terms of \\(\\mathsf Q\\). Solution. By repeating the above pattern (or, more formally, using induction on \\(n\\)), we see that \\(\\mathsf Q^n = (-(\\alpha+\\beta))^{n-1} \\mathsf Q\\). (c) Show that \\[ \\mathsf P(t) = \\mathrm{e}^{t\\mathsf Q} = \\sum_{n=0}^\\infty \\frac{t^n \\mathsf Q^n}{n!} = \\mathsf I + \\frac{\\mathsf{Q}}{\\alpha + \\beta} \\big(1 - \\mathrm{e}^{-(\\alpha+\\beta)t} \\big) . \\] (Take care with \\(n = 0\\) term in the sum.) Solution. Treating the \\(n = 0\\) term separately, we have \\[ \\mathsf P(t) = \\mathsf I + \\sum_{n=1}^\\infty \\frac{t^n\\big(-(\\alpha+\\beta)\\big)^{n-1}\\mathsf Q}{n!} = \\mathsf I - \\frac{\\mathsf Q }{\\alpha+\\beta} \\sum_{n=1}^\\infty \\frac{\\big(-(\\alpha+\\beta)t\\big)^{n}}{n!} . \\] But the summation here is almost \\(\\mathrm{e}^{-(\\alpha + \\beta)t}\\), except missing the \\(n=0\\) term – so it’s actually \\(\\mathrm{e}^{-(\\alpha + \\beta)t} - 1\\). The result follows. (d) What, therefore, is \\(p_{11}(t)\\)? Check you answer agrees with Question 3(c). Solution. We need the \\((1,1)\\) entry of \\(\\mathsf P(t)\\), which is \\[ p_{11}(t) = 1 + \\frac{-\\alpha}{\\alpha + \\beta} \\big(1 - \\mathrm{e}^{-(\\alpha+\\beta)t} \\big) = \\frac{\\beta}{\\alpha+\\beta} + \\frac{\\alpha}{\\alpha+\\beta} \\mathrm{e}^{-(\\alpha+\\beta)t} , \\] and is indeed the same as 3(c). 1. Let \\[ \\mathsf D = \\begin{pmatrix} d_1 &amp; 0 &amp; &amp; \\\\ 0 &amp; d_2 &amp; &amp; \\\\ &amp; &amp; \\ddots &amp; \\\\ &amp; &amp; &amp; d_n \\end{pmatrix} \\] be a diagonal matrix. (a) What is \\(\\mathsf D^2\\)? Solution. \\[ \\mathsf D^2 = \\begin{pmatrix} d_1 &amp; 0 &amp; &amp; \\\\ 0 &amp; d_2 &amp; &amp; \\\\ &amp; &amp; \\ddots &amp; \\\\ &amp; &amp; &amp; d_n \\end{pmatrix}\\begin{pmatrix} d_1 &amp; 0 &amp; &amp; \\\\ 0 &amp; d_2 &amp; &amp; \\\\ &amp; &amp; \\ddots &amp; \\\\ &amp; &amp; &amp; d_n \\end{pmatrix} = \\begin{pmatrix} d_1^2 &amp; 0 &amp; &amp; \\\\ 0 &amp; d_2^2 &amp; &amp; \\\\ &amp; &amp; \\ddots &amp; \\\\ &amp; &amp; &amp; d_n^2 \\end{pmatrix} . \\] (b) What is \\(\\mathsf D^n\\) for \\(n \\geq 2\\)? Solution. Repeating the above pattern (or, more formally, using induction) we have \\[ \\mathsf D^n = \\begin{pmatrix} d_1^n &amp; 0 &amp; &amp; \\\\ 0 &amp; d_2^n &amp; &amp; \\\\ &amp; &amp; \\ddots &amp; \\\\ &amp; &amp; &amp; d_n^n \\end{pmatrix} .\\] (c) What is \\(\\mathrm{e}^{\\mathsf D}\\)? Solution. We use the definition \\(\\mathrm{e}^{\\mathsf D} = \\sum_n \\mathsf D^n / n!\\). Since all the \\(\\mathsf D^n\\)s are diagonal, \\(\\mathrm{e}^{\\mathsf D}\\) will be diagonal too. The \\(i\\)th diagonal entry will be \\(\\sum_n d_i^n / n! = \\mathrm{e}^{d_i}\\). Hence, \\[ \\mathrm{e}^{\\mathsf D} = \\begin{pmatrix} \\mathrm{e}^{d_1} &amp; 0 &amp; &amp; \\\\ 0 &amp; \\mathrm{e}^{d_2} &amp; &amp; \\\\ &amp; &amp; \\ddots &amp; \\\\ &amp; &amp; &amp; \\mathrm{e}^{d_n} \\end{pmatrix} .\\] (d) Explain how you could use eigenvalue methods and diagonalisation to find an explicit formula for the entries of the exponential of a matrix \\(\\mathsf A\\). Solution. We can (usually) diagonalise the matrix \\(\\mathsf A = \\mathsf P^{-1}\\mathsf{DP}\\), where \\(\\mathsf D\\) is the diagonal matrix of eigenvalues and \\(\\mathsf P\\) is the matrix of eigenvectors. Then we have \\[ \\mathsf A^n = \\mathsf P^{-1}\\mathsf{DP}\\mathsf P^{-1}\\mathsf{DP}\\cdots\\mathsf P^{-1}\\mathsf{DP} = \\mathsf P^{-1}\\mathsf{D}^n\\mathsf{P} , \\] and so \\(\\mathrm{e}^{\\mathsf A} = \\mathsf P^{-1} \\mathrm{e}^{\\mathsf D} \\mathsf P\\), and \\(\\mathrm{e}^{\\mathsf D}\\) is easily calculated as in part (c). "],["computing.html", "Computational worksheets About the computational worksheets How to access R R background", " Computational worksheets Computational Worksheet 1: [HTML format] [Rmd format] Example report: [HTML format] [Rmd format] Computational Worksheet 2 (Assessment 2): [HTML format] [Rmd format] This worksheet is assessed, and is due on Thursday 18 March at 2pm. About the computational worksheets These computational worksheets are an opportunity to learn more about Markov chains through simulation using R. This first worksheet is not an assessed part of the course, but it is for you to learn and practice. The second worksheet is an assessed part of the course, and counts for 3% of your grade on this course. A report on Worksheet 2 will be due on Thursday 18 March (week 8) at 2pm. The material in these worksheets is examinable. I recommend working on Computational Worksheet 1 in weeks 3 or 4, and on Computational Worksheet 2 in weeks 6 or 7. I estimate that each worksheet may take about 2 hours to work through. You will have two computational drop-in sessions available with Muyang Zhang. These drop-in sessions are optional opportunities for you to come along to ask for help if you are stuck or want to know more. These sessions will happen on Teams. The sessions may appear in your timetable as “Practicals”. It is important that you work through most of the worksheet before your drop-in session, as this will be your main opportunity to ask for help. (You can also use the module discussion board on Teams.) The dates of the drop-in sessions are: Computational Worksheet 1: Monday 15 – Wednesday 17 February (week 4) Computational Worksheet 2: Monday 8 – Wednesday 10 March (week 7) Note that the Worksheet 2 practical sessions are the week before the deadline, so it’s in your benefit to start working on that worksheet early. The computational worksheets are available in two formats: First, as an easy-to-read HTML file. You should open this in a web browser. Second, as a file with the suffix .Rmd. This can be read as a plain text file. However, I recommend downloading this file and opening it in RStudio. This will make it easy to run the R code included in the file, by clicking the green “play” button by each chunk of R code. (These files is written in a language called “R Markdown”, which you could choose to use for writing your report.) How to access R These worksheets use the statistical programming language R. Use of R is mandatory. I recommend interacting with R via the program RStudio, although this is optional. There are various ways to access R and RStudio. You may already have R and RStudio installed on your own computer. You can install R and RStudio on your own computer now if you haven’t previously. You should first download R from the Comprehensive R Archive Network, and then download “RStudio Desktop” from rstudio.com. Remember to download and install R first, and only then to download and install RStudio. The RStudio Cloud is like “Google Docs for R”. You can get 15 hours a month for free, which should be more than enough for these worksheets. Because this doesn’t require installation, it’s good for Chromebooks or computers where you don’t have full installation rights. If you are in Leeds, all the university computers have R and RStudio installed. However, at the time of writing (5 February 2021), all IT clusters on campus are closed. You can see the latest news on cluster availability here. You can access R and RStudio via the university’s virtual Windows desktop or (for those who have a Windows computer) via the university’s AppsAnywhere system. R background These worksheets are mostly self-explanatory. However, they do assume a little background. For example, I assume you know how to operate R (for example by opening RStudio and typing commands in the “console”), and that you know that x &lt;- c(1, 2, 3) creates a vector called x and that mean(x) calculates the mean of the entries of x. Most students on this course will know R from MATH1710 and MATH1712 or other courses. If you are new to R, I recommend Dr Jochen Voss’s “A Short Introduction to R” or Dr Arief Gusnanto’s “Introduction to R”, both available from Dr Gusnanto’s MATH1712 homepage. "]]
